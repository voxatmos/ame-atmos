// ==UserScript==
// @namespace   ame-voxatmos
// @name        Ame for VoxAtmos
// @version     1.13.0
// @author      SuperSaltyGamer
// @run-at      document-start
// @match       https://music.apple.com/*
// @match       https://beta.music.apple.com/*
// @grant       GM.addStyle
// @grant       GM.setClipboard
// @grant       GM.xmlHttpRequest
// @downloadURL https://gitlab.com/dosolo/ame-atmos/-/raw/main/dist/applemusic.user.js
// @updateURL https://gitlab.com/dosolo/ame-atmos/-/raw/main/dist/applemusic.user.js
// ==/UserScript==

(function(qs){typeof define=="function"&&define.amd?define(qs):qs()})(function(){"use strict";const qs=`/*!
 * Copyright (c) HANDSONCODE sp. z o. o.
 *
 * HANDSONTABLE is a software distributed by HANDSONCODE sp. z o. o., a Polish corporation based in
 * Gdynia, Poland, at Aleja Zwyciestwa 96-98, registered by the District Court in Gdansk under number
 * 538651, EU tax ID number: PL5862294002, share capital: PLN 62,800.00.
 *
 * This software is protected by applicable copyright laws, including international treaties, and dual-
 * licensed - depending on whether your use for commercial purposes, meaning intended for or
 * resulting in commercial advantage or monetary compensation, or not.
 *
 * If your use is strictly personal or solely for evaluation purposes, meaning for the purposes of testing
 * the suitability, performance, and usefulness of this software outside the production environment,
 * you agree to be bound by the terms included in the "handsontable-non-commercial-license.pdf" file.
 *
 * Your use of this software for commercial purposes is subject to the terms included in an applicable
 * license agreement.
 *
 * In any case, you must not make any such use of this software as to develop software which may be
 * considered competitive with this software.
 *
 * UNLESS EXPRESSLY AGREED OTHERWISE, HANDSONCODE PROVIDES THIS SOFTWARE ON AN "AS IS"
 * BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, AND IN NO EVENT AND UNDER NO
 * LEGAL THEORY, SHALL HANDSONCODE BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY DIRECT,
 * INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES OF ANY CHARACTER ARISING FROM
 * USE OR INABILITY TO USE THIS SOFTWARE.
 *
 * Version: 14.5.0
 * Release date: 30/07/2024 (built at 30/07/2024 11:22:38)
 */.handsontable .table td,.handsontable .table th{border-top:none}.handsontable tr{background:#fff}.handsontable td{background-color:inherit}.handsontable .table caption+thead tr:first-child td,.handsontable .table caption+thead tr:first-child th,.handsontable .table colgroup+thead tr:first-child td,.handsontable .table colgroup+thead tr:first-child th,.handsontable .table thead:first-child tr:first-child td,.handsontable .table thead:first-child tr:first-child th{border-top:1px solid #ccc}.handsontable .table-bordered{border:0;border-collapse:separate}.handsontable .table-bordered td,.handsontable .table-bordered th{border-left:none}.handsontable .table-bordered td:first-child,.handsontable .table-bordered th:first-child{border-left:1px solid #ccc}.handsontable .table>tbody>tr>td,.handsontable .table>tbody>tr>th,.handsontable .table>tfoot>tr>td,.handsontable .table>tfoot>tr>th,.handsontable .table>thead>tr>td,.handsontable .table>thead>tr>th{line-height:21px;padding:0}.col-lg-1.handsontable,.col-lg-10.handsontable,.col-lg-11.handsontable,.col-lg-12.handsontable,.col-lg-2.handsontable,.col-lg-3.handsontable,.col-lg-4.handsontable,.col-lg-5.handsontable,.col-lg-6.handsontable,.col-lg-7.handsontable,.col-lg-8.handsontable,.col-lg-9.handsontable,.col-md-1.handsontable,.col-md-10.handsontable,.col-md-11.handsontable,.col-md-12.handsontable,.col-md-2.handsontable,.col-md-3.handsontable,.col-md-4.handsontable,.col-md-5.handsontable,.col-md-6.handsontable,.col-md-7.handsontable,.col-md-8.handsontable,.col-md-9.handsontable .col-sm-1.handsontable,.col-sm-10.handsontable,.col-sm-11.handsontable,.col-sm-12.handsontable,.col-sm-2.handsontable,.col-sm-3.handsontable,.col-sm-4.handsontable,.col-sm-5.handsontable,.col-sm-6.handsontable,.col-sm-7.handsontable,.col-sm-8.handsontable,.col-sm-9.handsontable .col-xs-1.handsontable,.col-xs-10.handsontable,.col-xs-11.handsontable,.col-xs-12.handsontable,.col-xs-2.handsontable,.col-xs-3.handsontable,.col-xs-4.handsontable,.col-xs-5.handsontable,.col-xs-6.handsontable,.col-xs-7.handsontable,.col-xs-8.handsontable,.col-xs-9.handsontable{padding-left:0;padding-right:0}.handsontable .table-striped>tbody>tr:nth-of-type(2n){background-color:#fff}.handsontable{position:relative}.handsontable .hide{display:none}.handsontable .relative{position:relative}.handsontable .wtHider{width:0}.handsontable .wtSpreader{height:auto;position:relative;width:0}.handsontable div,.handsontable input,.handsontable table,.handsontable tbody,.handsontable td,.handsontable textarea,.handsontable th,.handsontable thead{box-sizing:content-box;-webkit-box-sizing:content-box;-moz-box-sizing:content-box}.handsontable input,.handsontable textarea{min-height:auto}.handsontable table.htCore{border-collapse:separate;border-spacing:0;border-width:0;cursor:default;margin:0;max-height:none;max-width:none;outline-width:0;table-layout:fixed;width:0}.handsontable col,.handsontable col.rowHeader{width:50px}.handsontable td,.handsontable th{background-color:#fff;border-bottom:1px solid #ccc;border-left-width:0;border-right:1px solid #ccc;border-top-width:0;empty-cells:show;height:22px;line-height:21px;outline:none;outline-width:0;overflow:hidden;padding:0 4px;vertical-align:top;white-space:pre-wrap}[dir=rtl].handsontable td,[dir=rtl].handsontable th{border-left:1px solid #ccc;border-right-width:0}.handsontable th:last-child{border-bottom:1px solid #ccc;border-left:none;border-right:1px solid #ccc}[dir=rtl].handsontable th:last-child{border-left:1px solid #ccc;border-right:none}.handsontable td:first-of-type,.handsontable th:first-child{border-left:1px solid #ccc}[dir=rtl].handsontable td:first-of-type,[dir=rtl].handsontable th:first-child{border-right:1px solid #ccc}.handsontable .ht_clone_top th:nth-child(2){border-left-width:0;border-right:1px solid #ccc}[dir=rtl].handsontable .ht_clone_top th:nth-child(2){border-left:1px solid #ccc;border-right-width:0}.handsontable.htRowHeaders thead tr th:nth-child(2){border-left:1px solid #ccc}[dir=rtl].handsontable.htRowHeaders thead tr th:nth-child(2){border-right:1px solid #ccc}.handsontable tr:first-child td,.handsontable tr:first-child th{border-top:1px solid #ccc}.ht_master:not(.innerBorderInlineStart):not(.emptyColumns) tbody tr th,.ht_master:not(.innerBorderInlineStart):not(.emptyColumns) thead tr th:first-child,.ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable:not(.htGhostTable) tbody tr th,.ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable:not(.ht_clone_top):not(.htGhostTable) thead tr th:first-child{border-left:1px solid #ccc;border-right-width:0}[dir=rtl].ht_master:not(.innerBorderInlineStart):not(.emptyColumns) tbody tr th,[dir=rtl].ht_master:not(.innerBorderInlineStart):not(.emptyColumns) thead tr th:first-child,[dir=rtl].ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable:not(.htGhostTable) tbody tr th,[dir=rtl].ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable:not(.ht_clone_top):not(.htGhostTable) thead tr th:first-child{border-left-width:0;border-right:1px solid #ccc}.ht_master:not(.innerBorderTop):not(.innerBorderBottom) thead tr.lastChild th,.ht_master:not(.innerBorderTop):not(.innerBorderBottom) thead tr:last-child th,.ht_master:not(.innerBorderTop):not(.innerBorderBottom)~.handsontable thead tr.lastChild th,.ht_master:not(.innerBorderTop):not(.innerBorderBottom)~.handsontable thead tr:last-child th{border-bottom-width:0}.handsontable th{background-color:#f0f0f0;color:#222;font-weight:400;text-align:center;white-space:nowrap}.handsontable thead th{padding:0}.handsontable th.active{background-color:#ccc}.handsontable thead th .relative{padding:2px 4px}.handsontable span.colHeader{display:inline-block;line-height:1.1}.handsontable .wtBorder{font-size:0;position:absolute}.handsontable .wtBorder.hidden{display:none!important}.handsontable .wtBorder.current{z-index:10}.handsontable .wtBorder.area{z-index:8}.handsontable .wtBorder.fill{z-index:6}.handsontable .wtBorder.corner{cursor:crosshair;font-size:0}.ht_clone_master{z-index:100}.ht_clone_inline_start{z-index:120}.ht_clone_bottom{z-index:130}.ht_clone_bottom_inline_start_corner{z-index:150}.ht_clone_top{z-index:160}.ht_clone_top_inline_start_corner{z-index:180}.handsontable col.hidden{width:0!important}.handsontable tr.hidden,.handsontable tr.hidden td,.handsontable tr.hidden th{display:none}.ht_clone_bottom,.ht_clone_inline_start,.ht_clone_top,.ht_master{overflow:hidden}.ht_master .wtHolder{overflow:auto}.handsontable .ht_clone_inline_start table.htCore>thead,.handsontable .ht_master table.htCore>tbody>tr>th,.handsontable .ht_master table.htCore>thead{visibility:hidden}.ht_clone_bottom .wtHolder,.ht_clone_inline_start .wtHolder,.ht_clone_top .wtHolder{overflow:hidden}.handsontable{color:#373737;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Helvetica Neue,Arial,sans-serif;font-size:13px;font-weight:400;touch-action:manipulation}.handsontable a{color:#104acc}.handsontable.htAutoSize{left:-99000px;position:absolute;top:-99000px;visibility:hidden}.handsontable td.htInvalid{background-color:#ffbeba!important}.handsontable td.htNoWrap{white-space:nowrap}.handsontable td.invisibleSelection,.handsontable th.invisibleSelection{outline:none}.handsontable td.invisibleSelection::selection,.handsontable th.invisibleSelection::selection{background:#fff0}.hot-display-license-info{color:#373737;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Helvetica Neue,Arial,sans-serif;font-size:10px;font-weight:400;padding:5px 0 3px;text-align:left}.hot-display-license-info a{color:#104acc;font-size:10px}.handsontable .htFocusCatcher{border:0;height:0;margin:0;opacity:0;padding:0;position:absolute;width:0;z-index:-1}.handsontable .manualColumnResizer{cursor:col-resize;height:25px;position:absolute;top:0;width:5px;z-index:210}.handsontable .manualRowResizer{cursor:row-resize;height:5px;left:0;position:absolute;width:50px;z-index:210}.handsontable .manualColumnResizer.active,.handsontable .manualColumnResizer:hover,.handsontable .manualRowResizer.active,.handsontable .manualRowResizer:hover{background-color:#34a9db}.handsontable .manualColumnResizerGuide{background-color:#34a9db;border-left:none;border-right:1px dashed #777;display:none;margin-left:5px;margin-right:unset;position:absolute;right:unset;top:0;width:0}[dir=rtl].handsontable .manualColumnResizerGuide{border-left:1px dashed #777;border-right:none;left:unset;margin-left:unset;margin-right:5px}.handsontable .manualRowResizerGuide{background-color:#34a9db;border-bottom:1px dashed #777;bottom:0;display:none;height:0;left:0;margin-top:5px;position:absolute}.handsontable .manualColumnResizerGuide.active,.handsontable .manualRowResizerGuide.active{display:block;z-index:209}.handsontable td.area,.handsontable td.area-1,.handsontable td.area-2,.handsontable td.area-3,.handsontable td.area-4,.handsontable td.area-5,.handsontable td.area-6,.handsontable td.area-7{position:relative}.handsontable td.area-1:before,.handsontable td.area-2:before,.handsontable td.area-3:before,.handsontable td.area-4:before,.handsontable td.area-5:before,.handsontable td.area-6:before,.handsontable td.area-7:before,.handsontable td.area:before{background:#005eff;bottom:0;bottom:-100%\\	;content:"";left:0;position:absolute;right:0;top:0}@media (-ms-high-contrast:none),screen and (-ms-high-contrast:active){.handsontable td.area-1:before,.handsontable td.area-2:before,.handsontable td.area-3:before,.handsontable td.area-4:before,.handsontable td.area-5:before,.handsontable td.area-6:before,.handsontable td.area-7:before,.handsontable td.area:before{bottom:-100%}}.handsontable td.area:before{opacity:.1}.handsontable td.area-1:before{opacity:.2}.handsontable td.area-2:before{opacity:.27}.handsontable td.area-3:before{opacity:.35}.handsontable td.area-4:before{opacity:.41}.handsontable td.area-5:before{opacity:.47}.handsontable td.area-6:before{opacity:.54}.handsontable td.area-7:before{opacity:.58}.handsontable tbody th.current,.handsontable thead th.current{box-shadow:inset 0 0 0 2px #4b89ff}.handsontable tbody th.ht__highlight,.handsontable thead th.ht__highlight{background-color:#dcdcdc}.handsontable tbody th.ht__active_highlight,.handsontable thead th.ht__active_highlight{background-color:#8eb0e7;color:#000}.handsontableInput{background-color:#fff;border:none;border-radius:0;box-shadow:inset 0 0 0 2px #5292f7;color:#000;display:block;font-family:inherit;font-size:inherit;line-height:21px;margin:0;outline-width:0;padding:1px 5px 0;resize:none}.handsontableInput:focus{outline:none}.handsontableInputHolder{left:0;position:absolute;top:0}.htSelectEditor{-webkit-appearance:menulist-button!important;position:absolute;width:auto}.htSelectEditor:focus{outline:none}.handsontable .htDimmed{color:#777}.handsontable .htSubmenu{position:relative}.handsontable .htSubmenu :after{color:#777;content:"▶";font-size:9px;position:absolute;right:5px}[dir=rtl].handsontable .htSubmenu :after{content:""}[dir=rtl].handsontable .htSubmenu :before{color:#777;content:"◀";font-size:9px;left:5px;position:absolute}.handsontable .htLeft{text-align:left}.handsontable .htCenter{text-align:center}.handsontable .htRight{text-align:right}.handsontable .htJustify{text-align:justify}.handsontable .htTop{vertical-align:top}.handsontable .htMiddle{vertical-align:middle}.handsontable .htBottom{vertical-align:bottom}.handsontable .htPlaceholder{color:#999}.handsontable.listbox{margin:0}.handsontable.listbox .ht_master table{background:#fff;border:1px solid #ccc;border-collapse:separate}.handsontable.listbox td,.handsontable.listbox th,.handsontable.listbox tr:first-child td,.handsontable.listbox tr:first-child th,.handsontable.listbox tr:last-child th{border-color:transparent!important}.handsontable.listbox td,.handsontable.listbox th{text-overflow:ellipsis;white-space:nowrap}.handsontable.listbox td.htDimmed{color:inherit;cursor:default;font-style:inherit}.handsontable.listbox .wtBorder{visibility:hidden}.handsontable.listbox tr td.current,.handsontable.listbox tr:hover td{background:#eee}.ht_editor_hidden{z-index:-1}.ht_editor_visible{z-index:200}.handsontable td.htSearchResult{background:#fcedd9;color:#583707}.handsontable.mobile,.handsontable.mobile .wtHolder{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-overflow-scrolling:touch}.handsontable.mobile .handsontableInput:focus{-webkit-appearance:none;-webkit-box-shadow:inset 0 0 0 2px #5292f7;-moz-box-shadow:inset 0 0 0 2px #5292f7;box-shadow:inset 0 0 0 2px #5292f7}.handsontable .bottomSelectionHandle,.handsontable .bottomSelectionHandle-HitArea,.handsontable .topSelectionHandle,.handsontable .topSelectionHandle-HitArea{left:-10000px;right:unset;top:-10000px;z-index:9999}[dir=rtl].handsontable .bottomSelectionHandle,[dir=rtl].handsontable .bottomSelectionHandle-HitArea,[dir=rtl].handsontable .topSelectionHandle,[dir=rtl].handsontable .topSelectionHandle-HitArea{left:unset;right:-10000px}.handsontable.hide-tween{-webkit-animation:opacity-hide .3s;animation:opacity-hide .3s;animation-fill-mode:forwards;-webkit-animation-fill-mode:forwards}.handsontable.show-tween{-webkit-animation:opacity-show .3s;animation:opacity-show .3s;animation-fill-mode:forwards;-webkit-animation-fill-mode:forwards}/*!
 * Pikaday
 * Copyright © 2014 David Bushell | BSD & MIT license | https://dbushell.com/
 */.pika-single{background:#fff;border:1px solid;border-color:#ccc #ccc #bbb;color:#333;display:block;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;position:relative;z-index:9999}.pika-single:after,.pika-single:before{content:" ";display:table}.pika-single:after{clear:both}.pika-single.is-hidden{display:none}.pika-single.is-bound{box-shadow:0 5px 15px -5px #00000080;position:absolute}.pika-lendar{float:left;margin:8px;width:240px}.pika-title{position:relative;text-align:center}.pika-label{background-color:#fff;display:inline-block;font-size:14px;font-weight:700;line-height:20px;margin:0;overflow:hidden;padding:5px 3px;position:relative;z-index:9999}.pika-title select{cursor:pointer;left:0;margin:0;opacity:0;position:absolute;top:5px;z-index:9998}.pika-next,.pika-prev{background-color:transparent;background-position:50%;background-repeat:no-repeat;background-size:75% 75%;border:0;cursor:pointer;display:block;height:30px;opacity:.5;outline:none;overflow:hidden;padding:0;position:relative;text-indent:20px;white-space:nowrap;width:20px}.pika-next:hover,.pika-prev:hover{opacity:1}.is-rtl .pika-next,.pika-prev{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAAUklEQVR42u3VMQoAIBADQf8Pgj+OD9hG2CtONJB2ymQkKe0HbwAP0xucDiQWARITIDEBEnMgMQ8S8+AqBIl6kKgHiXqQqAeJepBo/z38J/U0uAHlaBkBl9I4GwAAAABJRU5ErkJggg==);float:left}.is-rtl .pika-prev,.pika-next{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAAU0lEQVR42u3VOwoAMAgE0dwfAnNjU26bYkBCFGwfiL9VVWoO+BJ4Gf3gtsEKKoFBNTCoCAYVwaAiGNQGMUHMkjGbgjk2mIONuXo0nC8XnCf1JXgArVIZAQh5TKYAAAAASUVORK5CYII=);float:right}.pika-next.is-disabled,.pika-prev.is-disabled{cursor:default;opacity:.2}.pika-select{display:inline-block}.pika-table{border:0;border-collapse:collapse;border-spacing:0;width:100%}.pika-table td,.pika-table th{padding:0;width:14.2857142857%}.pika-table th{color:#999;font-weight:700;line-height:25px}.pika-button,.pika-table th{font-size:12px;text-align:center}.pika-button{background:#f5f5f5;border:0;box-sizing:border-box;-moz-box-sizing:border-box;color:#666;cursor:pointer;display:block;height:auto;line-height:15px;margin:0;outline:none;padding:5px;width:100%}.pika-week{color:#999;font-size:11px}.is-today .pika-button{color:#3af;font-weight:700}.has-event .pika-button,.is-selected .pika-button{background:#3af;border-radius:3px;box-shadow:inset 0 1px 3px #178fe5;color:#fff;font-weight:700}.has-event .pika-button{background:#005da9;box-shadow:inset 0 1px 3px #0076c9}.is-disabled .pika-button,.is-inrange .pika-button{background:#d5e9f7}.is-startrange .pika-button{background:#6cb31d;border-radius:3px;box-shadow:none;color:#fff}.is-endrange .pika-button{background:#3af;border-radius:3px;box-shadow:none;color:#fff}.is-disabled .pika-button{color:#999;cursor:default;opacity:.3;pointer-events:none}.is-outside-current-month .pika-button{color:#999;opacity:.3}.is-selection-disabled{cursor:default;pointer-events:none}.pika-button:hover,.pika-row.pick-whole-week:hover .pika-button{background:#ff8000;border-radius:3px;box-shadow:none;color:#fff}.pika-table abbr{border-bottom:none;cursor:help}.handsontable .htAutocompleteArrow{color:#bbb;cursor:default;float:right;font-size:10px;text-align:center;width:16px}[dir=rtl].handsontable .htAutocompleteArrow{float:left}.handsontable td.htInvalid .htAutocompleteArrow{color:#555}.handsontable td.htInvalid .htAutocompleteArrow:hover{color:#1a1a1a}.handsontable td .htAutocompleteArrow:hover{color:#777}.handsontable td.area .htAutocompleteArrow{color:#d3d3d3}.handsontable .htCheckboxRendererInput{display:inline-block}.handsontable .htCheckboxRendererInput.noValue{opacity:.5}.handsontable .htCheckboxRendererLabel{cursor:pointer;display:inline-block;font-size:inherit;vertical-align:middle}.handsontable .htCheckboxRendererLabel.fullWidth{width:100%}.handsontable .collapsibleIndicator{background:#eee;border:1px solid #a6a6a6;border-radius:10px;-webkit-box-shadow:0 0 0 6px #eee;-moz-box-shadow:0 0 0 6px #eee;box-shadow:0 0 0 3px #eee;color:#222;cursor:pointer;font-size:10px;height:10px;left:unset;line-height:8px;position:absolute;right:5px;text-align:center;top:50%;transform:translateY(-50%);width:10px}[dir=rtl].handsontable .collapsibleIndicator{left:5px;right:unset}.handsontable[dir=ltr] thead th:has(.collapsibleIndicator) div.htRight span.colHeader{margin-right:20px}.handsontable[dir=rtl] thead th:has(.collapsibleIndicator) div.htLeft span.colHeader{margin-left:20px}.handsontable .columnSorting{position:relative}.handsontable[dir=ltr] div.htRight span[class*=ascending],.handsontable[dir=ltr] div.htRight span[class*=descending]{margin-left:-10px;margin-right:10px}.handsontable[dir=rtl] div.htLeft span[class*=ascending],.handsontable[dir=rtl] div.htLeft span[class*=descending]{margin-left:10px;margin-right:-10px}.handsontable[dir=ltr] div.htRight span[class*=ascending]:only-child,.handsontable[dir=ltr] div.htRight span[class*=descending]:only-child{margin-left:-15px;margin-right:15px}.handsontable[dir=rtl] div.htLeft span[class*=ascending]:only-child,.handsontable[dir=rtl] div.htLeft span[class*=descending]:only-child{margin-left:15px;margin-right:-15px}.handsontable .columnSorting.sortAction:hover{cursor:pointer;text-decoration:underline}.handsontable span.colHeader.columnSorting:before{background-position-x:right;background-repeat:no-repeat;background-size:contain;content:"";height:10px;left:unset;margin-top:-6px;padding-left:8px;padding-right:0;position:absolute;right:-9px;top:50%;width:5px}[dir=rtl].handsontable span.colHeader.columnSorting:before{background-position-x:left;left:-9px;padding-left:0;padding-right:8px;right:unset}.handsontable span.colHeader.columnSorting.ascending:before{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAoCAMAAADJ7yrpAAAAKlBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKE86IAAAADXRSTlMABBEmRGprlJW72e77tTkTKwAAAFNJREFUeAHtzjkSgCAUBNHPgsoy97+ulGXRqJE5L+xkxoYt2UdsLb5bqFINz+aLuuLn5rIu2RkO3fZpWENimNgiw6iBYRTPMLJjGFxQZ1hxxb/xBI1qC8k39CdKAAAAAElFTkSuQmCC)}.handsontable span.colHeader.columnSorting.descending:before{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAoCAMAAADJ7yrpAAAAKlBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKE86IAAAADXRSTlMABBEmRGprlJW72e77tTkTKwAAAFJJREFUeAHtzjkSgCAQRNFmQYUZ7n9dKUvru0TmvPAn3br0QfgdZ5xx6x+rQn23GqTYnq1FDcnuzZIO2WmedVqIRVxgGKEyjNgYRjKGkZ1hFIZ3I70LyM0VtU8AAAAASUVORK5CYII=)}.htGhostTable .htCore span.colHeader.columnSorting:not(.indicatorDisabled):before{content:"*";display:inline-block;padding-right:20px;position:relative}.handsontable .htCommentCell{position:relative}.handsontable .htCommentCell:after{border-left:6px solid transparent;border-right:none;border-top:6px solid #000;content:"";left:unset;position:absolute;right:0;top:0}[dir=rtl].handsontable .htCommentCell:after{border-left:none;border-right:6px solid transparent;left:0;right:unset}.htCommentsContainer .htComments{display:none;position:absolute;z-index:1059}.htCommentsContainer .htCommentTextArea{-webkit-appearance:none;background-color:#fff;border:none;border-left:3px solid #ccc;box-shadow:0 1px 3px #0000001e,0 1px 2px #0000003d;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;font-size:12px;height:90px;outline:0!important;padding:5px;width:215px}[dir=rtl].htCommentsContainer .htCommentTextArea{border-left:none;border-right:3px solid #ccc}.htCommentsContainer .htCommentTextArea:focus{border-left:3px solid #5292f7;border-right:none;box-shadow:0 1px 3px #0000001e,0 1px 2px #0000003d,inset 0 0 0 1px #5292f7}[dir=rtl].htCommentsContainer .htCommentTextArea:focus{border-left:none;border-right:3px solid #5292f7}/*!
 * Handsontable ContextMenu
 */.htContextMenu:not(.htGhostTable){display:none;position:absolute;z-index:1060}.htContextMenu .ht_clone_bottom,.htContextMenu .ht_clone_bottom_inline_start_corner,.htContextMenu .ht_clone_inline_start,.htContextMenu .ht_clone_top,.htContextMenu .ht_clone_top_inline_start_corner{display:none}.htContextMenu .ht_master table.htCore{border-color:#ccc;border-style:solid;border-width:1px 2px 2px 1px}[dir=rtl].htContextMenu .ht_master table.htCore{border-left-width:2px;border-right-width:1px}.htContextMenu.handsontable:focus{outline:none}.htContextMenu .wtBorder{visibility:hidden}.htContextMenu table tbody tr td{background:#fff;border-width:0;cursor:pointer;overflow:hidden;padding:4px 6px 0;text-overflow:ellipsis;white-space:nowrap}.htContextMenu table tbody tr td:first-child{border-width:0}[dir=rtl].htContextMenu table tbody tr td:first-child{border-left-width:0;border-right-width:0}.htContextMenu table tbody tr td.htDimmed{color:#323232;font-style:normal}.htContextMenu table tbody tr td.current{background:#f3f3f3}.htContextMenu table tbody tr td.htSeparator{border-top:1px solid #e6e6e6;cursor:default;height:0;padding:0}.htContextMenu table tbody tr td.htDisabled{color:#999;cursor:default}.htContextMenu table tbody tr td.htDisabled:hover{background:#fff;color:#999;cursor:default}.htContextMenu table tbody tr.htHidden{display:none}.htContextMenu table tbody tr td .htItemWrapper{margin-left:10px;margin-right:6px}[dir=rtl].htContextMenu table tbody tr td .htItemWrapper{margin-left:6px;margin-right:10px}.htContextMenu table tbody tr td div span.selected{left:4px;margin-top:-2px;position:absolute;right:0}[dir=rtl].htContextMenu table tbody tr td div span.selected{left:0;right:4px}.htContextMenu .ht_master .wtHolder{overflow:hidden}textarea.HandsontableCopyPaste{opacity:0;outline:0 none!important;overflow:hidden;position:fixed!important;right:100%!important;top:0!important}/*!
 * Handsontable DropdownMenu
 */.handsontable .changeType{background:#eee;border:1px solid #bbb;border-radius:2px;color:#bbb;float:right;font-size:9px;line-height:9px;margin:3px 1px 0 5px;padding:2px}[dir=rtl].handsontable .changeType{float:left}.handsontable[dir=rtl] .changeType{margin:3px 5px 0 1px}.handsontable .changeType:before{content:"▼ "}.handsontable .changeType:hover{border:1px solid #777;color:#777;cursor:pointer}.htDropdownMenu:not(.htGhostTable){display:none;position:absolute;z-index:1060}.htDropdownMenu .ht_clone_bottom,.htDropdownMenu .ht_clone_bottom_inline_start_corner,.htDropdownMenu .ht_clone_inline_start,.htDropdownMenu .ht_clone_top,.htDropdownMenu .ht_clone_top_inline_start_corner{display:none}.htDropdownMenu table.htCore{border-color:#ccc;border-style:solid;border-width:1px 2px 2px 1px}[dir=rtl].htDropdownMenu table.htCore{border-left-width:2px;border-right-width:1px}.htDropdownMenu.handsontable:focus{outline:none}.htDropdownMenu .wtBorder{visibility:hidden}.htDropdownMenu table tbody tr td{background:#fff;border-width:0;cursor:pointer;overflow:hidden;padding:4px 6px 0;text-overflow:ellipsis;white-space:nowrap}.htDropdownMenu table tbody tr td:first-child{border-width:0}[dir=rtl].htDropdownMenu table tbody tr td:first-child{border-left-width:0;border-right-width:0}.htDropdownMenu table tbody tr td.htDimmed{color:#323232;font-style:normal}.htDropdownMenu table tbody tr td.current{background:#e9e9e9}.htDropdownMenu table tbody tr td.htSeparator{border-top:1px solid #e6e6e6;cursor:default;height:0;padding:0}.htDropdownMenu table tbody tr td.htDisabled{color:#999}.htDropdownMenu table tbody tr td.htDisabled:hover{background:#fff;color:#999;cursor:default}.htDropdownMenu:not(.htGhostTable) table tbody tr.htHidden{display:none}.htDropdownMenu table tbody tr td .htItemWrapper,[dir=rtl].htDropdownMenu table tbody tr td .htItemWrapper{margin-left:10px;margin-right:10px}.htDropdownMenu table tbody tr td div span.selected{left:4px;margin-top:-2px;position:absolute;right:0}[dir=rtl].htDropdownMenu table tbody tr td div span.selected{left:0;right:4px}.htDropdownMenu .ht_master .wtHolder{overflow:hidden}/*!
 * Handsontable Filters
 */.htFiltersConditionsMenu:not(.htGhostTable){display:none;position:absolute;z-index:1070}.htFiltersConditionsMenu .ht_clone_bottom,.htFiltersConditionsMenu .ht_clone_bottom_inline_start_corner,.htFiltersConditionsMenu .ht_clone_inline_start,.htFiltersConditionsMenu .ht_clone_top,.htFiltersConditionsMenu .ht_clone_top_inline_start_corner{display:none}.htFiltersConditionsMenu table.htCore{border-color:#bbb;border-style:solid;border-width:1px 2px 2px 1px}.htFiltersConditionsMenu .wtBorder{visibility:hidden}.htFiltersConditionsMenu table tbody tr td{background:#fff;border-width:0;cursor:pointer;overflow:hidden;padding:4px 6px 0;text-overflow:ellipsis;white-space:nowrap}.htFiltersConditionsMenu table tbody tr td:first-child{border-width:0}[dir=rtl].htFiltersConditionsMenu table tbody tr td:first-child{border-left-width:0;border-right-width:0}.htFiltersConditionsMenu table tbody tr td.htDimmed{color:#323232;font-style:normal}.htFiltersConditionsMenu table tbody tr td.current{background:#e9e9e9}.htFiltersConditionsMenu table tbody tr td.htSeparator{border-top:1px solid #e6e6e6;height:0;padding:0}.htFiltersConditionsMenu table tbody tr td.htDisabled{color:#999}.htFiltersConditionsMenu table tbody tr td.htDisabled:hover{background:#fff;color:#999;cursor:default}.htFiltersConditionsMenu table tbody tr td .htItemWrapper{margin-left:10px;margin-right:10px}.htFiltersConditionsMenu table tbody tr td div span.selected{left:4px;margin-top:-2px;position:absolute}.htFiltersConditionsMenu .ht_master .wtHolder{overflow:hidden}.handsontable .htMenuFiltering{border-bottom:1px dotted #ccc;height:135px;overflow:hidden}.handsontable .ht_master table td.htCustomMenuRenderer{background-color:#fff;cursor:auto}.handsontable .htFiltersMenuLabel{font-size:.75em}.handsontable .htFiltersMenuActionBar{padding-bottom:3px;padding-top:10px;text-align:center}.handsontable .htFiltersMenuCondition.border{border-bottom:1px dotted #ccc!important}.handsontable .htFiltersMenuCondition .htUIInput{padding:0 0 5px}.handsontable .htFiltersMenuValue{border-bottom:1px dotted #ccc!important}.handsontable .htFiltersMenuValue .htUIMultipleSelectSearch{padding:0}.handsontable .htFiltersMenuCondition .htUIInput input,.handsontable .htFiltersMenuValue .htUIMultipleSelectSearch input{box-sizing:border-box;font-family:inherit;font-size:.75em;padding:4px;width:100%}.htUIMultipleSelect .ht_master .wtHolder{overflow-y:scroll}.handsontable .htFiltersActive .changeType{background-color:#d2e0d9;border:1px solid #509272;color:#18804e}.handsontable .htUISelectAll{margin-left:0;margin-right:10px}[dir=rtl].handsontable .htUISelectAll{margin-left:10px;margin-right:0}.handsontable .htUIClearAll,.handsontable .htUISelectAll{display:inline-block}.handsontable .htUIClearAll a,.handsontable .htUISelectAll a{font-size:.75em}.handsontable .htUISelectionControls{text-align:right}[dir=rtl].handsontable .htUISelectionControls{text-align:left}.handsontable .htCheckboxRendererInput{height:1em;margin:0 5px 0 0;vertical-align:middle}[dir=rtl].handsontable .htCheckboxRendererInput{margin-left:5px;margin-right:0}.handsontable .htUIInput{padding:3px 0 7px;position:relative;text-align:center}.handsontable .htUIInput input{border:1px solid #d2d1d1;border-radius:2px}.handsontable .htUIInputIcon{position:absolute}.handsontable .htUIInput.htUIButton{cursor:pointer;display:inline-block}.handsontable .htUIInput.htUIButton input{background-color:#eee;color:#000;cursor:pointer;font-family:inherit;font-size:.75em;font-weight:700;height:19px;min-width:64px}.handsontable .htUIInput.htUIButton input:hover{border-color:#b9b9b9}.handsontable .htUIInput.htUIButtonOK{margin-left:0;margin-right:10px}[dir=rtl].handsontable .htUIInput.htUIButtonOK{margin-left:10px;margin-right:0}.handsontable .htUIInput.htUIButtonOK input{background-color:#0f9d58;border-color:#18804e;color:#fff}.handsontable .htUIInput.htUIButtonOK input:focus-visible{background-color:#92dd8d;border-color:#7cb878;color:#000}.handsontable .htUIInput.htUIButtonOK input:hover{border-color:#1a6f46}.handsontable .htUISelect{cursor:pointer;margin-bottom:7px;position:relative}.handsontable .htUISelectCaption{background-color:#e8e8e8;border:1px solid #d2d1d1;border-radius:2px;font-family:inherit;font-size:.75em;font-weight:700;overflow:hidden;padding:3px 20px 3px 10px;text-overflow:ellipsis;white-space:nowrap}.handsontable .htUISelectCaption:hover{background-color:#e8e8e8;border:1px solid #b9b9b9}.handsontable .htUISelectDropdown:after{content:"▲";font-size:7px;position:absolute;right:10px;top:0}.handsontable .htUISelectDropdown:before{content:"▼";font-size:7px;position:absolute;right:10px;top:8px}.handsontable .htUIMultipleSelect .handsontable .htCore{border:none}.handsontable .htUIMultipleSelect .handsontable .htCore td:hover{background-color:#f5f5f5}.handsontable .htUIMultipleSelectSearch input{border:1px solid #d2d1d1;border-radius:2px;padding:3px}.handsontable .htUIRadio{display:inline-block;height:100%;margin-left:0;margin-right:5px}[dir=rtl].handsontable .htUIRadio{margin-left:5px;margin-right:0}.handsontable .htUIRadio:last-child{margin-right:0}.handsontable .htUIRadio>input[type=radio]{margin-left:0;margin-right:.5ex}[dir=rtl].handsontable .htUIRadio>input[type=radio]{margin-left:.5ex;margin-right:0}.handsontable .htUIRadio label{vertical-align:middle}.handsontable .htFiltersMenuOperators{padding-bottom:5px}.handsontable th.beforeHiddenColumn{position:relative}.handsontable th.afterHiddenColumn:before,.handsontable th.beforeHiddenColumn:after{color:#bbb;font-size:5pt;position:absolute;top:50%;transform:translateY(-50%)}.handsontable th.afterHiddenColumn{position:relative}.handsontable[dir=ltr] th.afterHiddenColumn div.htLeft{margin-left:10px}.handsontable[dir=ltr] th.beforeHiddenColumn div.htRight,.handsontable[dir=rtl] th.afterHiddenColumn div.htRight{margin-right:10px}.handsontable[dir=rtl] th.beforeHiddenColumn div.htLeft{margin-left:10px}.handsontable th.beforeHiddenColumn:after{content:"◀";right:1px}[dir=rtl].handsontable th.beforeHiddenColumn:after{content:"▶";left:1px;right:auto}.handsontable th.afterHiddenColumn:before{content:"▶";left:1px}[dir=rtl].handsontable th.afterHiddenColumn:before{content:"◀";left:auto;right:1px}/*!
 * Handsontable HiddenRows
 */.handsontable th.afterHiddenRow:after,.handsontable th.beforeHiddenRow:before{color:#bbb;font-size:6pt;left:2px;line-height:6pt;position:absolute}.handsontable th.afterHiddenRow,.handsontable th.beforeHiddenRow{position:relative}.handsontable th.beforeHiddenRow:before{bottom:2px;content:"▲"}.handsontable th.afterHiddenRow:after{content:"▼";top:2px}.handsontable.ht__selection--rows tbody th.afterHiddenRow.ht__highlight:after,.handsontable.ht__selection--rows tbody th.beforeHiddenRow.ht__highlight:before{color:#eee}.handsontable td.afterHiddenRow.firstVisibleRow,.handsontable th.afterHiddenRow.firstVisibleRow{border-top:1px solid #ccc}.htRowHeaders .ht_master.innerBorderInlineStart~.ht_clone_inline_start td:first-of-type,.htRowHeaders .ht_master.innerBorderInlineStart~.ht_clone_top_inline_start_corner th:nth-child(2){border-left:0}.handsontable.ht__manualColumnMove.after-selection--columns thead th.ht__highlight{cursor:move;cursor:-moz-grab;cursor:-webkit-grab;cursor:grab}.handsontable.ht__manualColumnMove.on-moving--columns *,.handsontable.ht__manualColumnMove.on-moving--columns thead th.ht__highlight{cursor:move;cursor:-moz-grabbing;cursor:-webkit-grabbing;cursor:grabbing}.handsontable.ht__manualColumnMove.on-moving--columns .manualColumnResizer{display:none}.handsontable .ht__manualColumnMove--backlight,.handsontable .ht__manualColumnMove--guideline{display:none;height:100%;position:absolute}.handsontable .ht__manualColumnMove--guideline{background:#757575;margin-inline-end:0;margin-inline-start:-1px;top:0;width:2px;z-index:205}.handsontable .ht__manualColumnMove--backlight{background:#343434;background:#34343440;display:none;pointer-events:none;z-index:205}.handsontable.on-moving--columns .ht__manualColumnMove--backlight,.handsontable.on-moving--columns.show-ui .ht__manualColumnMove--guideline{display:block}.handsontable .wtHider{position:relative}.handsontable.ht__manualRowMove.after-selection--rows tbody th.ht__highlight{cursor:move;cursor:-moz-grab;cursor:-webkit-grab;cursor:grab}.handsontable.ht__manualRowMove.on-moving--rows *,.handsontable.ht__manualRowMove.on-moving--rows tbody th.ht__highlight{cursor:move;cursor:-moz-grabbing;cursor:-webkit-grabbing;cursor:grabbing}.handsontable.ht__manualRowMove.on-moving--rows .manualRowResizer{display:none}.handsontable .ht__manualRowMove--backlight,.handsontable .ht__manualRowMove--guideline{display:none;position:absolute;width:100%}.handsontable .ht__manualRowMove--guideline{background:#757575;height:2px;left:0;margin-top:-1px;z-index:205}.handsontable .ht__manualRowMove--backlight{background:#343434;background:#34343440;display:none;pointer-events:none;z-index:205}.handsontable.on-moving--rows .ht__manualRowMove--backlight,.handsontable.on-moving--rows.show-ui .ht__manualRowMove--guideline{display:block}.handsontable tbody td[rowspan][class*=area][class*=highlight]:not([class*=fullySelectedMergedCell]):before{opacity:0}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-0]:before,.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-multiple]:before{opacity:.1}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-1]:before{opacity:.2}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-2]:before{opacity:.27}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-3]:before{opacity:.35}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-4]:before{opacity:.41}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-5]:before{opacity:.47}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-6]:before{opacity:.54}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-7]:before{opacity:.58}.handsontable[dir=ltr] div.htRight span[class*=sort-]{margin-left:-15px;margin-right:15px}.handsontable[dir=rtl] div.htLeft span[class*=sort-]{margin-left:15px;margin-right:-15px}.handsontable[dir=ltr] div.htRight span[class*=sort-]:only-child{margin-left:-20px;margin-right:20px}.handsontable[dir=rtl] div.htLeft span[class*=sort-]:only-child{margin-left:20px;margin-right:-20px}.handsontable span.colHeader.columnSorting:after{font-size:8px;height:8px;left:unset;line-height:1.1;margin-top:-2px;padding-left:5px;padding-right:unset;position:absolute;right:-15px;text-decoration:underline;top:50%}[dir=rtl].handsontable span.colHeader.columnSorting:after{left:-15px;padding-left:unset;padding-right:5px;right:unset}.handsontable span.colHeader.columnSorting:after{text-decoration:none}.handsontable span.colHeader.columnSorting[class*=" sort-"]:after,.handsontable span.colHeader.columnSorting[class^=sort-]:after{content:"+"}.handsontable span.colHeader.columnSorting.sort-1:after{content:"1"}.handsontable span.colHeader.columnSorting.sort-2:after{content:"2"}.handsontable span.colHeader.columnSorting.sort-3:after{content:"3"}.handsontable span.colHeader.columnSorting.sort-4:after{content:"4"}.handsontable span.colHeader.columnSorting.sort-5:after{content:"5"}.handsontable span.colHeader.columnSorting.sort-6:after{content:"6"}.handsontable span.colHeader.columnSorting.sort-7:after{content:"7"}.htGhostTable th div button.changeType+span.colHeader.columnSorting:not(.indicatorDisabled){padding-right:5px}.handsontable thead th.hiddenHeader:not(:first-of-type){display:none}.handsontable th.ht_nestingLevels{padding-left:7px;text-align:left}[dir=rtl].handsontable th.ht_nestingLevels{padding-right:7px;text-align:right}.handsontable th div.ht_nestingLevels{display:inline-block;left:11px;position:absolute;right:unset}[dir=rtl].handsontable th div.ht_nestingLevels{left:unset;right:11px}.handsontable.innerBorderInlineStart th div.ht_nestingLevels,.handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingLevels{left:unset;right:10px}[dir=rtl].handsontable.innerBorderInlineStart th div.ht_nestingLevels,[dir=rtl].handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingLevels{left:10px;right:unset}.handsontable th span.ht_nestingLevel{display:inline-block}.handsontable th span.ht_nestingLevel_empty{display:inline-block;float:left;height:1px;width:10px}[dir=rtl].handsontable th span.ht_nestingLevel_empty{float:right}.handsontable th span.ht_nestingLevel:after{bottom:3px;content:"┐";display:inline-block;font-size:9px;position:relative}.handsontable th div.ht_nestingButton{cursor:pointer;display:inline-block;left:unset;position:absolute;right:-2px}[dir=rtl].handsontable th div.ht_nestingButton{left:-2px;right:unset}.handsontable th div.ht_nestingButton.ht_nestingExpand:after{content:"+"}.handsontable th div.ht_nestingButton.ht_nestingCollapse:after{content:"-"}.handsontable.innerBorderInlineStart th div.ht_nestingButton,.handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingButton{left:unset;right:0}[dir=rtl].handsontable.innerBorderInlineStart th div.ht_nestingButton,[dir=rtl].handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingButton{left:0;right:unset}`;function tn(t){const e=document.createElement("template");return e.innerHTML=t,e.content.firstElementChild}function Xs(t,e){return new Promise(n=>{const r=e==null?void 0:e.waitSelector,i=(e==null?void 0:e.timeout)??3e3;if(i!==0){const a=document.querySelector(t);if(a){n(a);return}}const o=setTimeout(()=>{i!==0&&(s.disconnect(),n(null))},i),s=new MutationObserver(a=>{for(const l of a)for(const c of Array.from(l.addedNodes))if(c instanceof Element&&c.matches(r??t)){i!==0&&(s.disconnect(),clearTimeout(o)),n(r?document.querySelector(t):c);return}});s.observe(document.body,{childList:!0,subtree:!0})})}const Jv=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 80" height="32">
  <path d="M25.5 14.9c-6.9 1.7-13.4 6.9-15.4 12.4-.6 1.6-1.1 5.2-1.1 8.1 0 7.3 5.3 17.9 13 25.7 5.6 5.7 6 5.9 10.9 5.9H38l-6.3-6.4c-8-8.2-11.7-15-12.4-22.5-.7-7.6 2-13.2 7.9-16.2 3.8-2 5.3-2.1 16.3-1.6 7.8.3 14.6 1.3 19.4 2.7 4 1.1 7.6 1.8 7.9 1.5 2.3-2.2-12.4-7.5-26.4-9.5-8.4-1.1-14.4-1.2-18.9-.1z" />
  <path d="M38 27.2c-12.8 6.5-11.9 21.3 2.1 34.3 4.6 4.2 6.7 5.5 9.1 5.5h3.1l-5.5-5.8c-7.2-7.5-10.2-13.3-9.5-18.3.6-4.7 3.2-8.4 7.4-10.4 3.5-1.7 17.3-2 23.6-.6 2.9.7 3.7.6 3.7-.5 0-1.8-3.5-3.2-12.8-5-10.5-2-16-1.8-21.2.8zM95.2 41.3c-3.4 8.9-6.2 16.6-6.2 17 0 .4.9.7 1.9.7 1.4 0 2.4-1.3 3.7-4.5l1.7-4.5h14.5l1.4 4.2c1.1 3.1 2.1 4.4 3.6 4.6 1.2.2 2.2 0 2.2-.5 0-.4-2.8-8.1-6.2-17-8.3-21.6-8.3-21.6-16.6 0zm13.8 4.4c0 .2-2.5.3-5.6.3-4.1 0-5.5-.3-5.2-1.3.3-.6 1.5-4.3 2.8-8.1l2.3-6.9 2.8 7.8c1.6 4.4 2.9 8 2.9 8.2zM126.2 41.3c-3.4 8.9-6.2 16.5-6.2 16.9 0 .5.9.8 1.9.8 1.4 0 2.4-1.3 3.7-4.5l1.7-4.5h14.5l1.4 4.2c1.1 3.2 2.1 4.4 3.7 4.6 2.8.4 3 1.2-4.4-18.1-8-20.9-8-20.9-16.3.6zm13.8 4.4c0 .2-2.5.3-5.6.3-4.1 0-5.5-.3-5.2-1.3.3-.6 1.5-4.3 2.8-8.1l2.3-7 2.8 8c1.6 4.3 2.9 8 2.9 8.1zM160.3 27.1c-8.3 4.1-11.6 15.2-7.1 23.9 2.8 5.5 7.3 8.2 13.6 8.3 6.2.1 9.2-1 9.2-3.3 0-1.7-.4-1.8-3.1-.8-4.3 1.5-10.6.4-13.5-2.3-3-2.8-4.7-8.8-3.8-13.5 1.4-7.6 9.1-12.5 16.4-10.4 1.9.6 3.6 1 3.7 1 1.1 0 0-3.9-1.3-4.4-3.2-1.2-10-.5-14.1 1.5z" />
  <path d="M54.3 35.7c-2.8.5-7.2 4.9-7.9 8-1.1 4.1.6 9.1 4.6 14.1 5.5 7 9.5 9.2 16.5 9.2h5.7l-.4-14.1c-.3-13.4-.5-14.2-2.7-16-2.3-1.8-9.6-2.4-15.8-1.2z" />
</svg>
`,ey=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 78 20" height="32">
  <path fill="#aeaeae" d="M17.48 1.22A2.78 2.78 0 0 1 19 3.88v11.25a2.722 2.722 0 0 1-1.34 2.59 2.204 2.204 0 0 1-1.1.28 4.2 4.2 0 0 1-2.68-1.24l-4.24-3.38a.81.81 0 0 1-.295-.757.805.805 0 0 1 .175-.383.84.84 0 0 1 1.16-.12l4.25 3.4c.81.69 1.52 1 1.9.77.14-.08.5-.28.5-1.18V3.88a1.229 1.229 0 0 0-.56-1.19c-.79-.36-1.72.63-2.08 1.07-.55.59-2.34 2.94-4.18 5.39l-.62.85-1.58 2.11c-1.52 2-2.84 3.81-3.31 4.38-1.23 1.7-2.47 1.66-3.29 1.33A2.998 2.998 0 0 1 0 14.76V9.59a2.785 2.785 0 0 1 1.45-2.78 3.084 3.084 0 0 1 3.42.83L6.47 9a.805.805 0 0 1 .28.761.795.795 0 0 1-.18.379.832.832 0 0 1-1.16.09L3.8 8.87c-1-.9-1.43-.71-1.62-.62-.19.09-.52.26-.53 1.35v5.16c0 .48.09 1.32.68 1.56.17.07.6.24 1.34-.78C4.13 15 5.45 13.2 7 11.15L7.85 10l.65-.87c2.16-2.89 4.25-5.65 4.94-6.4C15.26.54 16.87 1 17.48 1.22ZM43.15 3.42a1.294 1.294 0 0 0-1.119.665 1.29 1.29 0 0 0-.161.655h2.5a1.206 1.206 0 0 0-.577-1.144 1.205 1.205 0 0 0-.643-.176ZM25 2.27h-.08l-1 2.79h2Zm11.1 1.2c-.83 0-1.34.66-1.34 1.71 0 1.05.51 1.71 1.34 1.71.83 0 1.33-.64 1.33-1.71 0-1.07-.55-1.71-1.38-1.71Zm-5.34 0c-.83 0-1.34.66-1.34 1.71 0 1.05.51 1.71 1.33 1.71.82 0 1.25-.64 1.25-1.71 0-1.07-.46-1.71-1.29-1.71Zm-5.29-2.36 2.38 6.53h-1.09l-.6-1.77h-2.51l-.6 1.77H22l2.37-6.53ZM40.12.8v6.84h-1V.8Zm3 1.83a2.172 2.172 0 0 1 2.21 2.48v.33h-3.5a1.327 1.327 0 0 0 .617 1.262c.211.131.455.199.703.198a1.183 1.183 0 0 0 1.18-.62h.94a1.999 1.999 0 0 1-2.15 1.41 2.245 2.245 0 0 1-2.093-1.276 2.238 2.238 0 0 1-.197-1.264 2.282 2.282 0 0 1 2.33-2.52ZM31 2.64c1.26 0 2.06 1 2.06 2.54S32.24 7.72 31 7.72a1.617 1.617 0 0 1-1.53-.82h-.07v2.37h-1V2.73h.94v.81h.07a1.738 1.738 0 0 1 1.59-.9Zm5.34 0c1.27 0 2.06 1 2.06 2.54s-.79 2.54-2.05 2.54a1.61 1.61 0 0 1-1.52-.82h-.08v2.37h-1V2.73h.94v.81h.07a1.753 1.753 0 0 1 1.56-.9Zm.26 8.27a.621.621 0 0 1 .557.893.625.625 0 0 1-.702.33.621.621 0 0 1 .125-1.223Zm-7.3 0a.621.621 0 0 1 .557.893.625.625 0 0 1-.702.33.621.621 0 0 1 .125-1.223Zm43 2.8A1.278 1.278 0 0 0 71 15h2.5a1.203 1.203 0 0 0-.587-1.119 1.214 1.214 0 0 0-.633-.171Zm-39.46 0c-.85 0-1.32.64-1.32 1.64 0 1 .47 1.65 1.32 1.65.85 0 1.34-.64 1.34-1.65 0-1.01-.53-1.59-1.36-1.59Zm-8-1.49h-1.31V17h1.24c1.37 0 2.17-.87 2.17-2.39a2.099 2.099 0 0 0-.2-1.177 2.096 2.096 0 0 0-1.97-1.163Zm36 3.41-1.21.09c-.68 0-1 .28-1 .73 0 .45.39.72.92.72a1.17 1.17 0 0 0 1.28-1.11ZM44 15.68l-1.21.09c-.68 0-1 .28-1 .73 0 .45.39.72.92.72A1.168 1.168 0 0 0 44 16.11ZM24.88 11.4a2.894 2.894 0 0 1 2.83 1.572c.261.515.362 1.096.29 1.668 0 2.08-1.13 3.28-3.09 3.28h-2.4V11.4Zm4.89 1.6v4.91h-1V13Zm21.58-1.6 2.09 5.1h.08l2.1-5.1h1.19v6.52h-1v-4.78h-.01l-1.93 4.67h-.77l-1.93-4.67h-.06v4.78h-1V11.4ZM47 11.09v6.83h-1v-6.83ZM37.07 13v4.91h-1V13Zm40.49-.08c.149.015.296.041.44.08v.92a2.427 2.427 0 0 0-.55-.06 1.174 1.174 0 0 0-1.079.541 1.165 1.165 0 0 0-.181.599v2.93h-1V13h.94v.75h.07a1.34 1.34 0 0 1 1.36-.82Zm-38.19-1.15V13h1.07v.77h-1.07v2.6c0 .52.21.75.7.75.123.011.247.011.37 0v.78a4.26 4.26 0 0 1-.53 0c-1.09 0-1.52-.37-1.52-1.32V13.8h-.79V13h.79v-1.23Zm29.17 0V13h1.07v.77h-1.07v2.6c0 .52.21.75.7.75.123.011.247.011.37 0v.78a4.26 4.26 0 0 1-.53 0c-1.09 0-1.52-.37-1.52-1.32V13.8h-.79V13h.79v-1.23Zm-8.73 1.15c1.25 0 1.95.61 1.95 1.64v3.36h-.94v-.69h-.08a1.678 1.678 0 0 1-1.49.77 1.493 1.493 0 0 1-1.424-.675 1.497 1.497 0 0 1-.236-.785c0-.88.67-1.39 1.85-1.47l1.34-.07v-.43c0-.53-.34-.84-1-.84-.66 0-.93.21-1 .56h-.94c.05-.83.85-1.37 1.97-1.37Zm-16.75 0c1.25 0 1.95.61 1.95 1.64v3.36h-.94v-.69H44a1.682 1.682 0 0 1-1.5.77 1.493 1.493 0 0 1-1.424-.675 1.497 1.497 0 0 1-.236-.785c0-.88.67-1.39 1.85-1.47L44 15v-.43c0-.53-.34-.84-1-.84-.66 0-.93.21-1 .56h-1c.14-.83.94-1.37 2.06-1.37Zm21.44 0c1.12 0 1.84.51 1.94 1.36h-.94c-.09-.36-.44-.6-1-.6s-1 .26-1 .66.25.49.79.62l.82.19c.94.22 1.39.62 1.39 1.34 0 .91-.87 1.53-2.06 1.53s-2-.53-2-1.39h1c.082.212.233.39.429.505.197.114.426.158.651.125.61 0 1-.28 1-.68s-.23-.51-.73-.63l-.87-.2c-.94-.22-1.38-.63-1.38-1.36 0-.73.84-1.47 1.96-1.47Zm7.79 0a2.158 2.158 0 0 1 2.21 2.47v.34H71a1.326 1.326 0 0 0 .62 1.253c.21.13.453.198.7.197a1.174 1.174 0 0 0 1.18-.61h.94A2 2 0 0 1 72.29 18a2.237 2.237 0 0 1-2.085-1.265A2.245 2.245 0 0 1 70 15.48a2.29 2.29 0 0 1 .205-1.263 2.28 2.28 0 0 1 2.085-1.297Zm-39.74 0a1.73 1.73 0 0 1 1.56.86h.07V13h.94v5c0 1.12-.89 1.83-2.29 1.83-1.24 0-2-.55-2.15-1.37h1c.08.37.49.6 1.15.6.82 0 1.3-.4 1.3-1.06v-1h-.07a1.665 1.665 0 0 1-.647.632 1.667 1.667 0 0 1-.883.198c-1.27 0-2.05-1-2.05-2.45 0-1.45.8-2.45 2.07-2.45Z" />
  <path fill="#aeaeae" d="M43.15 3.42a1.294 1.294 0 0 0-1.119.665 1.29 1.29 0 0 0-.161.655h2.5a1.206 1.206 0 0 0-.577-1.144 1.205 1.205 0 0 0-.643-.176ZM25 2.27h-.08l-1 2.79h2Zm11.1 1.2c-.83 0-1.34.66-1.34 1.71 0 1.05.51 1.71 1.34 1.71.83 0 1.33-.64 1.33-1.71 0-1.07-.55-1.71-1.38-1.71Zm-5.34 0c-.83 0-1.34.66-1.34 1.71 0 1.05.51 1.71 1.33 1.71.82 0 1.25-.64 1.25-1.71 0-1.07-.46-1.71-1.29-1.71Zm-5.29-2.36 2.38 6.53h-1.09l-.6-1.77h-2.51l-.6 1.77H22l2.37-6.53ZM40.12.8v6.84h-1V.8Zm3 1.83a2.172 2.172 0 0 1 2.21 2.48v.33h-3.5a1.327 1.327 0 0 0 .617 1.262c.211.131.455.199.703.198a1.183 1.183 0 0 0 1.18-.62h.94a1.999 1.999 0 0 1-2.15 1.41 2.245 2.245 0 0 1-2.093-1.276 2.238 2.238 0 0 1-.197-1.264 2.282 2.282 0 0 1 2.33-2.52ZM31 2.64c1.26 0 2.06 1 2.06 2.54S32.24 7.72 31 7.72a1.617 1.617 0 0 1-1.53-.82h-.07v2.37h-1V2.73h.94v.81h.07a1.738 1.738 0 0 1 1.59-.9Zm5.34 0c1.27 0 2.06 1 2.06 2.54s-.79 2.54-2.05 2.54a1.61 1.61 0 0 1-1.52-.82h-.08v2.37h-1V2.73h.94v.81h.07a1.753 1.753 0 0 1 1.56-.9Zm.26 8.27a.621.621 0 0 1 .557.893.625.625 0 0 1-.702.33.621.621 0 0 1 .125-1.223Zm-7.3 0a.621.621 0 0 1 .557.893.625.625 0 0 1-.702.33.621.621 0 0 1 .125-1.223Zm43 2.8A1.278 1.278 0 0 0 71 15h2.5a1.203 1.203 0 0 0-.587-1.119 1.214 1.214 0 0 0-.633-.171Zm-39.46 0c-.85 0-1.32.64-1.32 1.64 0 1 .47 1.65 1.32 1.65.85 0 1.34-.64 1.34-1.65 0-1.01-.53-1.59-1.36-1.59Zm-8-1.49h-1.31V17h1.24c1.37 0 2.17-.87 2.17-2.39a2.099 2.099 0 0 0-.2-1.177 2.096 2.096 0 0 0-1.97-1.163Zm36 3.41-1.21.09c-.68 0-1 .28-1 .73 0 .45.39.72.92.72a1.17 1.17 0 0 0 1.28-1.11ZM44 15.68l-1.21.09c-.68 0-1 .28-1 .73 0 .45.39.72.92.72A1.168 1.168 0 0 0 44 16.11ZM24.88 11.4a2.894 2.894 0 0 1 2.83 1.572c.261.515.362 1.096.29 1.668 0 2.08-1.13 3.28-3.09 3.28h-2.4V11.4Zm4.89 1.6v4.91h-1V13Zm21.58-1.6 2.09 5.1h.08l2.1-5.1h1.19v6.52h-1v-4.78h-.01l-1.93 4.67h-.77l-1.93-4.67h-.06v4.78h-1V11.4ZM47 11.09v6.83h-1v-6.83ZM37.07 13v4.91h-1V13Zm40.49-.08c.149.015.296.041.44.08v.92a2.427 2.427 0 0 0-.55-.06 1.174 1.174 0 0 0-1.079.541 1.165 1.165 0 0 0-.181.599v2.93h-1V13h.94v.75h.07a1.34 1.34 0 0 1 1.36-.82Zm-38.19-1.15V13h1.07v.77h-1.07v2.6c0 .52.21.75.7.75.123.011.247.011.37 0v.78a4.26 4.26 0 0 1-.53 0c-1.09 0-1.52-.37-1.52-1.32V13.8h-.79V13h.79v-1.23Zm29.17 0V13h1.07v.77h-1.07v2.6c0 .52.21.75.7.75.123.011.247.011.37 0v.78a4.26 4.26 0 0 1-.53 0c-1.09 0-1.52-.37-1.52-1.32V13.8h-.79V13h.79v-1.23Zm-8.73 1.15c1.25 0 1.95.61 1.95 1.64v3.36h-.94v-.69h-.08a1.678 1.678 0 0 1-1.49.77 1.493 1.493 0 0 1-1.424-.675 1.497 1.497 0 0 1-.236-.785c0-.88.67-1.39 1.85-1.47l1.34-.07v-.43c0-.53-.34-.84-1-.84-.66 0-.93.21-1 .56h-.94c.05-.83.85-1.37 1.97-1.37Zm-16.75 0c1.25 0 1.95.61 1.95 1.64v3.36h-.94v-.69H44a1.682 1.682 0 0 1-1.5.77 1.493 1.493 0 0 1-1.424-.675 1.497 1.497 0 0 1-.236-.785c0-.88.67-1.39 1.85-1.47L44 15v-.43c0-.53-.34-.84-1-.84-.66 0-.93.21-1 .56h-1c.14-.83.94-1.37 2.06-1.37Zm21.44 0c1.12 0 1.84.51 1.94 1.36h-.94c-.09-.36-.44-.6-1-.6s-1 .26-1 .66.25.49.79.62l.82.19c.94.22 1.39.62 1.39 1.34 0 .91-.87 1.53-2.06 1.53s-2-.53-2-1.39h1c.082.212.233.39.429.505.197.114.426.158.651.125.61 0 1-.28 1-.68s-.23-.51-.73-.63l-.87-.2c-.94-.22-1.38-.63-1.38-1.36 0-.73.84-1.47 1.96-1.47Zm7.79 0a2.158 2.158 0 0 1 2.21 2.47v.34H71a1.326 1.326 0 0 0 .62 1.253c.21.13.453.198.7.197a1.174 1.174 0 0 0 1.18-.61h.94A2 2 0 0 1 72.29 18a2.237 2.237 0 0 1-2.085-1.265A2.245 2.245 0 0 1 70 15.48a2.29 2.29 0 0 1 .205-1.263 2.28 2.28 0 0 1 2.085-1.297Zm-39.74 0a1.73 1.73 0 0 1 1.56.86h.07V13h.94v5c0 1.12-.89 1.83-2.29 1.83-1.24 0-2-.55-2.15-1.37h1c.08.37.49.6 1.15.6.82 0 1.3-.4 1.3-1.06v-1h-.07a1.665 1.665 0 0 1-.647.632 1.667 1.667 0 0 1-.883.198c-1.27 0-2.05-1-2.05-2.45 0-1.45.8-2.45 2.07-2.45ZM0 0" />
</svg>
`,ty=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 43 20" height="32">
  <path d="m11.418 12.526 2.344 5.44h-1.107l-.507-1.245H9.79l-.492 1.245H8.215l2.366-5.44h.837Zm6.521 0v.845h-1.668v4.595h-.968v-4.595h-1.667v-.845h4.303Zm2.721 0 1.413 3.865h.023l1.398-3.865h1.522v5.44h-.961v-4.372h-.015l-1.652 4.372h-.676l-1.628-4.372h-.016v4.372h-.922v-5.44h1.514Zm8.281.001c.405 0 .778.063 1.119.189.341.127.636.308.885.542.248.233.442.517.581.851.139.334.208.708.208 1.122 0 .405-.069.774-.208 1.108a2.57 2.57 0 0 1-.581.863 2.652 2.652 0 0 1-.885.563 3.034 3.034 0 0 1-1.119.201c-.399 0-.769-.067-1.107-.201a2.61 2.61 0 0 1-.878-.563 2.59 2.59 0 0 1-.577-.863 2.855 2.855 0 0 1-.208-1.108c0-.414.069-.788.208-1.122a2.453 2.453 0 0 1 1.455-1.393 3.15 3.15 0 0 1 1.107-.189Zm5.722.008c.262 0 .528.046.798.138.27.093.504.231.703.416l-.597.656a1.118 1.118 0 0 0-.412-.317 1.232 1.232 0 0 0-.857-.088.972.972 0 0 0-.291.124.682.682 0 0 0-.215.219.601.601 0 0 0-.084.324.576.576 0 0 0 .273.51c.085.059.189.11.31.153.122.044.255.088.401.132.165.053.337.114.514.182.177.068.34.158.488.269.148.112.27.253.365.423.094.17.142.382.142.634 0 .277-.051.519-.153.725a1.483 1.483 0 0 1-.409.514 1.74 1.74 0 0 1-.597.306 2.52 2.52 0 0 1-.722.102 2.71 2.71 0 0 1-.984-.186 1.895 1.895 0 0 1-.787-.55l.656-.612c.126.175.295.313.507.415.211.102.419.153.623.153.107 0 .216-.013.328-.04a.86.86 0 0 0 .302-.134.774.774 0 0 0 .219-.237.687.687 0 0 0 .084-.354.577.577 0 0 0-.095-.339.847.847 0 0 0-.255-.233 1.778 1.778 0 0 0-.379-.171l-.459-.153a4.663 4.663 0 0 1-.467-.175 1.55 1.55 0 0 1-.419-.27 1.29 1.29 0 0 1-.302-.412 1.4 1.4 0 0 1-.117-.608c0-.263.055-.489.164-.678.109-.189.253-.346.43-.47.178-.124.379-.216.605-.277.226-.061.456-.091.689-.091Zm-5.714.876a1.62 1.62 0 0 0-1.238.527c-.15.164-.266.356-.348.576-.082.221-.123.46-.123.718 0 .267.041.512.123.734.082.223.199.417.352.581.152.164.332.291.541.383.209.091.44.137.693.137.253 0 .485-.046.696-.137a1.61 1.61 0 0 0 .545-.383c.152-.164.269-.358.351-.581.082-.222.124-.467.124-.734 0-.258-.042-.497-.124-.718a1.763 1.763 0 0 0-.347-.576 1.627 1.627 0 0 0-.542-.387 1.707 1.707 0 0 0-.703-.14Zm-17.976.268-.853 2.212h1.69l-.837-2.212ZM38.017 3.527l1.55 3.484 1.549-3.484h1.3l-3.081 6.884a1.542 1.542 0 0 1-2.031.782l-.412-.184-.002-.001.148-.331.332-.747.171.076a.634.634 0 0 0 .837-.322l.003-.008.476-1.075.016-.035.044-.096-2.199-4.943h1.299ZM30.294 1.11v7.855h-1.189V1.11h1.189Zm2.192.001v2.905c.44-.308.976-.49 1.554-.49a2.722 2.722 0 0 1 2.719 2.719 2.722 2.722 0 0 1-2.719 2.718 2.702 2.702 0 0 1-1.554-.49v.492h-1.192V1.111h1.192Zm-6.869 2.415a2.72 2.72 0 0 1 2.718 2.718 2.72 2.72 0 0 1-2.718 2.719 2.721 2.721 0 0 1-2.719-2.719 2.72 2.72 0 0 1 2.719-2.718ZM3.157 1.109A3.93 3.93 0 0 1 7.08 5.032a3.93 3.93 0 0 1-3.923 3.923H2V1.109h1.157Zm10.005 0v7.846h-1.157a3.93 3.93 0 0 1-3.924-3.923 3.93 3.93 0 0 1 3.924-3.923h1.157Zm5.21 0a3.928 3.928 0 0 1 3.923 3.923 3.928 3.928 0 0 1-3.923 3.923h-2.834V1.109Zm7.245 3.486a1.64 1.64 0 0 0 0 3.278 1.64 1.64 0 0 0 1.639-1.639c0-.899-.74-1.639-1.639-1.639Zm8.423 0a1.64 1.64 0 0 0 0 3.279c.9 0 1.639-.73 1.639-1.639 0-.9-.739-1.64-1.639-1.64ZM18.372 2.299h-1.645v5.467h1.645a2.738 2.738 0 0 0 2.733-2.734 2.737 2.737 0 0 0-2.733-2.733Z" stroke="#00000000" fill-rule="evenodd" />
</svg>
`,ny=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 20" height="32">
  <path d="M9.21 3.13c.131.166.249.344.35.53a7.554 7.554 0 0 0-.49.94c-.1-.2-.2-.4-.31-.59.134-.301.284-.595.45-.88ZM7.64 7.82c.08.25.17.51.25.77-.15.76-.25 1.46-.32 2a.204.204 0 0 1-.065.129.202.202 0 0 1-.135.051.21.21 0 0 1-.18-.23c.1-.75.25-1.72.45-2.72Zm-2-4.69c.135.166.255.343.36.53a19.651 19.651 0 0 0-2 7 .204.204 0 0 1-.065.129.202.202 0 0 1-.135.051.21.21 0 0 1-.18-.23c.29-2.12.8-5.43 2.01-7.48Zm13.23 4.92a.192.192 0 0 1 .159.118.187.187 0 0 1 .011.102C19 9.07 18.8 10 18.6 11l-.25-.77c.14-.76.25-1.46.32-2a.204.204 0 0 1 .065-.129.202.202 0 0 1 .135-.051Zm3.58 0a.206.206 0 0 1 .164.117c.014.032.02.068.016.103-.32 2.09-.83 5.4-2 7.45a5.451 5.451 0 0 1-.35-.53 19.87 19.87 0 0 0 2-7 .21.21 0 0 1 .064-.096.204.204 0 0 1 .106-.044Zm-5.28 6.21.3.59a7.082 7.082 0 0 1-.44.88 4.454 4.454 0 0 1-.35-.53c.179-.305.343-.618.49-.94Zm-8.64-13a2.895 2.895 0 0 1 1.75.62 4.1 4.1 0 0 1 .54.48c2.71 2.79 3.86 10.16 5.68 13.14.085.153.185.297.3.43a1.81 1.81 0 0 0 1.38.88c.19-.002.377-.043.55-.12.175.189.366.363.57.52a3 3 0 0 1-1.59.44A2.861 2.861 0 0 1 16 17a5.34 5.34 0 0 1-.55-.48c-2.7-2.8-3.85-10.16-5.67-13.14-.55-.9-1.26-1.58-2.23-1.19a4.765 4.765 0 0 0-.57-.53 3.003 3.003 0 0 1 1.55-.43Zm-4.06 0c6-.81 6.42 15.51 10.13 15.51.19-.002.377-.043.55-.12.173.192.363.366.57.52-.48.289-1.03.442-1.59.44C10.88 17.62 9.26 11.88 8 8c-.08-.26-.17-.51-.25-.76a19.99 19.99 0 0 0-1.6-3.87 4.491 4.491 0 0 0-.37-.53 1.53 1.53 0 0 0-2.36-.38C1.55 3.82.68 8.33.41 10.62a.211.211 0 0 1-.21.18.211.211 0 0 1-.2-.22C.41 8 1.08 3.57 3 1.92a2.878 2.878 0 0 1 1.47-.65Zm7.64 0c3.25 0 4.86 5.75 6.12 9.61.08.26.17.51.25.76a19.99 19.99 0 0 0 1.6 3.87c.111.18.231.353.36.52a1.743 1.743 0 0 0 1.32.79 1.817 1.817 0 0 0 1-.4c1.87-1.35 2.74-5.85 3-8.14a.195.195 0 0 1 .068-.122.196.196 0 0 1 .132-.048.206.206 0 0 1 .164.117c.014.032.02.068.016.103-.41 2.59-1.08 7-3 8.66a3 3 0 0 1-1.93.69c-5.43 0-6.07-15.54-9.65-15.54-.19.002-.377.043-.55.12a4.765 4.765 0 0 0-.57-.53 3 3 0 0 1 1.67-.49ZM36.59 1a.6.6 0 1 1-.021 1.2.6.6 0 0 1 .021-1.2Zm7.81 1.31H43v2.28h1.44a1.07 1.07 0 0 0 1.21-1.14 1.097 1.097 0 0 0-.623-1.042 1.094 1.094 0 0 0-.627-.098Zm5 1.43A1.259 1.259 0 0 0 48.1 5h2.45a1.19 1.19 0 0 0-1.19-1.26Zm-8.42 1.1v.88H38v-.88Zm3.6-3.36a1.915 1.915 0 0 1 1.865.94c.186.321.275.69.255 1.06a1.826 1.826 0 0 1-1.24 1.82l1.44 2.6h-1.19L44.4 5.4H43v2.45h-1V1.48Zm-7.52 1.57v4.8h-1v-4.8Zm-6.29-1.57v2.69h3.29V1.48h1v6.37h-1V5h-3.29v2.85h-1V1.48ZM49.36 3a2.118 2.118 0 0 1 2.16 2.42v.33H48.1a1.305 1.305 0 0 0 .608 1.224c.204.127.441.195.682.196a1.153 1.153 0 0 0 1.15-.6h.92A1.998 1.998 0 0 1 49.36 8a2.193 2.193 0 0 1-2.041-1.254 2.193 2.193 0 0 1-.189-1.236 2.214 2.214 0 0 1 1.024-2.173c.362-.225.78-.343 1.206-.337ZM54 3c1.09 0 1.8.51 1.89 1.34H55a.902.902 0 0 0-1-.6c-.53 0-.94.27-.94.65s.25.49.77.61l.8.19c.92.21 1.36.6 1.36 1.3 0 .89-.85 1.5-2 1.5s-1.9-.52-2-1.35h1a1.004 1.004 0 0 0 1 .6c.6 0 1-.27 1-.66s-.23-.5-.71-.61l-.84-.2c-.92-.21-1.35-.62-1.35-1.33 0-.71.8-1.44 1.91-1.44Zm-2 10.79a1.247 1.247 0 0 0-1.096.64 1.245 1.245 0 0 0-.154.64h2.44A1.18 1.18 0 0 0 52 13.79Zm-15.75 0c-.83 0-1.29.62-1.29 1.69 0 1.07.46 1.68 1.29 1.68.83 0 1.3-.62 1.3-1.68s-.44-1.66-1.27-1.66Zm12.79-2.6v6.69h-1v-6.66Zm-18.3.31v5.52h3v.86h-4v-6.35ZM45.39 13c1.08 0 1.8.51 1.89 1.34h-.92c-.09-.36-.43-.59-1-.59-.57 0-.94.26-.94.65s.24.48.77.6l.8.19c.92.21 1.35.6 1.35 1.3 0 .89-.85 1.5-2 1.5s-1.91-.52-2-1.35h1a1.003 1.003 0 0 0 1 .61c.59 0 1-.28 1-.67s-.23-.49-.71-.61l-.85-.2c-.92-.21-1.35-.62-1.35-1.33 0-.71.86-1.44 1.96-1.44ZM41 13c1.09 0 1.8.51 1.9 1.34H42c-.09-.36-.43-.59-1-.59-.57 0-.93.26-.93.65s.24.48.76.6l.81.19c.92.21 1.35.6 1.35 1.3 0 .89-.85 1.5-2 1.5s-1.91-.52-2-1.35H40a.995.995 0 0 0 1.06.61c.59 0 1-.28 1-.67s-.23-.49-.72-.61l-.84-.2c-.92-.21-1.35-.62-1.35-1.33 0-.71.78-1.44 1.85-1.44Zm15.63 0c1.09 0 1.8.51 1.9 1.34h-.92c-.09-.36-.44-.59-1-.59s-.94.26-.94.65.25.48.77.6l.81.19c.92.21 1.35.6 1.35 1.3 0 .89-.85 1.5-2 1.5s-1.9-.52-2-1.35h1a.995.995 0 0 0 1.06.61c.59 0 1-.28 1-.67s-.21-.48-.66-.58l-.84-.2c-.92-.21-1.35-.62-1.35-1.33 0-.71.75-1.47 1.84-1.47ZM61 13c1.09 0 1.8.51 1.9 1.34H62c-.09-.36-.43-.59-1-.59-.57 0-.93.26-.93.65s.24.48.76.6l.81.19c.92.21 1.35.6 1.35 1.3 0 .89-.85 1.5-2 1.5s-1.91-.52-2-1.35h1a.995.995 0 0 0 1.06.61c.59 0 1-.28 1-.67s-.23-.49-.72-.61l-.84-.2c-.92-.21-1.35-.62-1.35-1.33 0-.71.78-1.44 1.86-1.44Zm-24.72 0a2.23 2.23 0 0 1 2.29 2.5 2.294 2.294 0 0 1-1.549 2.32A2.29 2.29 0 0 1 34 15.5a2.217 2.217 0 0 1 2.28-2.5ZM52 13a2.118 2.118 0 0 1 2.16 2.42v.33h-3.38a1.29 1.29 0 0 0 1.28 1.42 1.158 1.158 0 0 0 1.16-.6h.92A2.002 2.002 0 0 1 52 18a2.194 2.194 0 0 1-2.046-1.246 2.185 2.185 0 0 1-.194-1.234A2.232 2.232 0 0 1 52 13Z" fill-rule="evenodd" />
</svg>
`,ry=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 20" height="32">
  <path d="M9.21 3.13c.131.166.249.344.35.53a7.554 7.554 0 0 0-.49.94c-.1-.2-.2-.4-.31-.59.134-.301.284-.595.45-.88ZM7.64 7.82c.08.25.17.51.25.77-.15.76-.25 1.46-.32 2a.204.204 0 0 1-.065.129.202.202 0 0 1-.135.051.21.21 0 0 1-.18-.23c.1-.75.25-1.72.45-2.72Zm-2-4.69c.135.166.255.343.36.53a19.651 19.651 0 0 0-2 7 .204.204 0 0 1-.065.129.202.202 0 0 1-.135.051.21.21 0 0 1-.18-.23c.29-2.12.8-5.43 2.01-7.48Zm13.23 4.92a.192.192 0 0 1 .159.118.187.187 0 0 1 .011.102C19 9.07 18.8 10 18.6 11l-.25-.77c.14-.76.25-1.46.32-2a.204.204 0 0 1 .065-.129.202.202 0 0 1 .135-.051Zm3.58 0a.206.206 0 0 1 .164.117c.014.032.02.068.016.103-.32 2.09-.83 5.4-2 7.45a5.451 5.451 0 0 1-.35-.53 19.87 19.87 0 0 0 2-7 .21.21 0 0 1 .064-.096.204.204 0 0 1 .106-.044Zm-5.28 6.21.3.59a7.082 7.082 0 0 1-.44.88 4.454 4.454 0 0 1-.35-.53c.179-.305.343-.618.49-.94Zm-8.64-13a2.895 2.895 0 0 1 1.75.62 4.1 4.1 0 0 1 .54.48c2.71 2.79 3.86 10.16 5.68 13.14.085.153.185.297.3.43a1.81 1.81 0 0 0 1.38.88c.19-.002.377-.043.55-.12.175.189.366.363.57.52a3 3 0 0 1-1.59.44A2.861 2.861 0 0 1 16 17a5.34 5.34 0 0 1-.55-.48c-2.7-2.8-3.85-10.16-5.67-13.14-.55-.9-1.26-1.58-2.23-1.19a4.765 4.765 0 0 0-.57-.53 3.003 3.003 0 0 1 1.55-.43Zm-4.06 0c6-.81 6.42 15.51 10.13 15.51.19-.002.377-.043.55-.12.173.192.363.366.57.52-.48.289-1.03.442-1.59.44C10.88 17.62 9.26 11.88 8 8c-.08-.26-.17-.51-.25-.76a19.99 19.99 0 0 0-1.6-3.87 4.491 4.491 0 0 0-.37-.53 1.53 1.53 0 0 0-2.36-.38C1.55 3.82.68 8.33.41 10.62a.211.211 0 0 1-.21.18.211.211 0 0 1-.2-.22C.41 8 1.08 3.57 3 1.92a2.878 2.878 0 0 1 1.47-.65Zm7.64 0c3.25 0 4.86 5.75 6.12 9.61.08.26.17.51.25.76a19.99 19.99 0 0 0 1.6 3.87c.111.18.231.353.36.52a1.743 1.743 0 0 0 1.32.79 1.817 1.817 0 0 0 1-.4c1.87-1.35 2.74-5.85 3-8.14a.195.195 0 0 1 .068-.122.196.196 0 0 1 .132-.048.206.206 0 0 1 .164.117c.014.032.02.068.016.103-.41 2.59-1.08 7-3 8.66a3 3 0 0 1-1.93.69c-5.43 0-6.07-15.54-9.65-15.54-.19.002-.377.043-.55.12a4.765 4.765 0 0 0-.57-.53 3 3 0 0 1 1.67-.49ZM52.68 8.17a1.313 1.313 0 0 0-1.3 1.34h2.53a1.233 1.233 0 0 0-1.23-1.34Zm-16.25 0c-.86 0-1.34.64-1.34 1.75 0 1.11.48 1.74 1.34 1.74.86 0 1.34-.64 1.34-1.74s-.49-1.71-1.34-1.71Zm13.19-2.65v6.93h-1V5.52Zm-18.88.31v5.72h3.1v.9h-4.13V5.83ZM62 7.37c1.12 0 1.86.52 1.95 1.39H63a.93.93 0 0 0-1-.62c-.55 0-1 .27-1 .68 0 .41.25.5.79.62l.83.2c.95.22 1.4.63 1.4 1.35 0 .93-.88 1.55-2.07 1.55s-2-.53-2-1.4h1c.082.212.233.39.429.505.197.114.426.158.651.125.62 0 1-.28 1-.69 0-.41-.23-.51-.73-.63l-.87-.21C60.45 10 60 9.6 60 8.86c0-.74.82-1.49 2-1.49Zm-4.5 0c1.12 0 1.86.52 1.95 1.39h-.94a.938.938 0 0 0-1-.62c-.55 0-1 .27-1 .68 0 .41.25.5.79.62l.83.2c.95.22 1.4.63 1.4 1.35 0 .93-.88 1.55-2.07 1.55s-2-.53-2-1.4h1c.082.212.233.39.429.505.197.114.426.158.651.125.62 0 1-.28 1-.69 0-.41-.23-.51-.73-.63l-.87-.21C56 10 55.51 9.6 55.51 8.86c0-.74.81-1.49 1.94-1.49Zm-4.77 0c1.39 0 2.23 1 2.23 2.51v.34h-3.58a1.34 1.34 0 0 0 1.33 1.47 1.178 1.178 0 0 0 1.19-.63h1a2.003 2.003 0 0 1-2.16 1.43A2.26 2.26 0 0 1 50.38 10a2.3 2.3 0 0 1 2.3-2.63Zm-6.86 0c1.12 0 1.86.52 2 1.39h-.94a.93.93 0 0 0-1-.62c-.55 0-1 .27-1 .68 0 .41.26.5.8.62l.83.2c1 .22 1.39.63 1.39 1.35 0 .93-.88 1.55-2.07 1.55s-2-.53-2-1.4h1c.12.39.49.63 1.09.63.6 0 1.05-.28 1.05-.69 0-.41-.24-.51-.74-.63l-.87-.21c-1-.22-1.39-.64-1.39-1.38 0-.74.67-1.49 1.8-1.49Zm-9.39 0a2.292 2.292 0 0 1 2.3 2.63 2.357 2.357 0 0 1-1.597 2.388 2.356 2.356 0 0 1-2.72-.923A2.357 2.357 0 0 1 34.07 10a2.295 2.295 0 0 1 1.076-2.299c.386-.235.833-.35 1.284-.331Zm4.89 0c1.12 0 1.86.52 2 1.39h-.94a.93.93 0 0 0-1-.62c-.55 0-1 .27-1 .68 0 .41.25.5.8.62l.83.2c1 .22 1.39.63 1.39 1.35 0 .93-.88 1.55-2.07 1.55s-2-.53-2-1.4h1c.082.212.233.39.429.505.197.114.426.158.651.125.62 0 1-.28 1-.69 0-.41-.23-.51-.73-.63l-.87-.21c-1-.22-1.39-.64-1.39-1.38 0-.74.72-1.49 1.85-1.49Z" fill-rule="evenodd" />
</svg>
`,iy=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1869 900" height="38">
  <path d="M508.4 55.6c13.5 13.9 1 29.8-29.9 38.1-9.3 2.5-11.4 2.7-31.5 2.7-22.9.1-31.2-1.1-45.2-6.4-20.6-7.7-28.6-22.4-18.4-33.9l2.1-2.4-3.4 1.9c-7.8 4.3-14.1 12.8-14.1 18.9 0 13.3 21 26.1 50.7 30.9 38.1 6.1 80.1-.7 99-16 4.7-3.8 8.3-10.5 8.3-15.3 0-7-6.7-14.9-16.9-20.1l-4.4-2.2 3.7 3.8z" />
  <path d="M353.3 79.9c-20.1 9.6-31.3 22.3-31.3 35.8 0 23.7 33.9 43.1 89.5 51.5 11.9 1.7 61.9 1.7 73 0 26.8-4.3 47-10.1 61.2-17.7 19.7-10.4 28.6-21.1 28.5-34.1-.1-9.5-4.4-16.7-15.4-25.7-4.8-3.9-13.3-8.8-19.3-11.2l-4-1.6 3 2.3c11.8 9 17 16.9 16.9 26.3 0 7.9-2.3 12.5-9.9 20-13 13-39.9 22.9-71.4 26.5-12.1 1.4-40.1 1.4-52.2 0-31.5-3.6-58.3-13.5-71.4-26.5-7.6-7.5-9.9-12.1-9.9-20-.1-9.4 5.3-17.7 16.9-26.2 4-3 3.2-2.9-4.2.6zM1053.5 181c-29.2 3.1-51.5 19.4-57.5 41.9-1.8 6.9-1.4 21.6.8 28.8 6.7 21.5 23.1 31.9 64.3 40.8 26.1 5.7 33.8 8.6 41.7 15.8 6.2 5.8 8.2 10.4 8.2 19.7 0 21-16.9 33.3-46 33.3-27.5-.1-44.9-10.2-49.9-29.1l-1.2-4.2H990v3.2c0 1.8.7 5.8 1.5 8.8 5.3 20.1 21.3 34.6 45.6 41.2 7.3 2 10.8 2.3 26.4 2.3 21.3 0 28-1.3 42.5-8.2 20.5-9.8 30.3-25.9 30.2-49.3-.1-15.7-4.5-26.5-14.8-35.9-10.2-9.4-23.1-14.2-60.3-22.6-23.2-5.2-33.6-10.8-38.5-20.7-2.9-5.8-3.5-14.8-1.5-20.9 1.8-5.1 6.3-10.8 11.6-14.6 13.3-9.4 39.5-10.8 55.8-2.9 9.5 4.7 17.6 15.1 19.1 24.5l.7 4.1h12.3c14.3 0 13.6.7 10.9-10.9-4.7-19.8-21.6-36.3-43.5-42.5-5.4-1.5-21.5-3.7-25.5-3.5-1.1.1-5.1.5-9 .9zM1740 282.5V381h23V184h-23v98.5zM1547.1 186.7c-10.7 5.6-10.6 21 .2 26.2 2.4 1.2 5.3 2.1 6.5 2.1 6.4 0 13.6-6.2 14.8-12.6.9-4.8-1.9-11.8-5.8-14.5-4.2-3-11.3-3.5-15.7-1.2zM1463 219.5V239h-21v18.9l10.3.3 10.2.3.5 50c.5 48 .6 50.2 2.6 55.1 3.3 8 6.9 12.1 13.8 15.4 7.6 3.7 17.8 5.4 27.4 4.5l7.2-.7v-18.5l-8.5-.5c-9.5-.5-12.5-2-16-7.9-1.9-3.3-2-5.2-2-50.4v-47l13.3-.3 13.2-.3V239h-27v-39h-24v19.5zM766.7 226.5c-23.5 6.1-34.1 50.8-25.2 106.5 5.9 36.8 20 75.1 37.6 102 7 10.7 22.8 27.1 30.1 31.3 9.9 5.7 19.9 6.7 27.8 2.7 10.6-5.4 19.8-23 22.4-43l.6-4.5-2 5.3c-5.7 15.6-14.7 23.5-26.6 23.6-23.2 0-51.2-35.7-65.8-83.7-7-23.3-9.8-41.6-9.9-64.2 0-25.6 5.1-44 15-53.9 5.7-5.7 8.8-7 16.8-7.1 8.1 0 14.6 2.8 23 9.8 5.8 4.9 5.2 3.5-2.4-5.2-13.7-15.7-28.9-22.9-41.4-19.6zM109.2 229.5c-7.2 3.6-18.5 13.3-24.4 20.8-1.8 2.3-2.6 3.7-1.8 3.1.8-.6 3.6-2.7 6.2-4.7 8.9-6.7 18.5-9 27.3-6.6 5.3 1.4 13.5 9.9 17 17.5 8.5 18.6 9.9 51.9 3.5 83.4-9.4 46.1-31.2 86.5-54.8 101.8-17.8 11.5-33.7 5.7-42.8-15.6l-2.5-5.7.7 4.5c2.4 17.8 10.5 34.1 19.7 39.5 13.4 7.8 27.3 3.7 44.3-13.1C133.2 423 158 353.3 158 295.8c0-29.5-5.7-51-16.4-61.8-6.1-6.2-10.3-8-18.4-8-5.9 0-8 .5-14 3.5zM1222 236.7c-13.5 2.3-27.5 11.4-33.8 22.3l-2.7 4.5-.3-12.3-.3-12.2H1161v190h24v-72.2l4.4 5.9c10.3 14 23.9 20.7 42.1 20.7 27.7 0 48.4-17.1 56.7-47 1.9-6.8 2.2-10.5 2.2-26.4.1-16.4-.2-19.4-2.2-26.5-7.3-25.4-22.9-41.4-44.7-46-6.6-1.4-16-1.7-21.5-.8zm14.5 21.8c17.9 4.6 29 21.7 30.2 47 1.5 31.2-11.4 52.7-34 56.5-20.8 3.6-38.9-9.8-45.3-33.3-.8-2.9-1.7-9.5-2-14.7-2.2-37.6 21.3-63.1 51.1-55.5zM1360.5 236.6c-23.5 3.8-39.1 16.2-44 34.9-2.3 9-2.9 8.5 10 8.5h11.4l1.3-4.3c.8-2.7 3-6 6.3-9.3 6.6-6.6 12.7-8.8 25-8.9 11.5 0 17.9 2.1 23.9 8 5.5 5.3 7.6 11.6 7.6 23.2 0 7.9-.1 8.3-2.2 8.3-11 .1-48.9 3.2-54.1 4.4-15.4 3.6-26.8 11.4-32.3 22.3-2.7 5.4-2.9 6.6-2.9 17.3 0 10.8.2 11.9 3.1 18 3.9 8.2 7.5 12.4 14 16.6 8.5 5.5 16.5 7.7 27.9 7.8 17.7.2 32-6.4 41.8-19.3l4.7-6.2V381h24v-50.8c0-32.5-.4-53-1.1-56.8-4.1-22.5-22.7-36.1-50.4-36.9-6-.2-12.3-.1-14 .1zm41.3 88.7c-.3 9.2-.7 11-3.6 17-6.8 13.8-21.5 21.6-38.7 20.5-14.2-.9-23.8-8.4-25.1-19.4-.8-6.3.8-11.4 4.9-16 6.3-7.3 13-9 41.2-10.8 11-.7 20.4-1.4 20.9-1.5.4 0 .7 4.5.4 10.2zM1642.5 236.6c-23.5 3.8-39.1 16.2-44 34.9-2.3 9-2.9 8.5 10 8.5h11.4l1.3-4.3c.8-2.7 3-6 6.3-9.3 6.6-6.6 12.7-8.8 25-8.9 11.5 0 17.9 2.1 23.9 8 5.5 5.3 7.6 11.6 7.6 23.2 0 7.9-.1 8.3-2.2 8.3-11 .1-48.9 3.2-54.1 4.4-15.4 3.6-26.8 11.4-32.3 22.3-2.7 5.4-2.9 6.6-2.9 17.3 0 10.8.2 11.9 3.1 18 3.9 8.2 7.5 12.4 14 16.6 8.5 5.5 16.5 7.7 27.9 7.8 17.7.2 32-6.4 41.8-19.3l4.7-6.2V381h24v-50.8c0-32.5-.4-53-1.1-56.8-4.1-22.5-22.7-36.1-50.4-36.9-6-.2-12.3-.1-14 .1zm41.3 88.7c-.3 9.2-.7 11-3.6 17-6.8 13.8-21.5 21.6-38.7 20.5-14.2-.9-23.8-8.4-25.1-19.4-.8-6.3.8-11.4 4.9-16 6.3-7.3 13-9 41.2-10.8 11-.7 20.4-1.4 20.9-1.5.4 0 .7 4.5.4 10.2zM1542 310v71h24V239h-24v71z" />
  <path d="M65.5 263.9c-3.8 1.7-15 10.9-14.2 11.7.2.2 2.1-.5 4.2-1.6 12.6-6.4 23.5 2.7 27 22.6 1.8 10.2 1.8 15.8 0 29.7-3.6 27.5-14.5 52.8-28.9 67.3-11.8 11.8-21.3 13.2-29 4.2l-3.5-4.1.9 3.2c8.7 30.5 35.2 22.1 54.8-17.5 15-30.1 21.6-68.7 16.1-94.4-4-18.9-14.4-26.9-27.4-21.1zM816.2 263.7c-4.4 2.1-8.8 8.5-11.4 16.3-1.7 5.2-2.2 9.7-2.6 22.6-.3 14.2-.1 17.8 2.2 30 5.1 27.8 15.3 51.9 28.9 68.5 15.5 18.7 31.4 19.1 39.4 1.1 3.1-7.1 2.9-8-1-3.9-17.2 18.3-45.7-13.8-56.3-63.3-2.8-13-2.6-36.2.3-45.5 3.5-11 10.2-17.5 18.1-17.5 1.6 0 4.9 1.1 7.5 2.3 4.1 2.1 4.4 2.2 3.3.5-2.3-3.3-9.3-8.8-13.8-10.8-5.2-2.4-10.2-2.5-14.6-.3zM430 290.1c-80.7 10-144.1 73-153.6 152.9-1.8 15.1-1.7 26.3.1 40.7 10.3 79.2 72.3 141.5 151.2 151.8 85.1 11.2 168.7-45.9 189.9-129.5 20.2-80-17.5-161.3-92.1-198.5-16.1-8-31.2-13.1-47.5-16-11.3-1.9-37.5-2.8-48-1.4zm29.6 76c13.9 2.5 29 13.2 37.4 26.4 14.4 22.9 13.1 55.4-3.2 77-6.5 8.5-17.1 16.4-26.5 19.7-9.7 3.3-25.9 3.3-35.5 0-23.3-8-39-30.1-40.5-57.3-1.7-29.7 16-56.6 42.7-64.7 7.6-2.3 16.7-2.7 25.6-1.1zm9.4 156.4c17.5 2.3 34.3 7.1 46.5 13.2 13.5 6.8 29 19 34 26.7l1.9 2.9-5.9 5.4c-19.1 17-42.5 28.8-68.8 34.5-14.7 3.2-43.7 3.2-58.3 0-27-5.8-51-17.8-68.5-33.9-3.2-3-5.9-6.3-5.9-7.3 0-2.2 12.8-14.4 21-20 26.7-18.1 67.1-26.5 104-21.5zM1115.6 520.8c-.6 1-71.7 192-72.4 194.5-.4 1.6.5 1.7 12.4 1.5l12.8-.3 8.3-23.5c4.6-12.9 9-25.4 9.9-27.8l1.6-4.2h79.6l4.2 11.7c2.3 6.5 6.7 19.1 9.8 28l5.7 16.3h12.8c7 0 12.7-.3 12.7-.8 0-.4-16.4-44.6-36.3-98.2l-36.2-97.5-12.2-.3c-6.7-.1-12.4.1-12.7.6zm28.4 72.8c8.5 24 15.6 44.3 15.8 45 .3 1.2-5.2 1.4-31.8 1.4-26.2 0-32.1-.2-31.8-1.3 1-4.1 31.3-88.7 31.8-88.7.3 0 7.5 19.6 16 43.6zM1475 559c0 21.4-.3 39-.7 39-.5 0-1.9-1.9-3.3-4.1-3.4-5.6-11.2-12.5-18.2-16-27.8-14-61.4-2.2-75.3 26.4-5.3 11.1-7.4 18.8-8.4 31.6-2.5 29.2 5.1 53.7 21.6 69.2 23.3 22.1 62.4 18.8 79.9-6.7l3.9-5.7.3 12.2.3 12.1h22.9V520h-23v39zm-25.4 38c16 7.9 24.8 25.2 24.8 49 0 18.8-4.4 31.2-14.8 41.6-8.1 8-14.7 10.7-26.7 10.7-7.5 0-9.4-.4-15.2-3.1-17.3-8-25.6-26.4-24.4-53.6.6-14.6 2.9-22.8 9-31.8 10.4-15.6 30.6-21 47.3-12.8zM1537.1 522.7c-10.7 5.6-10.6 21 .2 26.2 2.4 1.2 5.3 2.1 6.5 2.1 6.4 0 13.6-6.2 14.8-12.6.9-4.8-1.9-11.8-5.8-14.5-4.2-3-11.3-3.5-15.7-1.2zM1632.5 573.5c-3.8.8-10.7 3.3-15.4 5.5-25 12-38.1 40.8-35 76.9 2.8 32 20.3 54.5 47.9 61.8 8.6 2.3 26.2 2.3 34.9 0 11.7-3.1 18.9-7.3 27.6-16.1 9.2-9.2 13.1-15.9 17.1-29.1 2.5-8.3 2.8-10.4 2.8-26 .1-19.9-1.1-25.8-8-40.2-7.6-15.9-21.2-27.2-38.4-31.9-8.1-2.2-25.1-2.6-33.5-.9zm24.6 20.9c14.4 3.3 24.8 14.5 29.5 31.7 2.4 8.9 2.5 30 .1 38.9-4.1 15.2-13 26.7-24.2 31-8.4 3.3-21.5 3.3-30 0-7.5-2.9-17-12-20.7-20-5.5-11.7-7.4-32.3-4.3-47.1 5.5-26.3 25.6-40.2 49.6-34.5zM1227 625.8c0 47.1.1 51.4 1.9 58.5 2.6 10 5.3 15 11.7 21.8 20.1 21 61.5 17.3 77.8-7.1 1.5-2.4 1.6-2.1 1.6 7.8V717h24V575h-23.9l-.3 47.7c-.3 47.3-.3 47.9-2.6 53.5-6.5 16-23.2 24.8-41.1 21.8-8.3-1.4-14.7-5.1-19.1-11.1-5.9-8.2-6-9.4-6-63.1V575h-24v50.8zM1532 646v71h24V575h-24v71zM725 667.1c-46.8 7.1-115.5 65.6-143.5 122.4-8.4 17-11.6 28-11.7 40.5-.1 14.9 3.8 22.7 14 27.7 5.2 2.6 6.6 2.8 16.7 2.7 9.5-.1 12.3-.5 20.8-3.3 5.3-1.8 9.7-3.3 9.7-3.5 0-.1-4.1 0-9 .2-15.2.7-24-3.3-28.5-13.1-5.8-12.4-3.5-28.7 7.2-50.5 21.1-43.3 70.8-88 110.8-99.7 13.1-3.8 24.5-3.8 32.3.1 10.4 5.3 14.2 14.3 12.9 30.8-.7 8.5.2 7.4 3.9-5 3.6-12 4-27.6.8-34.4-5.8-12.3-18.6-17.6-36.4-14.9zM153 667.9c-18.5 6.1-23.5 24.3-14.4 52.3 1.4 4.3 2.7 7.8 2.9 7.8.1 0 0-4-.3-9-.8-15 3-23.4 12.9-28.4 4.6-2.2 6.6-2.6 14.5-2.6 22.6 0 51.7 14.7 79.9 40.3 28.2 25.7 48.7 54.9 55.9 79.9 3.6 12.5 4.1 19.1 2.2 26.9-2.1 8-5.6 12.6-12.7 16.2-5.2 2.7-5.9 2.8-16.7 2.5l-11.3-.4 6.1 2.3c15.2 5.7 31.8 6.7 41.3 2.5 5.9-2.6 10.9-8 13.1-14.2 2.9-7.9 1.9-23.6-2.2-36.1-8.2-24.8-26.6-52.8-52.1-79.2-26.3-27.2-59.4-49.6-86.1-58.2-6.6-2.2-10.9-2.8-19.5-3.1-6-.2-12.1 0-13.5.5z" />
  <path d="M732.8 732.2c-10.8 1.4-26.2 8.9-41.4 20.1-9.6 7.1-29.8 27.6-36.6 37.3-20.2 28.4-24.5 52.8-10.8 60.8 4.3 2.5 16.3 2.7 22.5.3l4-1.6h-3.9c-6.3-.1-12.1-3.5-14.5-8.5-12.5-25.6 35.7-85 77.2-95.2 5.7-1.4 7.6-1.5 12.2-.5 6.8 1.5 11.2 5.6 12.1 11.2.4 2.1 1 3.9 1.5 3.9 1.2 0 2.2-8.7 1.5-13.7-1.5-11.3-9.5-16-23.8-14.1zM148.9 734.1c-2 1.2-4.4 3.5-5.4 5.1-2.1 3.6-3 12.9-1.7 18.3l.9 4 .7-3c3.4-14.8 15.6-18 36-9.5 27 11.2 57.3 43.1 66 69.2 6.1 18.3.4 30.6-14.5 30.9l-4.4.1 4.5 1.5c7.1 2.3 18.8 2.2 23-.2 14.1-8.2 8.7-34.5-12.9-63.5-7.6-10.2-24.7-27.2-35.4-35.2-22.5-16.7-45.9-24-56.8-17.7z" />
</svg>
`,dats=`<svg id="vector" xmlns="http://www.w3.org/2000/svg" height="32" viewBox="0 0 49.0 20.0"><path d="M47.2193,16.4742L48.1796,16.4742L48.1796,15.9269L47.2193,15.9269L47.2193,16.4742ZM45.9188,16.3814L45.9188,15.9269L46.8137,15.9269L46.8137,16.4742L45.9188,16.4742L45.9188,16.3814ZM48.6038,14.5168C48.767,14.5168 48.8928,14.5168 49,14.5261L49,14.118C48.8928,14.1273 48.767,14.1273 48.6038,14.1273L47.2146,14.1273L47.2146,13.9046C47.2146,13.8768 47.2193,13.8211 47.224,13.7887C47.1307,13.7794 46.865,13.77 46.7624,13.77C46.7672,13.8072 46.7717,13.8768 46.7717,13.8999L46.7717,14.1273L45.4152,14.1273C45.252,14.1273 45.1263,14.1273 45.0142,14.118L45.0142,14.5261C45.1263,14.5168 45.252,14.5168 45.4152,14.5168L46.7717,14.5168L46.7717,14.8646L45.6903,14.8646C45.5458,14.8646 45.4385,14.8646 45.336,14.8554L45.336,15.2357C45.4385,15.2265 45.5458,15.2265 45.6903,15.2265L48.4313,15.2265C48.5712,15.2265 48.6785,15.2265 48.781,15.2357L48.781,14.8554C48.6785,14.8646 48.5712,14.8646 48.4313,14.8646L47.2146,14.8646L47.2146,14.5168L48.6038,14.5168ZM48.6084,15.5651L45.4897,15.5651L45.4944,15.6949L45.4944,16.3628C45.4944,17.0261 45.2053,17.4203 44.7952,17.6754C44.893,17.7589 45.0516,17.9073 45.1355,18C45.4944,17.7728 45.7696,17.3554 45.8721,16.836L48.1796,16.836L48.1796,17.0679L48.6084,17.0679L48.6038,16.9148L48.6038,15.7135C48.6038,15.6624 48.6038,15.6114 48.6084,15.5651L48.6084,15.5651ZM42.493,17.2488C42.8614,17.3879 43.3228,17.5781 43.7051,17.7822L43.8962,17.4296C43.5698,17.272 43.0478,17.068 42.7262,16.9705L42.493,17.2488ZM40.9873,16.595L42.7682,16.595L42.7682,16.2656L40.9873,16.2656L40.9873,16.595ZM40.8102,14.7858L42.9546,14.7858L42.9546,14.5818L40.8102,14.5818L40.8102,14.7858ZM40.8102,14.336L42.9546,14.336L42.9546,14.1412L40.8102,14.1412L40.8102,14.336ZM42.0829,16.8962L43.197,16.8962C43.1924,16.8545 43.1924,16.8129 43.1924,16.7757L43.1924,16.0846C43.1924,16.0381 43.1924,16.0056 43.197,15.964L40.5538,15.964C40.5584,16.001 40.5631,16.0381 40.5631,16.0846L40.5631,16.7757C40.5631,16.8175 40.5584,16.8638 40.5538,16.8962L41.6773,16.8962L41.6773,17.1653L41.6773,17.3832C41.6773,17.4714 41.6166,17.5224 41.4023,17.5224C41.2392,17.5224 41.0666,17.4992 41.0479,17.4946C41.1085,17.6106 41.2065,17.8101 41.2437,17.9028C41.8778,17.9028 42.0922,17.7543 42.0922,17.4854C42.0922,17.439 42.0829,17.2303 42.0829,17.1653L42.0829,16.8962ZM43.5373,15.3516L42.0829,15.3516C42.0409,15.2496 41.999,15.1568 41.9477,15.0594L43.3788,15.0594C43.3741,15.0178 43.3741,14.9761 43.3741,14.9297L43.3741,14.0019C43.3741,13.951 43.3741,13.9091 43.3788,13.8674L40.3814,13.8674C40.3861,13.9046 40.3906,13.951 40.3906,14.0019L40.3906,14.9297C40.3906,14.9761 40.3861,15.0225 40.3814,15.0594L41.6074,15.0594L41.4909,15.0781C41.5421,15.1614 41.584,15.2543 41.6307,15.3516L40.2369,15.3516C40.0783,15.3516 39.9571,15.3516 39.8454,15.3424L39.8454,15.7182C39.9571,15.7087 40.0783,15.7087 40.2369,15.7087L43.5373,15.7087C43.6958,15.7087 43.817,15.7087 43.9289,15.7182L43.9289,15.3424C43.817,15.3516 43.6958,15.3516 43.5373,15.3516L43.5373,15.3516ZM41.2624,17.1607C41.1505,17.1004 41.034,17.0308 40.9221,16.9705C40.6984,17.1885 40.1436,17.4018 39.7801,17.476C39.8593,17.5781 39.9806,17.7311 40.0271,17.8006C40.4232,17.6941 40.9408,17.4482 41.2298,17.1885C41.2345,17.1839 41.2484,17.17 41.2624,17.1607L41.2624,17.1607ZM35.5714,15.4514C36.0189,15.136 36.4385,14.7372 36.7554,14.3059C37.0584,14.7325 37.4687,15.136 37.9255,15.4514C37.8649,15.4561 37.7996,15.4561 37.725,15.4561L35.8091,15.4561C35.7205,15.4561 35.646,15.4561 35.5714,15.4514L35.5714,15.4514ZM36.9606,17.5387L36.9606,16.8522L37.9535,16.8522C38.0793,16.8522 38.1819,16.8522 38.2752,16.8614L38.2752,16.4486C38.1819,16.458 38.0793,16.458 37.9535,16.458L36.9606,16.458L36.9606,15.8504L37.725,15.8504C37.837,15.8504 37.9255,15.8504 38.0141,15.8596L38.0141,15.5117C38.2426,15.6601 38.4755,15.7901 38.7133,15.8874C38.7507,15.7947 38.8811,15.6138 38.965,15.4978C38.2332,15.2287 37.366,14.5749 36.9886,13.944C36.9979,13.9348 37.0165,13.9163 37.0257,13.9024C36.8766,13.8745 36.7042,13.842 36.555,13.8096C36.1773,14.5053 35.2823,15.187 34.5459,15.4838C34.6297,15.5953 34.7602,15.7807 34.8116,15.8874C35.0493,15.7807 35.2918,15.6462 35.5247,15.4838L35.5247,15.8596C35.6133,15.8504 35.7019,15.8504 35.8091,15.8504L36.5131,15.8504L36.5131,16.458L35.5947,16.458C35.4688,16.458 35.3663,16.458 35.273,16.4486L35.273,16.8614C35.3663,16.8522 35.4688,16.8522 35.5947,16.8522L36.5131,16.8522L36.5131,17.5387L35.1565,17.5387C34.9934,17.5387 34.8628,17.5387 34.751,17.5293L34.751,17.9606C34.8628,17.9514 34.9934,17.9514 35.1565,17.9514L38.3963,17.9514C38.5641,17.9514 38.6901,17.9514 38.8019,17.9606L38.8019,17.5293C38.6901,17.5387 38.5641,17.5387 38.3963,17.5387L36.9606,17.5387ZM33.3254,16.5065C33.3207,16.9936 33.2834,17.1652 33.2087,17.2627C33.1202,17.3554 32.9991,17.3878 32.7753,17.3878C32.5562,17.3878 32.4862,17.3878 32.4303,17.3739C32.337,17.3507 32.2764,17.2904 32.2764,17.1465L32.2764,15.8711C32.7706,15.6207 33.3067,15.2821 33.6237,15.0038C33.6422,14.9899 33.661,14.9806 33.6843,14.9714L33.3534,14.6235C33.0409,14.9297 32.6913,15.1801 32.2764,15.4119L32.2764,13.9834C32.2764,13.9417 32.2811,13.8999 32.2857,13.8721C32.16,13.8674 31.9595,13.8535 31.8382,13.8443C31.8428,13.8768 31.8477,13.9278 31.8477,13.9694L31.8428,17.1327C31.8428,17.4574 31.9082,17.6197 32.0387,17.7033C32.1319,17.782 32.3137,17.8145 32.7426,17.8145C33.5631,17.8145 33.7215,17.5501 33.7589,16.7849C33.6517,16.7199 33.4512,16.5854 33.3254,16.5065L33.3254,16.5065ZM30.5422,17.2996L30.5422,15.6346L31.3394,15.6346C31.4047,15.6346 31.4653,15.6346 31.5306,15.6392L31.5306,15.2311C31.4653,15.2357 31.4047,15.2357 31.3394,15.2357L30.5422,15.2357L30.5422,14.0576C30.5422,14.0066 30.547,13.9325 30.5517,13.8814C30.4584,13.8721 30.188,13.8629 30.0901,13.8629C30.0947,13.9091 30.0995,14.0066 30.0995,14.0576L30.0995,17.244C30.0995,17.3136 30.0854,17.4295 29.9223,17.4991L30.1274,17.9258C30.2113,17.8794 30.2905,17.833 30.3559,17.81C30.6868,17.6846 31.3674,17.4156 31.5865,17.3183C31.5819,17.2347 31.5865,17.0028 31.596,16.8637C31.428,16.9425 30.9292,17.1465 30.5422,17.2996L30.5422,17.2996ZM28.3101,17.3716L27.5176,17.3716L27.5176,15.6137L28.1749,15.6137C28.2774,15.6137 28.3615,15.6137 28.4406,15.6183L28.4406,15.2194C28.3615,15.2241 28.2774,15.2241 28.1749,15.2241L27.5176,15.2241L27.5176,14.0043C27.5176,13.9533 27.5223,13.8744 27.527,13.8233C27.4384,13.8141 27.1726,13.8049 27.0795,13.8049C27.084,13.8559 27.0887,13.9533 27.0887,13.9997L27.0887,15.2241L26.5294,15.2241C26.4314,15.2241 26.3475,15.2241 26.2683,15.2194L26.2683,15.6183C26.3475,15.6137 26.4314,15.6137 26.5294,15.6137L27.0887,15.6137L27.0887,17.3716L26.2496,17.3716C26.1378,17.3716 26.0398,17.3716 25.9512,17.3624L25.9512,17.7751C26.0445,17.7659 26.1378,17.7659 26.2496,17.7659L28.3101,17.7659C28.4266,17.7659 28.5199,17.7659 28.6085,17.7751L28.6085,17.3624C28.5199,17.3716 28.4266,17.3716 28.3101,17.3716L28.3101,17.3716ZM25.597,15.79C25.7275,15.9895 25.8582,16.2306 25.9747,16.4441C26.0772,16.3234 26.1705,16.1982 26.2543,16.0683C26.1099,15.8549 25.8394,15.5117 25.6995,15.3401C25.6624,15.3725 25.625,15.3958 25.597,15.4189L25.597,15.1359L25.9327,15.1359C26.0213,15.1359 26.0865,15.1359 26.1611,15.1407L26.1611,14.7417C26.0865,14.7464 26.0213,14.7464 25.9327,14.7464L25.597,14.7464L25.597,13.93C25.597,13.9023 25.6017,13.8465 25.6064,13.8141C25.5178,13.8049 25.2615,13.7955 25.1635,13.7955C25.1682,13.8327 25.1729,13.9023 25.1729,13.93L25.1729,14.7464L24.6648,14.7464C24.5854,14.7464 24.5108,14.7464 24.4363,14.7417L24.4363,15.1407C24.5108,15.1359 24.5854,15.1359 24.6648,15.1359L25.1123,15.1359C24.9397,15.7483 24.5994,16.3652 24.343,16.6528C24.4316,16.7965 24.5061,16.945 24.5574,17.1026C24.7905,16.8012 25.0237,16.3049 25.2008,15.7296C25.1868,16.4718 25.1729,17.5247 25.1729,17.7427C25.1729,17.8215 25.1682,17.905 25.1635,17.9746L25.6064,17.9746C25.6017,17.905 25.597,17.8215 25.597,17.7427L25.597,15.79ZM21.6112,14.3118C21.4919,14.1785 21.3341,14.0719 21.1385,13.9926C20.943,13.9134 20.7329,13.8737 20.5082,13.8737C20.3488,13.8737 20.1904,13.8944 20.0328,13.9358C19.8751,13.9774 19.7337,14.0432 19.6089,14.1332C19.4839,14.2234 19.3823,14.337 19.3045,14.4738C19.2266,14.6109 19.1877,14.7749 19.1877,14.966C19.1877,15.1425 19.2165,15.2904 19.2747,15.4092C19.3326,15.5283 19.4086,15.6283 19.5029,15.7093C19.5971,15.7904 19.7041,15.857 19.8236,15.9093C19.9429,15.9616 20.0644,16.0058 20.1874,16.0419C20.3106,16.0817 20.4275,16.1204 20.538,16.1582C20.6484,16.196 20.7456,16.2419 20.8288,16.296C20.912,16.35 20.9781,16.4159 21.0271,16.4933C21.0762,16.5709 21.1005,16.6673 21.1005,16.7825C21.1005,16.8979 21.0768,16.9963 21.03,17.0773C20.9828,17.1583 20.9221,17.226 20.8478,17.28C20.7734,17.3341 20.6912,17.3738 20.6006,17.3989C20.5098,17.4241 20.4194,17.4368 20.3289,17.4368C20.1514,17.4368 19.9865,17.3954 19.8344,17.3124C19.6822,17.2295 19.5607,17.1215 19.4703,16.9879L19.052,17.3395C19.2003,17.5233 19.3876,17.6622 19.6142,17.7557C19.8407,17.8494 20.0751,17.8964 20.3181,17.8964C20.4884,17.8964 20.6538,17.8728 20.8151,17.826C20.9765,17.7793 21.1185,17.7082 21.2416,17.6126C21.365,17.517 21.4637,17.3964 21.538,17.2502C21.6121,17.1043 21.6494,16.9321 21.6494,16.7339C21.6494,16.5429 21.6149,16.3852 21.5459,16.2608C21.4773,16.1366 21.3884,16.033 21.2799,15.95C21.1711,15.867 21.0495,15.8004 20.9158,15.7499C20.7815,15.6994 20.6494,15.6543 20.5191,15.6148C20.4105,15.5787 20.308,15.5436 20.2121,15.5092C20.116,15.4751 20.0328,15.4336 19.9622,15.385C19.8913,15.3363 19.8354,15.2768 19.7936,15.2065C19.7517,15.1363 19.7313,15.0489 19.7313,14.9443C19.7313,14.8361 19.7537,14.7434 19.799,14.6657C19.8442,14.5884 19.903,14.5236 19.9754,14.471C20.048,14.4191 20.1287,14.3812 20.2175,14.3577C20.3061,14.3341 20.3941,14.3225 20.4811,14.3225C20.644,14.3225 20.7908,14.3559 20.9211,14.4225C21.0515,14.4892 21.1549,14.5749 21.2309,14.6794L21.6112,14.3118ZM17.5654,15.8796C17.5654,15.6706 17.5309,15.4731 17.4623,15.2874C17.3933,15.1018 17.2955,14.9386 17.1686,14.7981C17.0417,14.6574 16.8889,14.5465 16.7094,14.4655C16.53,14.3844 16.3277,14.3437 16.1034,14.3437C15.8822,14.3437 15.6818,14.3844 15.5028,14.4655C15.3234,14.5465 15.1711,14.6574 15.0461,14.7981C14.9211,14.9386 14.824,15.1018 14.7553,15.2874C14.6863,15.4731 14.6521,15.6706 14.6521,15.8796C14.6521,16.0925 14.6863,16.2926 14.7553,16.4799C14.824,16.6674 14.9221,16.8307 15.0487,16.9694C15.1755,17.1082 15.3278,17.2174 15.5052,17.2966C15.6828,17.3759 15.8822,17.4155 16.1034,17.4155C16.3243,17.4155 16.5252,17.3759 16.7065,17.2966C16.8879,17.2174 17.0417,17.1082 17.1686,16.9694C17.2955,16.8307 17.3933,16.6674 17.4623,16.4799C17.5309,16.2926 17.5654,16.0925 17.5654,15.8796L17.5654,15.8796ZM18.1471,15.8796C18.1471,16.1752 18.0954,16.4467 17.992,16.6935C17.8888,16.9407 17.7464,17.1533 17.5654,17.3318C17.3841,17.5102 17.1686,17.649 16.9185,17.7482C16.6687,17.8472 16.3967,17.8969 16.1034,17.8969C15.8098,17.8969 15.5388,17.8472 15.2908,17.7482C15.0423,17.649 14.8278,17.5102 14.6465,17.3318C14.4655,17.1533 14.3241,16.9407 14.2227,16.6935C14.1212,16.4467 14.0705,16.1752 14.0705,15.8796C14.0705,15.5804 14.1212,15.3074 14.2227,15.0603C14.3241,14.8133 14.4655,14.6026 14.6465,14.4276C14.8278,14.2527 15.0423,14.1166 15.2908,14.0194C15.5388,13.922 15.8098,13.8732 16.1034,13.8732C16.3967,13.8732 16.6687,13.922 16.9185,14.0194C17.1686,14.1166 17.3841,14.2527 17.5654,14.4276C17.7464,14.6026 17.8888,14.8133 17.992,15.0603C18.0954,15.3074 18.1471,15.5804 18.1471,15.8796L18.1471,15.8796ZM9.5552,13.8716L8.6749,13.8716L8.6749,17.8986L9.2237,17.8986L9.2237,14.5314L9.2351,14.5314L10.5731,17.8986L10.9331,17.8986L12.2764,14.5314L12.2878,14.5314L12.2878,17.8986L12.8539,17.8986L12.8539,13.8716L11.9736,13.8716L10.7788,16.9657L10.7674,16.9657L9.5552,13.8716ZM6.1955,14.3663L7.4933,14.3663L7.4933,13.8716L4.3316,13.8716L4.3316,14.3663L5.6294,14.3663L5.6294,17.8986L6.1955,17.8986L6.1955,14.3663ZM2.7499,16.4141L1.9951,14.5257L1.2349,16.4141L2.7499,16.4141ZM4.0074,17.8986L3.3674,17.8986L2.9556,16.909L1.0349,16.909L0.6288,17.8986L0,17.8986L1.7551,13.8716L2.2696,13.8716L4.0074,17.8986ZM45.9089,3.7245L44.1547,7.6493L42.4002,3.7245L40.9291,3.7245L43.4191,9.2933L43.369,9.401L43.3511,9.4397L42.8122,10.6512C42.8109,10.6544 42.8099,10.6575 42.8087,10.6606C42.6471,11.0207 42.2213,11.1836 41.8604,11.0233L41.6672,10.9376L41.2908,11.7786L41.1234,12.1515L41.1236,12.1516L41.1259,12.1526L41.5923,12.3596C42.4677,12.7483 43.5006,12.353 43.8923,11.4798C43.8955,11.4726 47.0808,4.39 47.38,3.7245L45.9089,3.7245ZM39.7528,6.7743C39.7528,5.7609 38.9154,4.9277 37.8969,4.9277C37.0814,4.9277 36.3831,5.4552 36.1367,6.1913C36.0754,6.3745 36.041,6.5701 36.041,6.7743C36.041,6.9773 36.0754,7.1726 36.1367,7.3559C36.3815,8.0875 37.0734,8.6209 37.8969,8.6209C38.9154,8.6209 39.7528,7.7989 39.7528,6.7743L39.7528,6.7743ZM40.975,6.7855C40.975,8.4746 39.5944,9.8482 37.8969,9.8482C37.2427,9.8482 36.636,9.6436 36.1367,9.296L36.1367,9.8499L34.7875,9.8499L34.7874,1.0016L36.1367,1.0016L36.1367,4.2751C36.636,3.9276 37.2427,3.7229 37.8969,3.7229C39.5944,3.7229 40.975,5.0965 40.975,6.7855L40.975,6.7855ZM32.309,9.8499L33.6558,9.8499L33.6558,1.0016L32.309,1.0016L32.309,9.8499ZM30.2154,6.7738C30.2154,5.7605 29.3779,4.9272 28.3595,4.9272C27.3409,4.9272 26.5035,5.7493 26.5035,6.7738C26.5035,7.7873 27.3296,8.6205 28.3595,8.6205C29.3779,8.6205 30.2154,7.7986 30.2154,6.7738L30.2154,6.7738ZM31.4376,6.7851C31.4376,8.4741 30.0571,9.8479 28.3595,9.8479C26.6619,9.8479 25.2814,8.4741 25.2814,6.7851C25.2814,5.0961 26.6619,3.7225 28.3595,3.7225C30.0571,3.7225 31.4376,5.0961 31.4376,6.7851L31.4376,6.7851ZM23.2511,5.4198C23.2511,3.7232 21.8612,2.3401 20.156,2.3401L19.2428,2.3401L18.2943,2.3401L18.2943,8.4993L19.2428,8.4993L20.156,8.4993C21.8612,8.4993 23.2511,7.1162 23.2511,5.4198L23.2511,5.4198ZM24.5979,5.4198C24.5979,7.8566 22.6052,9.8394 20.156,9.8394L16.9474,9.8394L16.9474,1L20.156,1C22.6052,1 24.5979,2.9826 24.5979,5.4198L24.5979,5.4198ZM14.2574,1.0001L12.9469,1.0001C10.4999,1.0001 8.5052,2.9848 8.5052,5.4198C8.5052,7.8545 10.4999,9.8393 12.9469,9.8393L14.2574,9.8393L14.2574,1.0001ZM1.6201,1.0001L2.9306,1.0001C5.3775,1.0001 7.3722,2.9848 7.3722,5.4198C7.3722,7.8545 5.3775,9.8393 2.9306,9.8393L1.6201,9.8393L1.6201,1.0001Z" stroke="#00000000" fill-rule="evenodd"/>
</svg>
`,rr=(unsafeWindow==null?void 0:unsafeWindow.wrappedJSObject)??unsafeWindow,oy=typeof cloneInto=="function"?cloneInto:t=>t,wf=typeof exportFunction=="function"?exportFunction:t=>t;function sy(t){return oy(t,rr,{cloneFunctions:!0,wrapReflectors:!0})}function bf(t){return wf(t,rr)}function ay(t){return wf(cy(t),rr)}function ly(t,e){return e??(e=rr),function(...n){return t.call(e,...sy(n))}}function cy(t){return(...e)=>new rr.Promise(bf((n,r)=>{t(...e).then(n).catch(r)}))}const fc={},uy=ly(rr.history.pushState,rr.history);rr.history.pushState=bf(hy);function hy(t,e,n){uy(t,e,n),vf()}addEventListener("popstate",()=>{vf()});function vf(){for(const t of Object.values(fc)){const e=t.pattern.test(location.pathname)?t.onCallbacks:t.offCallbacks;for(const n of e)n()}}function yf(t){const e=new RegExp(`^/${t.replaceAll("/","\\/")}$`);let n=fc[t];return n||(n={pattern:e,onCallbacks:[],offCallbacks:[]},fc[t]=n,n)}function dy(t,e){const n=yf(t),r=n.pattern.test(location.pathname);n.onCallbacks.push(e),r&&e()}function fy(t,e){const n=yf(t),r=n.pattern.test(location.pathname);n.offCallbacks.push(e),r||e()}const Cf="[a-z]{2}/album/.+/.+";function Zr(t){dy(Cf,t)}function Ao(t){fy(Cf,t)}const Sf=new Map;function qr(t,e){return new Promise((n,r)=>{const i=Sf.get(t);if(i){n(i.clone());return}GM.xmlHttpRequest({url:t,method:(e==null?void 0:e.method)??"GET",headers:Object.fromEntries(new Headers(e==null?void 0:e.headers)),responseType:"blob",onload(o){if((o.status<200||o.status>299)&&o.status!==404){r(new Error(`Fetching "${t}" responded with an erroneous status code.`));return}const s=o.responseHeaders.split(`\r
`).slice(0,-1).map(l=>l.split(": ")),a=new Response(o.response,{headers:Object.fromEntries(s),status:o.status,statusText:o.statusText});Object.defineProperty(a,"url",{value:t}),Sf.set(t,a.clone()),n(a)},onerror(){r(new Error("Network request errored."))},ontimeout(){r(new Error("Network request timed out."))}})})}function my(){return Object.fromEntries(document.cookie.split("; ").map(t=>t.split("=",2)))}function Ni(t){return new Promise(e=>{setTimeout(e,t)})}function Rf(t,e){const n=URL.createObjectURL(t),r=document.createElement("a");r.style.display="none",r.download=e,r.href=n,document.body.appendChild(r),r.click(),URL.revokeObjectURL(n)}function gy(t){return new Promise(e=>{const n=setInterval(()=>{const r=t();r!=null&&(clearInterval(n),e(r))},100)})}let Qs="";async function Js(){if(Qs)return Qs;const t=document.querySelector("script[type='module']");if(!t)throw new Error("Failed to find script with auth token.");const r=(await(await qr(t.src)).text()).match(new RegExp('(?<=")eyJhbGciOiJ.+?(?=")'));if(!r)throw new Error("Failed to find auth token from script.");return Qs=r[0],Qs}function _f(){return location.pathname.split("/")[1]}function Tf(){return my().itua||null}async function Ef(){return(await(await qr("https://api.music.apple.com/v1/storefronts",{headers:{Origin:"https://music.apple.com",Referer:"https://music.apple.com/",Authorization:`Bearer ${await Js()}`}})).json()).data}function mc(){return location.pathname.split("/")[4]}async function Di(t,e){e??(e=_f());const n=await qr(`https://amp-api.music.apple.com/v1/catalog/${e}/albums/${t}?extend=extendedAssetUrls`,{headers:{Origin:"https://music.apple.com",Referer:"https://music.apple.com/",Authorization:`Bearer ${await Js()}`}});return n.status===404?null:(await n.json()).data[0]}Zr(async()=>{const t=await Di(mc());if(!t)return;const e=await Xs(".headings__metadata-bottom");if(!e)return;

const n=t.attributes.audioTraits;t.attributes.isMasteredForItunes&&n.push("adm");
const tracks = t.relationships.tracks.data || []; // 获取专辑中所有音轨，确保安全解构
const trackTraits = []; // 用于存储所有音轨的音频特性
tracks.forEach((track) => {
  if (track.type === "songs" && track.attributes && track.attributes.audioTraits) {
    trackTraits.push(...track.attributes.audioTraits); // 合并每个音轨的特性
  }
});
const r=tn('<p class="ame-album-badges-container"></p>');n.includes("lossy-stereo")&&r.insertAdjacentHTML("beforeend",Jv),n.includes("lossless")&&r.insertAdjacentHTML("beforeend",ry),n.includes("hi-res-lossless")&&r.insertAdjacentHTML("beforeend",ny),n.includes("atmos")&&r.insertAdjacentHTML("beforeend",ty),n.includes("adm")&&r.insertAdjacentHTML("beforeend",ey),n.includes("spatial")&&r.insertAdjacentHTML("beforeend",iy)

// 根据音轨特性添加 atmos 图标
if (trackTraits.includes("atmos")) {
  r.insertAdjacentHTML("beforeend", dats);
  }
  
  e.after(r)});
  
  const py=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" slot="app-icon">
  <path d="M11.5 42q-.65 0-1.075-.425Q10 41.15 10 40.5v-31q0-.65.425-1.075Q10.85 8 11.5 8h14.45q.55 0 .95.325.4.325.5.875l.7 3.1h10.4q.65 0 1.075.425Q40 13.15 40 13.8v15.5q0 .65-.425 1.075-.425.425-1.075.425H28.4q-.5 0-.925-.3-.425-.3-.525-.85l-.7-3.1H13V40.5q0 .65-.425 1.075Q12.15 42 11.5 42ZM25 19.4Zm4.75 8.4H37V15.3H25.55L24.6 11H13v12.55h15.8Z" />
</svg>
`;function wy(t,e){let n=document.querySelector(t);if(n)return xf(n);try{e()}catch{console.error(`Could not create menu reference element for selector "${t}".`)}if(n=document.querySelector(t),n)return xf(n);throw new Error(`Could not find menu reference element by selector "${t}".`)}function xf(t){return t.addMenuItem=(e,n)=>{let r=t;for(let i=0;i<100;i++){const o=r.nextElementSibling;if(!o||Number(o.getAttribute("data-index"))>n)break;r=o}return e.setAttribute("data-index",n.toString()),r.after(e),e},t}function Li(t,e){return tn(`
    <li class="ame-sidebar-button navigation-item" data-ame>
      <a class="navigation-item__link" tabindex="0" data-ame>
        ${e}
        <span>${t}</span>
      </a>
    </li>
    `)}async function Fi(t,e){await Xs("amp-chrome-player"),wy("#ame-sidebar",()=>{const r=document.querySelector(".navigation__scrollable-container");r==null||r.appendChild(tn(`
      <div class="navigation-items" data-ame>
        <div class="navigation-items__header" data-ame>
          <span>Ame</span>
        </div>
        <ul class="navigation-items__list" data-ame>
          <li id="ame-sidebar" style="display: none;"></li>
        </ul>
      </div>
    `))}).addMenuItem(t,e)}async function Io(t){t.remove()}const gc=["jp","kr","us","nz","au","de","fr","gb","in","it","es","br","cn","hk"];gc.reverse();let Ln=null;const pc=Li("Check Storefronts",py);pc.addEventListener("click",async()=>{const t=document.querySelector(".section");t&&await Of(t)}),Zr(async()=>{const t=await Xs(".page-error");t&&await Of(t)}),Zr(()=>{Fi(pc,100),Ln==null||Ln.abort(),Ln=null}),Ao(()=>{Io(pc),Ln==null||Ln.abort(),Ln=null});async function Of(t){if(Ln)return;const e=new AbortController;Ln=e;const n=mc(),r=tn('<div class="section ame-album-storefronts-header">Availability in the following storefronts:</div>'),i=tn(`
    <div class="section ame-album-storefronts-container">
      <div class="ame-color-primary"></div>
      <div class="ame-color-secondary"></div>
      <div class="ame-color-tertiary"></div>
    </div>
  `),o=i.children[0],s=i.children[1],a=i.children[2];t.append(r),t.append(i);let l=await Ef();l=l.map(c=>(c.attributes.name=c.attributes.name.split(", ").slice(0,1).join(" "),c)).sort((c,u)=>Math.max(gc.indexOf(u.id),0)-Math.max(gc.indexOf(c.id),0));for(const c of l){if(e.signal.aborted)break;const u=await Di(n,c.id);if(!u){a.append(tn(`<span data-storefront="${c.id}" title="Totally unavailable">${c.attributes.name}, </span>`)),await Ni(250);continue}const d=Math.max(...u.relationships.tracks.data.map(w=>w.attributes.discNumber)),g=u.relationships.tracks.data.filter(w=>w.type==="songs"),f=u.relationships.tracks.data.filter(w=>w.type!=="songs"),b=new Set;for(let w=1;w<=u.attributes.trackCount-f.length;w++)b.add(w);if(g.forEach((w,y)=>{w.attributes.extendedAssetUrls&&w.attributes.playParams&&b.delete(d>1?y+1:w.attributes.trackNumber)}),b.size){const w=d>1?`${b.size} tracks`:Array.from(b).join(", ");s.append(tn(`<span data-storefront="${c.id}"><a target="_blank" href="https://music.apple.com/${c.id}/album/${n}" title="Partially available, missing:
${w}">${c.attributes.name}</a>, </span>`)),await Ni(250);continue}o.append(tn(`<span data-storefront="${c.id}"><a target="_blank" href="https://music.apple.com/${c.id}/album/${n}" title="Fully available">${c.attributes.name}</a>, </span>`)),await Ni(250)}}const wc=Li("Search Covers",`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" slot="app-icon">
  <path d="M24 44q-4.1 0-7.75-1.575-3.65-1.575-6.375-4.3-2.725-2.725-4.3-6.375Q4 28.1 4 24q0-4.25 1.6-7.9 1.6-3.65 4.375-6.35 2.775-2.7 6.5-4.225Q20.2 4 24.45 4q3.95 0 7.5 1.325T38.175 9q2.675 2.35 4.25 5.575Q44 17.8 44 21.65q0 5.4-3.15 8.525T32.5 33.3h-3.75q-.9 0-1.55.7t-.65 1.55q0 1.35.725 2.3.725.95.725 2.2 0 1.9-1.05 2.925T24 44Zm0-20Zm-11.65 1.3q1 0 1.75-.75t.75-1.75q0-1-.75-1.75t-1.75-.75q-1 0-1.75.75t-.75 1.75q0 1 .75 1.75t1.75.75Zm6.3-8.5q1 0 1.75-.75t.75-1.75q0-1-.75-1.75t-1.75-.75q-1 0-1.75.75t-.75 1.75q0 1 .75 1.75t1.75.75Zm10.7 0q1 0 1.75-.75t.75-1.75q0-1-.75-1.75t-1.75-.75q-1 0-1.75.75t-.75 1.75q0 1 .75 1.75t1.75.75Zm6.55 8.5q1 0 1.75-.75t.75-1.75q0-1-.75-1.75t-1.75-.75q-1 0-1.75.75t-.75 1.75q0 1 .75 1.75t1.75.75ZM24 41q.55 0 .775-.225.225-.225.225-.725 0-.7-.725-1.3-.725-.6-.725-2.65 0-2.3 1.5-4.05t3.8-1.75h3.65q3.8 0 6.15-2.225Q41 25.85 41 21.65q0-6.6-5-10.625T24.45 7q-7.3 0-12.375 4.925T7 24q0 7.05 4.975 12.025Q16.95 41 24 41Z" />
</svg>
`);wc.addEventListener("click",()=>{const t=document.querySelector(".headings__subtitles > a"),e=document.querySelector(".headings__title");if(!e)return;const n=t==null?void 0:t.innerText.trim(),r=e.innerText.trim().replace(/ - Single$/i,"").replace(/ - EP$/i,""),i=new URLSearchParams;n&&i.set("artist",n),i.set("album",r),open(`https://covers.musichoarders.xyz?${i}`,"_blank")}),Zr(()=>{Fi(wc,400)}),Ao(()=>{Io(wc)}),addEventListener("mousedown",async t=>{if(t.button!==2)return;const e=t.target;if(!e.matches(".artwork-component__image:not(.ame-full-sized)"))return;e.classList.add("ame-full-sized");const n=document.querySelector(".artwork__radiosity source");if(!n)return;const r=e.parentElement.querySelectorAll("source");for(const i of Array.from(r))i.srcset=by(n.srcset)},{passive:!0});function by(t){return t.split(" ",2)[0].replace(/is\d-ssl/,"a1").replace("image/thumb","r40").split("/").slice(0,-1).join("/")}const Mf=Li("Copy Authorization",`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" slot="app-icon">
  <path d="M24 43.95q-7-1.75-11.5-8.125T8 21.85V9.95l16-6 16 6v11.9q0 7.6-4.5 13.975T24 43.95Zm0-3.1q5.75-1.9 9.375-7.175T37 21.85v-9.8l-13-4.9-13 4.9v9.8q0 6.55 3.625 11.825Q18.25 38.95 24 40.85ZM24 24Z" />
</svg>
`);Mf.addEventListener("click",async()=>{GM.setClipboard(await Js())}),Fi(Mf,0);const vy=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" slot="app-icon">
  <path d="M29.75 33.4h2.5v-3.25h2.05q.7 0 1.2-.475T36 28.5v-8.95q0-.7-.5-1.2t-1.2-.5H28q-.7 0-1.35.5-.65.5-.65 1.2v8.95q0 .7.65 1.175.65.475 1.35.475h1.75ZM12 30.15h2.5V25.7h5v4.45H22v-12.3h-2.5v5.35h-5v-5.35H12Zm16.5-2.5v-7.3h5v7.3ZM7 40q-1.2 0-2.1-.9Q4 38.2 4 37V11q0-1.2.9-2.1Q5.8 8 7 8h34q1.2 0 2.1.9.9.9.9 2.1v26q0 1.2-.9 2.1-.9.9-2.1.9Zm0-3h34V11H7v26Zm0 0V11v26Z" />
</svg>
`,Af=["ec+3","alac","aac ","aach"],If=["BINAURAL","DOWNMIX"];let Fn=null;const bc=Li("Check Qualities",vy);bc.addEventListener("click",async()=>{if(Fn)return;const t=new AbortController;Fn=t;const e=await Di(mc());if(!e)return;const n=Array.from(document.querySelectorAll(".songs-list-row__song-wrapper"));for(const r of e.relationships.tracks.data){if(t.signal.aborted)break;if(r.type!=="songs")continue;const i=n.shift();if(!i)continue;if(!r.attributes.extendedAssetUrls){i.append(tn('<span class="ame-track-quality ame-color-warning">[unavailable]</span>'));continue}const o=r.attributes.extendedAssetUrls.enhancedHls;if(!o){i.append(tn('<span class="ame-track-quality ame-color-warning">[lossy]</span>'));continue}const s=await qr(o).then(d=>d.text());await Ni(200);let a=null;for(const d of s.split(`
`))if(d.startsWith('#EXT-X-SESSION-DATA:DATA-ID="com.apple.hls.audioAssetMetadata"')){a=JSON.parse(atob(d.split("VALUE=")[1].slice(1,-1)));break}if(!a)throw new Error("Could not find data from track manifest.");const l=Object.values(a);l.sort(Hf);const c=o.split("/").slice(0,-1).join("/");for(const d of l)d["AUDIO-FORMAT-ID"]==="atmos"&&(d.__REAL__=await Cy(c,d["FIRST-SEGMENT-URI"]),await Ni(200));const u=l.find(d=>parseInt(d["CHANNEL-COUNT"])>=2);i.append(tn(`<span class="ame-track-quality ame-color-tertiary" title="${yy(l)}">${vc(u,u.__REAL__)}</span>`))}}),Zr(()=>{Fi(bc,200),Fn==null||Fn.abort(),Fn=null}),Ao(()=>{Io(bc),Fn==null||Fn.abort(),Fn=null});function Hf(t,e){return Af.indexOf(t["AUDIO-FORMAT-ID"])-Af.indexOf(e["AUDIO-FORMAT-ID"])||e["BIT-DEPTH"]-t["BIT-DEPTH"]||e["SAMPLE-RATE"]-t["SAMPLE-RATE"]||(e["BIT-RATE"]??NaN)-(t["BIT-RATE"]??NaN)||If.indexOf(t["CHANNEL-USAGE"]??"")-If.indexOf(e["CHANNEL-USAGE"]??"")}function vc(t,e){const n=[];return n.push(t["AUDIO-FORMAT-ID"]),t["CHANNEL-COUNT"]&&n.push(`${t["CHANNEL-COUNT"]}ch`),t["BIT-RATE"]&&n.push(`${Math.floor(Number(t["BIT-RATE"])/1e3)}kbps`),t["BIT-DEPTH"]&&n.push(`${t["BIT-DEPTH"]}bit`),t["SAMPLE-RATE"]&&n.push(`${Math.floor(Number(t["SAMPLE-RATE"])/1e3)}kHz`),t["CHANNEL-USAGE"]&&n.push(t["CHANNEL-USAGE"].toLowerCase()),t["IS-ATMOS"]&&n.push("atmos"),e&&Hf(t,e)===0?n.push("[REAL]"):e&&(n.push("➤"),n.push(vc(e)),n.push("[REAL]")),n.join("  ")}function yy(t){return t.map(e=>vc(e,e.__REAL__)).join(`
`)}async function Cy(t,e){const n=await qr(`${t}/${e}`,{headers:{Range:"bytes=0-16384"}}),r=new DataView(await n.arrayBuffer());if(r.getInt32(4)!==1718909296||r.getInt32(8)!==1769172789)return null;let i=0,o=0;for(;i<r.byteLength;){const s=r.getInt32(i);switch(r.getInt32(i+4)){case 1836019574:case 1953653099:case 1835297121:case 1835626086:case 1937007212:i+=8;break;case 1937011556:i+=16;break;case 1701733217:i+=36;case 1634492771:return{"FIRST-SEGMENT-URI":e,"AUDIO-FORMAT-ID":"alac","CHANNEL-COUNT":r.getUint8(i+8+13).toString(),"BIT-DEPTH":r.getUint8(i+8+9),"SAMPLE-RATE":r.getInt32(i+8+24),__REAL__:null};default:i+=s;break}if(o++>100)break}return null}var Mr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Sy(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ho=function(t){return t&&t.Math===Math&&t},wt=Ho(typeof globalThis=="object"&&globalThis)||Ho(typeof window=="object"&&window)||Ho(typeof self=="object"&&self)||Ho(typeof Mr=="object"&&Mr)||Ho(typeof Mr=="object"&&Mr)||function(){return this}()||Function("return this")(),yc={},Dt=function(t){try{return!!t()}catch{return!0}},Ry=Dt,$n=!Ry(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),_y=Dt,ea=!_y(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),Ty=ea,ta=Function.prototype.call,ir=Ty?ta.bind(ta):function(){return ta.apply(ta,arguments)},kf={},Pf={}.propertyIsEnumerable,Nf=Object.getOwnPropertyDescriptor,Ey=Nf&&!Pf.call({1:2},1);kf.f=Ey?function(e){var n=Nf(this,e);return!!n&&n.enumerable}:Pf;var Cc=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},Df=ea,Lf=Function.prototype,Sc=Lf.call,xy=Df&&Lf.bind.bind(Sc,Sc),rt=Df?xy:function(t){return function(){return Sc.apply(t,arguments)}},Ff=rt,Oy=Ff({}.toString),My=Ff("".slice),Xr=function(t){return My(Oy(t),8,-1)},Ay=rt,Iy=Dt,Hy=Xr,Rc=Object,ky=Ay("".split),Py=Iy(function(){return!Rc("z").propertyIsEnumerable(0)})?function(t){return Hy(t)==="String"?ky(t,""):Rc(t)}:Rc,_c=function(t){return t==null},Ny=_c,Dy=TypeError,ko=function(t){if(Ny(t))throw new Dy("Can't call method on "+t);return t},Ly=Py,Fy=ko,na=function(t){return Ly(Fy(t))},Tc=typeof document=="object"&&document.all,bt=typeof Tc>"u"&&Tc!==void 0?function(t){return typeof t=="function"||t===Tc}:function(t){return typeof t=="function"},$y=bt,Wn=function(t){return typeof t=="object"?t!==null:$y(t)},Ec=wt,Wy=bt,By=function(t){return Wy(t)?t:void 0},$i=function(t,e){return arguments.length<2?By(Ec[t]):Ec[t]&&Ec[t][e]},Vy=rt,xc=Vy({}.isPrototypeOf),zy=wt,$f=zy.navigator,Wf=$f&&$f.userAgent,ra=Wf?String(Wf):"",Bf=wt,Oc=ra,Vf=Bf.process,zf=Bf.Deno,jf=Vf&&Vf.versions||zf&&zf.version,Uf=jf&&jf.v8,wn,ia;Uf&&(wn=Uf.split("."),ia=wn[0]>0&&wn[0]<4?1:+(wn[0]+wn[1])),!ia&&Oc&&(wn=Oc.match(/Edge\/(\d+)/),(!wn||wn[1]>=74)&&(wn=Oc.match(/Chrome\/(\d+)/),wn&&(ia=+wn[1])));var jy=ia,Yf=jy,Uy=Dt,Yy=wt,Gy=Yy.String,Mc=!!Object.getOwnPropertySymbols&&!Uy(function(){var t=Symbol("symbol detection");return!Gy(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&Yf&&Yf<41}),Ky=Mc,Gf=Ky&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Zy=$i,qy=bt,Xy=xc,Qy=Gf,Jy=Object,Ac=Qy?function(t){return typeof t=="symbol"}:function(t){var e=Zy("Symbol");return qy(e)&&Xy(e.prototype,Jy(t))},eC=String,tC=function(t){try{return eC(t)}catch{return"Object"}},nC=bt,rC=tC,iC=TypeError,oa=function(t){if(nC(t))return t;throw new iC(rC(t)+" is not a function")},oC=oa,sC=_c,Ic=function(t,e){var n=t[e];return sC(n)?void 0:oC(n)},Hc=ir,kc=bt,Pc=Wn,aC=TypeError,lC=function(t,e){var n,r;if(e==="string"&&kc(n=t.toString)&&!Pc(r=Hc(n,t))||kc(n=t.valueOf)&&!Pc(r=Hc(n,t))||e!=="string"&&kc(n=t.toString)&&!Pc(r=Hc(n,t)))return r;throw new aC("Can't convert object to primitive value")},Kf={exports:{}},Zf=wt,cC=Object.defineProperty,Nc=function(t,e){try{cC(Zf,t,{value:e,configurable:!0,writable:!0})}catch{Zf[t]=e}return e},uC=wt,hC=Nc,qf="__core-js_shared__",Xf=Kf.exports=uC[qf]||hC(qf,{});(Xf.versions||(Xf.versions=[])).push({version:"3.38.1",mode:"global",copyright:"© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.38.1/LICENSE",source:"https://github.com/zloirock/core-js"});var Dc=Kf.exports,Qf=Dc,Jf=function(t,e){return Qf[t]||(Qf[t]=e||{})},dC=ko,fC=Object,sa=function(t){return fC(dC(t))},mC=rt,gC=sa,pC=mC({}.hasOwnProperty),Bn=Object.hasOwn||function(e,n){return pC(gC(e),n)},wC=rt,bC=0,vC=Math.random(),yC=wC(1 .toString),em=function(t){return"Symbol("+(t===void 0?"":t)+")_"+yC(++bC+vC,36)},CC=wt,SC=Jf,tm=Bn,RC=em,_C=Mc,TC=Gf,Wi=CC.Symbol,Lc=SC("wks"),EC=TC?Wi.for||Wi:Wi&&Wi.withoutSetter||RC,Bi=function(t){return tm(Lc,t)||(Lc[t]=_C&&tm(Wi,t)?Wi[t]:EC("Symbol."+t)),Lc[t]},xC=ir,nm=Wn,rm=Ac,OC=Ic,MC=lC,AC=Bi,IC=TypeError,HC=AC("toPrimitive"),kC=function(t,e){if(!nm(t)||rm(t))return t;var n=OC(t,HC),r;if(n){if(e===void 0&&(e="default"),r=xC(n,t,e),!nm(r)||rm(r))return r;throw new IC("Can't convert object to primitive value")}return e===void 0&&(e="number"),MC(t,e)},PC=kC,NC=Ac,im=function(t){var e=PC(t,"string");return NC(e)?e:e+""},DC=wt,om=Wn,Fc=DC.document,LC=om(Fc)&&om(Fc.createElement),$c=function(t){return LC?Fc.createElement(t):{}},FC=$n,$C=Dt,WC=$c,sm=!FC&&!$C(function(){return Object.defineProperty(WC("div"),"a",{get:function(){return 7}}).a!==7}),BC=$n,VC=ir,zC=kf,jC=Cc,UC=na,YC=im,GC=Bn,KC=sm,am=Object.getOwnPropertyDescriptor;yc.f=BC?am:function(e,n){if(e=UC(e),n=YC(n),KC)try{return am(e,n)}catch{}if(GC(e,n))return jC(!VC(zC.f,e,n),e[n])};var Qr={},ZC=$n,qC=Dt,lm=ZC&&qC(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),XC=Wn,QC=String,JC=TypeError,Jr=function(t){if(XC(t))return t;throw new JC(QC(t)+" is not an object")},eS=$n,tS=sm,nS=lm,aa=Jr,cm=im,rS=TypeError,Wc=Object.defineProperty,iS=Object.getOwnPropertyDescriptor,Bc="enumerable",Vc="configurable",zc="writable";Qr.f=eS?nS?function(e,n,r){if(aa(e),n=cm(n),aa(r),typeof e=="function"&&n==="prototype"&&"value"in r&&zc in r&&!r[zc]){var i=iS(e,n);i&&i[zc]&&(e[n]=r.value,r={configurable:Vc in r?r[Vc]:i[Vc],enumerable:Bc in r?r[Bc]:i[Bc],writable:!1})}return Wc(e,n,r)}:Wc:function(e,n,r){if(aa(e),n=cm(n),aa(r),tS)try{return Wc(e,n,r)}catch{}if("get"in r||"set"in r)throw new rS("Accessors not supported");return"value"in r&&(e[n]=r.value),e};var oS=$n,sS=Qr,aS=Cc,Po=oS?function(t,e,n){return sS.f(t,e,aS(1,n))}:function(t,e,n){return t[e]=n,t},um={exports:{}},jc=$n,lS=Bn,hm=Function.prototype,cS=jc&&Object.getOwnPropertyDescriptor,Uc=lS(hm,"name"),uS=Uc&&(function(){}).name==="something",hS=Uc&&(!jc||jc&&cS(hm,"name").configurable),dS={EXISTS:Uc,PROPER:uS,CONFIGURABLE:hS},fS=rt,mS=bt,Yc=Dc,gS=fS(Function.toString);mS(Yc.inspectSource)||(Yc.inspectSource=function(t){return gS(t)});var pS=Yc.inspectSource,wS=wt,bS=bt,dm=wS.WeakMap,vS=bS(dm)&&/native code/.test(String(dm)),yS=Jf,CS=em,fm=yS("keys"),mm=function(t){return fm[t]||(fm[t]=CS(t))},Gc={},SS=vS,gm=wt,RS=Wn,_S=Po,Kc=Bn,Zc=Dc,TS=mm,ES=Gc,pm="Object already initialized",qc=gm.TypeError,xS=gm.WeakMap,la,No,ca,OS=function(t){return ca(t)?No(t):la(t,{})},MS=function(t){return function(e){var n;if(!RS(e)||(n=No(e)).type!==t)throw new qc("Incompatible receiver, "+t+" required");return n}};if(SS||Zc.state){var Vn=Zc.state||(Zc.state=new xS);Vn.get=Vn.get,Vn.has=Vn.has,Vn.set=Vn.set,la=function(t,e){if(Vn.has(t))throw new qc(pm);return e.facade=t,Vn.set(t,e),e},No=function(t){return Vn.get(t)||{}},ca=function(t){return Vn.has(t)}}else{var Vi=TS("state");ES[Vi]=!0,la=function(t,e){if(Kc(t,Vi))throw new qc(pm);return e.facade=t,_S(t,Vi,e),e},No=function(t){return Kc(t,Vi)?t[Vi]:{}},ca=function(t){return Kc(t,Vi)}}var AS={set:la,get:No,has:ca,enforce:OS,getterFor:MS},Xc=rt,IS=Dt,HS=bt,ua=Bn,Qc=$n,kS=dS.CONFIGURABLE,PS=pS,wm=AS,NS=wm.enforce,DS=wm.get,bm=String,ha=Object.defineProperty,LS=Xc("".slice),FS=Xc("".replace),$S=Xc([].join),WS=Qc&&!IS(function(){return ha(function(){},"length",{value:8}).length!==8}),BS=String(String).split("String"),VS=um.exports=function(t,e,n){LS(bm(e),0,7)==="Symbol("&&(e="["+FS(bm(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!ua(t,"name")||kS&&t.name!==e)&&(Qc?ha(t,"name",{value:e,configurable:!0}):t.name=e),WS&&n&&ua(n,"arity")&&t.length!==n.arity&&ha(t,"length",{value:n.arity});try{n&&ua(n,"constructor")&&n.constructor?Qc&&ha(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var r=NS(t);return ua(r,"source")||(r.source=$S(BS,typeof e=="string"?e:"")),t};Function.prototype.toString=VS(function(){return HS(this)&&DS(this).source||PS(this)},"toString");var zS=um.exports,jS=bt,US=Qr,YS=zS,GS=Nc,KS=function(t,e,n,r){r||(r={});var i=r.enumerable,o=r.name!==void 0?r.name:e;if(jS(n)&&YS(n,o,r),r.global)i?t[e]=n:GS(e,n);else{try{r.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=n:US.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},vm={},ZS=Math.ceil,qS=Math.floor,XS=Math.trunc||function(e){var n=+e;return(n>0?qS:ZS)(n)},QS=XS,Do=function(t){var e=+t;return e!==e||e===0?0:QS(e)},JS=Do,e2=Math.max,t2=Math.min,n2=function(t,e){var n=JS(t);return n<0?e2(n+e,0):t2(n,e)},r2=Do,i2=Math.min,o2=function(t){var e=r2(t);return e>0?i2(e,9007199254740991):0},s2=o2,Jc=function(t){return s2(t.length)},a2=na,l2=n2,c2=Jc,ym=function(t){return function(e,n,r){var i=a2(e),o=c2(i);if(o===0)return!t&&-1;var s=l2(r,o),a;if(t&&n!==n){for(;o>s;)if(a=i[s++],a!==a)return!0}else for(;o>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}},u2={includes:ym(!0),indexOf:ym(!1)},h2=rt,eu=Bn,d2=na,f2=u2.indexOf,m2=Gc,Cm=h2([].push),Sm=function(t,e){var n=d2(t),r=0,i=[],o;for(o in n)!eu(m2,o)&&eu(n,o)&&Cm(i,o);for(;e.length>r;)eu(n,o=e[r++])&&(~f2(i,o)||Cm(i,o));return i},tu=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],g2=Sm,p2=tu,w2=p2.concat("length","prototype");vm.f=Object.getOwnPropertyNames||function(e){return g2(e,w2)};var Rm={};Rm.f=Object.getOwnPropertySymbols;var b2=$i,v2=rt,y2=vm,C2=Rm,S2=Jr,R2=v2([].concat),_2=b2("Reflect","ownKeys")||function(e){var n=y2.f(S2(e)),r=C2.f;return r?R2(n,r(e)):n},_m=Bn,T2=_2,E2=yc,x2=Qr,Tm=function(t,e,n){for(var r=T2(e),i=x2.f,o=E2.f,s=0;s<r.length;s++){var a=r[s];!_m(t,a)&&!(n&&_m(n,a))&&i(t,a,o(e,a))}},O2=Dt,M2=bt,A2=/#|\.prototype\./,Lo=function(t,e){var n=H2[I2(t)];return n===P2?!0:n===k2?!1:M2(e)?O2(e):!!e},I2=Lo.normalize=function(t){return String(t).replace(A2,".").toLowerCase()},H2=Lo.data={},k2=Lo.NATIVE="N",P2=Lo.POLYFILL="P",N2=Lo,da=wt,D2=yc.f,L2=Po,F2=KS,$2=Nc,W2=Tm,B2=N2,Ot=function(t,e){var n=t.target,r=t.global,i=t.stat,o,s,a,l,c,u;if(r?s=da:i?s=da[n]||$2(n,{}):s=da[n]&&da[n].prototype,s)for(a in e){if(c=e[a],t.dontCallGetSet?(u=D2(s,a),l=u&&u.value):l=s[a],o=B2(r?a:n+(i?".":"#")+a,t.forced),!o&&l!==void 0){if(typeof c==typeof l)continue;W2(c,l)}(t.sham||l&&l.sham)&&L2(c,"sham",!0),F2(s,a,c,t)}},V2=ea,Em=Function.prototype,xm=Em.apply,Om=Em.call,fa=typeof Reflect=="object"&&Reflect.apply||(V2?Om.bind(xm):function(){return Om.apply(xm,arguments)}),z2=rt,j2=oa,Mm=function(t,e,n){try{return z2(j2(Object.getOwnPropertyDescriptor(t,e)[n]))}catch{}},U2=Wn,Y2=function(t){return U2(t)||t===null},G2=Y2,K2=String,Z2=TypeError,q2=function(t){if(G2(t))return t;throw new Z2("Can't set "+K2(t)+" as a prototype")},X2=Mm,Q2=Wn,J2=ko,eR=q2,Am=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=X2(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch{}return function(i,o){return J2(i),eR(o),Q2(i)&&(t?n(i,o):i.__proto__=o),i}}():void 0),tR=Qr.f,nR=function(t,e,n){n in t||tR(t,n,{configurable:!0,get:function(){return e[n]},set:function(r){e[n]=r}})},rR=bt,iR=Wn,Im=Am,oR=function(t,e,n){var r,i;return Im&&rR(r=e.constructor)&&r!==n&&iR(i=r.prototype)&&i!==n.prototype&&Im(t,i),t},sR=Bi,aR=sR("toStringTag"),Hm={};Hm[aR]="z";var lR=String(Hm)==="[object z]",cR=lR,uR=bt,ma=Xr,hR=Bi,dR=hR("toStringTag"),fR=Object,mR=ma(function(){return arguments}())==="Arguments",gR=function(t,e){try{return t[e]}catch{}},pR=cR?ma:function(t){var e,n,r;return t===void 0?"Undefined":t===null?"Null":typeof(n=gR(e=fR(t),dR))=="string"?n:mR?ma(e):(r=ma(e))==="Object"&&uR(e.callee)?"Arguments":r},wR=pR,bR=String,ga=function(t){if(wR(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return bR(t)},vR=ga,yR=function(t,e){return t===void 0?arguments.length<2?"":e:vR(t)},CR=Wn,SR=Po,RR=function(t,e){CR(e)&&"cause"in e&&SR(t,"cause",e.cause)},_R=rt,km=Error,TR=_R("".replace),ER=function(t){return String(new km(t).stack)}("zxcasd"),Pm=/\n\s*at [^:]*:[^\n]*/,xR=Pm.test(ER),OR=function(t,e){if(xR&&typeof t=="string"&&!km.prepareStackTrace)for(;e--;)t=TR(t,Pm,"");return t},MR=Dt,AR=Cc,IR=!MR(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",AR(1,7)),t.stack!==7):!0}),HR=Po,kR=OR,PR=IR,Nm=Error.captureStackTrace,NR=function(t,e,n,r){PR&&(Nm?Nm(t,e):HR(t,"stack",kR(n,r)))},Dm=$i,DR=Bn,Lm=Po,LR=xc,Fm=Am,$m=Tm,Wm=nR,FR=oR,$R=yR,WR=RR,BR=NR,VR=$n,zR=function(t,e,n,r){var i="stackTraceLimit",o=r?2:1,s=t.split("."),a=s[s.length-1],l=Dm.apply(null,s);if(l){var c=l.prototype;if(DR(c,"cause")&&delete c.cause,!n)return l;var u=Dm("Error"),d=e(function(g,f){var b=$R(r?f:g,void 0),w=r?new l(g):new l;return b!==void 0&&Lm(w,"message",b),BR(w,d,w.stack,2),this&&LR(c,this)&&FR(w,this,d),arguments.length>o&&WR(w,arguments[o]),w});d.prototype=c,a!=="Error"?Fm?Fm(d,u):$m(d,u,{name:!0}):VR&&i in l&&(Wm(d,l,i),Wm(d,l,"prepareStackTrace")),$m(d,l);try{c.name!==a&&Lm(c,"name",a),c.constructor=d}catch{}return d}},Bm=Ot,jR=wt,zn=fa,Vm=zR,nu="WebAssembly",zm=jR[nu],pa=new Error("e",{cause:7}).cause!==7,ei=function(t,e){var n={};n[t]=Vm(t,e,pa),Bm({global:!0,constructor:!0,arity:1,forced:pa},n)},ru=function(t,e){if(zm&&zm[t]){var n={};n[t]=Vm(nu+"."+t,e,pa),Bm({target:nu,stat:!0,constructor:!0,arity:1,forced:pa},n)}};ei("Error",function(t){return function(n){return zn(t,this,arguments)}}),ei("EvalError",function(t){return function(n){return zn(t,this,arguments)}}),ei("RangeError",function(t){return function(n){return zn(t,this,arguments)}}),ei("ReferenceError",function(t){return function(n){return zn(t,this,arguments)}}),ei("SyntaxError",function(t){return function(n){return zn(t,this,arguments)}}),ei("TypeError",function(t){return function(n){return zn(t,this,arguments)}}),ei("URIError",function(t){return function(n){return zn(t,this,arguments)}}),ru("CompileError",function(t){return function(n){return zn(t,this,arguments)}}),ru("LinkError",function(t){return function(n){return zn(t,this,arguments)}}),ru("RuntimeError",function(t){return function(n){return zn(t,this,arguments)}});var UR=Xr,jm=Array.isArray||function(e){return UR(e)==="Array"},YR=$n,GR=jm,KR=TypeError,ZR=Object.getOwnPropertyDescriptor,qR=YR&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),XR=qR?function(t,e){if(GR(t)&&!ZR(t,"length").writable)throw new KR("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},QR=TypeError,JR=9007199254740991,e_=function(t){if(t>JR)throw QR("Maximum allowed index exceeded");return t},t_=Ot,n_=sa,r_=Jc,i_=XR,o_=e_,s_=Dt,a_=s_(function(){return[].push.call({length:4294967296},1)!==4294967297}),l_=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},c_=a_||!l_();t_({target:"Array",proto:!0,arity:1,forced:c_},{push:function(e){var n=n_(this),r=r_(n),i=arguments.length;o_(r+i);for(var o=0;o<i;o++)n[r]=arguments[o],r++;return i_(n,r),r}});var iu=rt,wa=Set.prototype,jn={Set,add:iu(wa.add),has:iu(wa.has),remove:iu(wa.delete),proto:wa},u_=jn.has,ti=function(t){return u_(t),t},h_=ir,ni=function(t,e,n){for(var r=n?t:t.iterator,i=t.next,o,s;!(o=h_(i,r)).done;)if(s=e(o.value),s!==void 0)return s},Um=rt,d_=ni,Ym=jn,f_=Ym.Set,Gm=Ym.proto,m_=Um(Gm.forEach),Km=Um(Gm.keys),g_=Km(new f_).next,Fo=function(t,e,n){return n?d_({iterator:Km(t),next:g_},e):m_(t,e)},Zm=jn,p_=Fo,w_=Zm.Set,b_=Zm.add,ou=function(t){var e=new w_;return p_(t,function(n){b_(e,n)}),e},v_=Mm,y_=jn,$o=v_(y_.proto,"size","get")||function(t){return t.size},C_=function(t){return{iterator:t,next:t.next,done:!1}},qm=oa,Xm=Jr,Qm=ir,S_=Do,R_=C_,Jm="Invalid size",__=RangeError,T_=TypeError,E_=Math.max,eg=function(t,e){this.set=t,this.size=E_(e,0),this.has=qm(t.has),this.keys=qm(t.keys)};eg.prototype={getIterator:function(){return R_(Xm(Qm(this.keys,this.set)))},includes:function(t){return Qm(this.has,this.set,t)}};var ri=function(t){Xm(t);var e=+t.size;if(e!==e)throw new T_(Jm);var n=S_(e);if(n<0)throw new __(Jm);return new eg(t,n)},x_=ti,tg=jn,O_=ou,M_=$o,A_=ri,I_=Fo,H_=ni,k_=tg.has,ng=tg.remove,P_=function(e){var n=x_(this),r=A_(e),i=O_(n);return M_(n)<=r.size?I_(n,function(o){r.includes(o)&&ng(i,o)}):H_(r.getIterator(),function(o){k_(n,o)&&ng(i,o)}),i},N_=$i,rg=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},ii=function(t){var e=N_("Set");try{new e()[t](rg(0));try{return new e()[t](rg(-1)),!1}catch{return!0}}catch{return!1}},D_=Ot,L_=P_,F_=ii;D_({target:"Set",proto:!0,real:!0,forced:!F_("difference")},{difference:L_});var $_=ti,su=jn,W_=$o,B_=ri,V_=Fo,z_=ni,j_=su.Set,ig=su.add,U_=su.has,Y_=function(e){var n=$_(this),r=B_(e),i=new j_;return W_(n)>r.size?z_(r.getIterator(),function(o){U_(n,o)&&ig(i,o)}):V_(n,function(o){r.includes(o)&&ig(i,o)}),i},G_=Ot,K_=Dt,Z_=Y_,q_=ii,X_=!q_("intersection")||K_(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});G_({target:"Set",proto:!0,real:!0,forced:X_},{intersection:Z_});var Q_=ir,og=Jr,J_=Ic,sg=function(t,e,n){var r,i;og(t);try{if(r=J_(t,"return"),!r){if(e==="throw")throw n;return n}r=Q_(r,t)}catch(o){i=!0,r=o}if(e==="throw")throw n;if(i)throw r;return og(r),n},eT=ti,tT=jn.has,nT=$o,rT=ri,iT=Fo,oT=ni,sT=sg,aT=function(e){var n=eT(this),r=rT(e);if(nT(n)<=r.size)return iT(n,function(o){if(r.includes(o))return!1},!0)!==!1;var i=r.getIterator();return oT(i,function(o){if(tT(n,o))return sT(i,"normal",!1)})!==!1},lT=Ot,cT=aT,uT=ii;lT({target:"Set",proto:!0,real:!0,forced:!uT("isDisjointFrom")},{isDisjointFrom:cT});var hT=ti,dT=$o,fT=Fo,mT=ri,gT=function(e){var n=hT(this),r=mT(e);return dT(n)>r.size?!1:fT(n,function(i){if(!r.includes(i))return!1},!0)!==!1},pT=Ot,wT=gT,bT=ii;pT({target:"Set",proto:!0,real:!0,forced:!bT("isSubsetOf")},{isSubsetOf:wT});var vT=ti,yT=jn.has,CT=$o,ST=ri,RT=ni,_T=sg,TT=function(e){var n=vT(this),r=ST(e);if(CT(n)<r.size)return!1;var i=r.getIterator();return RT(i,function(o){if(!yT(n,o))return _T(i,"normal",!1)})!==!1},ET=Ot,xT=TT,OT=ii;ET({target:"Set",proto:!0,real:!0,forced:!OT("isSupersetOf")},{isSupersetOf:xT});var MT=ti,au=jn,AT=ou,IT=ri,HT=ni,kT=au.add,PT=au.has,NT=au.remove,DT=function(e){var n=MT(this),r=IT(e).getIterator(),i=AT(n);return HT(r,function(o){PT(n,o)?NT(i,o):kT(i,o)}),i},LT=Ot,FT=DT,$T=ii;LT({target:"Set",proto:!0,real:!0,forced:!$T("symmetricDifference")},{symmetricDifference:FT});var WT=ti,BT=jn.add,VT=ou,zT=ri,jT=ni,UT=function(e){var n=WT(this),r=zT(e).getIterator(),i=VT(n);return jT(r,function(o){BT(i,o)}),i},YT=Ot,GT=UT,KT=ii;YT({target:"Set",proto:!0,real:!0,forced:!KT("union")},{union:GT});var ZT=Xr,qT=rt,XT=function(t){if(ZT(t)==="Function")return qT(t)},ag=XT,QT=oa,JT=ea,eE=ag(ag.bind),tE=function(t,e){return QT(t),e===void 0?t:JT?eE(t,e):function(){return t.apply(e,arguments)}},nE=$i,lg=nE("document","documentElement"),rE=rt,lu=rE([].slice),iE=TypeError,cg=function(t,e){if(t<e)throw new iE("Not enough arguments");return t},oE=ra,sE=/(?:ipad|iphone|ipod).*applewebkit/i.test(oE),Wo=wt,aE=ra,lE=Xr,ba=function(t){return aE.slice(0,t.length)===t},ug=function(){return ba("Bun/")?"BUN":ba("Cloudflare-Workers")?"CLOUDFLARE":ba("Deno/")?"DENO":ba("Node.js/")?"NODE":Wo.Bun&&typeof Bun.version=="string"?"BUN":Wo.Deno&&typeof Deno.version=="object"?"DENO":lE(Wo.process)==="process"?"NODE":Wo.window&&Wo.document?"BROWSER":"REST"}(),cE=ug,uE=cE==="NODE",Kt=wt,hE=fa,dE=tE,hg=bt,fE=Bn,dg=Dt,fg=lg,mE=lu,mg=$c,gE=cg,pE=sE,wE=uE,cu=Kt.setImmediate,uu=Kt.clearImmediate,bE=Kt.process,hu=Kt.Dispatch,vE=Kt.Function,gg=Kt.MessageChannel,yE=Kt.String,du=0,Bo={},pg="onreadystatechange",Vo,oi,fu,mu;dg(function(){Vo=Kt.location});var gu=function(t){if(fE(Bo,t)){var e=Bo[t];delete Bo[t],e()}},pu=function(t){return function(){gu(t)}},wg=function(t){gu(t.data)},bg=function(t){Kt.postMessage(yE(t),Vo.protocol+"//"+Vo.host)};(!cu||!uu)&&(cu=function(e){gE(arguments.length,1);var n=hg(e)?e:vE(e),r=mE(arguments,1);return Bo[++du]=function(){hE(n,void 0,r)},oi(du),du},uu=function(e){delete Bo[e]},wE?oi=function(t){bE.nextTick(pu(t))}:hu&&hu.now?oi=function(t){hu.now(pu(t))}:gg&&!pE?(fu=new gg,mu=fu.port2,fu.port1.onmessage=wg,oi=dE(mu.postMessage,mu)):Kt.addEventListener&&hg(Kt.postMessage)&&!Kt.importScripts&&Vo&&Vo.protocol!=="file:"&&!dg(bg)?(oi=bg,Kt.addEventListener("message",wg,!1)):pg in mg("script")?oi=function(t){fg.appendChild(mg("script"))[pg]=function(){fg.removeChild(this),gu(t)}}:oi=function(t){setTimeout(pu(t),0)});var vg={set:cu,clear:uu},CE=Ot,SE=wt,yg=vg.clear;CE({global:!0,bind:!0,enumerable:!0,forced:SE.clearImmediate!==yg},{clearImmediate:yg});var Cg=wt,RE=fa,_E=bt,TE=ug,EE=ra,xE=lu,OE=cg,ME=Cg.Function,AE=/MSIE .\./.test(EE)||TE==="BUN"&&function(){var t=Cg.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),IE=function(t,e){var n=e?2:1;return AE?function(r,i){var o=OE(arguments.length,1)>n,s=_E(r)?r:ME(r),a=o?xE(arguments,n):[],l=o?function(){RE(s,this,a)}:s;return e?t(l,i):t(l)}:t},HE=Ot,Sg=wt,Rg=vg.set,kE=IE,_g=Sg.setImmediate?kE(Rg,!1):Rg;HE({global:!0,bind:!0,enumerable:!0,forced:Sg.setImmediate!==_g},{setImmediate:_g});/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */function Ar(t){"@babel/helpers - typeof";return Ar=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ar(t)}function wu(t,e){return wu=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},wu(t,e)}function PE(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function va(t,e,n){return PE()?va=Reflect.construct:va=function(i,o,s){var a=[null];a.push.apply(a,o);var l=Function.bind.apply(i,a),c=new l;return s&&wu(c,s.prototype),c},va.apply(null,arguments)}function bn(t){return NE(t)||DE(t)||LE(t)||FE()}function NE(t){if(Array.isArray(t))return bu(t)}function DE(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function LE(t,e){if(t){if(typeof t=="string")return bu(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bu(t,e)}}function bu(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function FE(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var $E=Object.hasOwnProperty,Tg=Object.setPrototypeOf,WE=Object.isFrozen,BE=Object.getPrototypeOf,VE=Object.getOwnPropertyDescriptor,Mt=Object.freeze,vn=Object.seal,zE=Object.create,Eg=typeof Reflect<"u"&&Reflect,ya=Eg.apply,vu=Eg.construct;ya||(ya=function(e,n,r){return e.apply(n,r)}),Mt||(Mt=function(e){return e}),vn||(vn=function(e){return e}),vu||(vu=function(e,n){return va(e,bn(n))});var jE=nn(Array.prototype.forEach),xg=nn(Array.prototype.pop),zo=nn(Array.prototype.push),Ca=nn(String.prototype.toLowerCase),yu=nn(String.prototype.toString),UE=nn(String.prototype.match),yn=nn(String.prototype.replace),YE=nn(String.prototype.indexOf),GE=nn(String.prototype.trim),At=nn(RegExp.prototype.test),Cu=KE(TypeError);function nn(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return ya(t,e,r)}}function KE(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return vu(t,n)}}function Te(t,e,n){var r;n=(r=n)!==null&&r!==void 0?r:Ca,Tg&&Tg(t,null);for(var i=e.length;i--;){var o=e[i];if(typeof o=="string"){var s=n(o);s!==o&&(WE(e)||(e[i]=s),o=s)}t[o]=!0}return t}function si(t){var e=zE(null),n;for(n in t)ya($E,t,[n])===!0&&(e[n]=t[n]);return e}function Sa(t,e){for(;t!==null;){var n=VE(t,e);if(n){if(n.get)return nn(n.get);if(typeof n.value=="function")return nn(n.value)}t=BE(t)}function r(i){return console.warn("fallback value for",i),null}return r}var Og=Mt(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Su=Mt(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Ru=Mt(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),ZE=Mt(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),_u=Mt(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),qE=Mt(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Mg=Mt(["#text"]),Ag=Mt(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Tu=Mt(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Ig=Mt(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ra=Mt(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),XE=vn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),QE=vn(/<%[\w\W]*|[\w\W]*%>/gm),JE=vn(/\${[\w\W]*}/gm),ex=vn(/^data-[\-\w.\u00B7-\uFFFF]/),tx=vn(/^aria-[\-\w]+$/),nx=vn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),rx=vn(/^(?:\w+script|data):/i),ix=vn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),ox=vn(/^html$/i),sx=function(){return typeof window>"u"?null:window},ax=function(e,n){if(Ar(e)!=="object"||typeof e.createPolicy!="function")return null;var r=null,i="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(i)&&(r=n.currentScript.getAttribute(i));var o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function Hg(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:sx(),e=function(P){return Hg(P)};if(e.version="2.4.7",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;var n=t.document,r=t.document,i=t.DocumentFragment,o=t.HTMLTemplateElement,s=t.Node,a=t.Element,l=t.NodeFilter,c=t.NamedNodeMap,u=c===void 0?t.NamedNodeMap||t.MozNamedAttrMap:c,d=t.HTMLFormElement,g=t.DOMParser,f=t.trustedTypes,b=a.prototype,w=Sa(b,"cloneNode"),y=Sa(b,"nextSibling"),v=Sa(b,"childNodes"),R=Sa(b,"parentNode");if(typeof o=="function"){var T=r.createElement("template");T.content&&T.content.ownerDocument&&(r=T.content.ownerDocument)}var M=ax(f,n),I=M?M.createHTML(""):"",L=r,N=L.implementation,$=L.createNodeIterator,W=L.createDocumentFragment,q=L.getElementsByTagName,ue=n.importNode,A={};try{A=si(r).documentMode?r.documentMode:{}}catch{}var B={};e.isSupported=typeof R=="function"&&N&&N.createHTMLDocument!==void 0&&A!==9;var C=XE,z=QE,fe=JE,K=ex,ie=tx,U=rx,me=ix,h=nx,m=null,S=Te({},[].concat(bn(Og),bn(Su),bn(Ru),bn(_u),bn(Mg))),E=null,O=Te({},[].concat(bn(Ag),bn(Tu),bn(Ig),bn(Ra))),k=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Z=null,Y=null,ne=!0,oe=!0,X=!1,ye=!0,Ce=!1,p=!1,V=!1,F=!1,x=!1,_=!1,H=!1,G=!0,j=!1,D="user-content-",Q=!0,re=!1,J={},ce=null,Re=Te({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),ve=null,gt=Te({},["audio","video","img","source","image","track"]),gn=null,vt=Te({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),st="http://www.w3.org/1998/Math/MathML",Pe="http://www.w3.org/2000/svg",nt="http://www.w3.org/1999/xhtml",Et=nt,qe=!1,yt=null,Mo=Te({},[st,Pe,nt],yu),pn,df=["application/xhtml+xml","text/html"],uc="text/html",Xe,Dn=null,YD=r.createElement("form"),zv=function(P){return P instanceof RegExp||P instanceof Function},ff=function(P){Dn&&Dn===P||((!P||Ar(P)!=="object")&&(P={}),P=si(P),pn=df.indexOf(P.PARSER_MEDIA_TYPE)===-1?pn=uc:pn=P.PARSER_MEDIA_TYPE,Xe=pn==="application/xhtml+xml"?yu:Ca,m="ALLOWED_TAGS"in P?Te({},P.ALLOWED_TAGS,Xe):S,E="ALLOWED_ATTR"in P?Te({},P.ALLOWED_ATTR,Xe):O,yt="ALLOWED_NAMESPACES"in P?Te({},P.ALLOWED_NAMESPACES,yu):Mo,gn="ADD_URI_SAFE_ATTR"in P?Te(si(vt),P.ADD_URI_SAFE_ATTR,Xe):vt,ve="ADD_DATA_URI_TAGS"in P?Te(si(gt),P.ADD_DATA_URI_TAGS,Xe):gt,ce="FORBID_CONTENTS"in P?Te({},P.FORBID_CONTENTS,Xe):Re,Z="FORBID_TAGS"in P?Te({},P.FORBID_TAGS,Xe):{},Y="FORBID_ATTR"in P?Te({},P.FORBID_ATTR,Xe):{},J="USE_PROFILES"in P?P.USE_PROFILES:!1,ne=P.ALLOW_ARIA_ATTR!==!1,oe=P.ALLOW_DATA_ATTR!==!1,X=P.ALLOW_UNKNOWN_PROTOCOLS||!1,ye=P.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Ce=P.SAFE_FOR_TEMPLATES||!1,p=P.WHOLE_DOCUMENT||!1,x=P.RETURN_DOM||!1,_=P.RETURN_DOM_FRAGMENT||!1,H=P.RETURN_TRUSTED_TYPE||!1,F=P.FORCE_BODY||!1,G=P.SANITIZE_DOM!==!1,j=P.SANITIZE_NAMED_PROPS||!1,Q=P.KEEP_CONTENT!==!1,re=P.IN_PLACE||!1,h=P.ALLOWED_URI_REGEXP||h,Et=P.NAMESPACE||nt,k=P.CUSTOM_ELEMENT_HANDLING||{},P.CUSTOM_ELEMENT_HANDLING&&zv(P.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(k.tagNameCheck=P.CUSTOM_ELEMENT_HANDLING.tagNameCheck),P.CUSTOM_ELEMENT_HANDLING&&zv(P.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(k.attributeNameCheck=P.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),P.CUSTOM_ELEMENT_HANDLING&&typeof P.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(k.allowCustomizedBuiltInElements=P.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ce&&(oe=!1),_&&(x=!0),J&&(m=Te({},bn(Mg)),E=[],J.html===!0&&(Te(m,Og),Te(E,Ag)),J.svg===!0&&(Te(m,Su),Te(E,Tu),Te(E,Ra)),J.svgFilters===!0&&(Te(m,Ru),Te(E,Tu),Te(E,Ra)),J.mathMl===!0&&(Te(m,_u),Te(E,Ig),Te(E,Ra))),P.ADD_TAGS&&(m===S&&(m=si(m)),Te(m,P.ADD_TAGS,Xe)),P.ADD_ATTR&&(E===O&&(E=si(E)),Te(E,P.ADD_ATTR,Xe)),P.ADD_URI_SAFE_ATTR&&Te(gn,P.ADD_URI_SAFE_ATTR,Xe),P.FORBID_CONTENTS&&(ce===Re&&(ce=si(ce)),Te(ce,P.FORBID_CONTENTS,Xe)),Q&&(m["#text"]=!0),p&&Te(m,["html","head","body"]),m.table&&(Te(m,["tbody"]),delete Z.tbody),Mt&&Mt(P),Dn=P)},jv=Te({},["mi","mo","mn","ms","mtext"]),Uv=Te({},["foreignobject","desc","title","annotation-xml"]),GD=Te({},["title","style","font","a","script"]),hc=Te({},Su);Te(hc,Ru),Te(hc,ZE);var mf=Te({},_u);Te(mf,qE);var KD=function(P){var te=R(P);(!te||!te.tagName)&&(te={namespaceURI:Et,tagName:"template"});var ae=Ca(P.tagName),Ne=Ca(te.tagName);return yt[P.namespaceURI]?P.namespaceURI===Pe?te.namespaceURI===nt?ae==="svg":te.namespaceURI===st?ae==="svg"&&(Ne==="annotation-xml"||jv[Ne]):!!hc[ae]:P.namespaceURI===st?te.namespaceURI===nt?ae==="math":te.namespaceURI===Pe?ae==="math"&&Uv[Ne]:!!mf[ae]:P.namespaceURI===nt?te.namespaceURI===Pe&&!Uv[Ne]||te.namespaceURI===st&&!jv[Ne]?!1:!mf[ae]&&(GD[ae]||!hc[ae]):!!(pn==="application/xhtml+xml"&&yt[P.namespaceURI]):!1},xr=function(P){zo(e.removed,{element:P});try{P.parentNode.removeChild(P)}catch{try{P.outerHTML=I}catch{P.remove()}}},gf=function(P,te){try{zo(e.removed,{attribute:te.getAttributeNode(P),from:te})}catch{zo(e.removed,{attribute:null,from:te})}if(te.removeAttribute(P),P==="is"&&!E[P])if(x||_)try{xr(te)}catch{}else try{te.setAttribute(P,"")}catch{}},Yv=function(P){var te,ae;if(F)P="<remove></remove>"+P;else{var Ne=UE(P,/^[\r\n\t ]+/);ae=Ne&&Ne[0]}pn==="application/xhtml+xml"&&Et===nt&&(P='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+P+"</body></html>");var Gt=M?M.createHTML(P):P;if(Et===nt)try{te=new g().parseFromString(Gt,pn)}catch{}if(!te||!te.documentElement){te=N.createDocument(Et,"template",null);try{te.documentElement.innerHTML=qe?I:Gt}catch{}}var xt=te.body||te.documentElement;return P&&ae&&xt.insertBefore(r.createTextNode(ae),xt.childNodes[0]||null),Et===nt?q.call(te,p?"html":"body")[0]:p?te.documentElement:xt},Gv=function(P){return $.call(P.ownerDocument||P,P,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},ZD=function(P){return P instanceof d&&(typeof P.nodeName!="string"||typeof P.textContent!="string"||typeof P.removeChild!="function"||!(P.attributes instanceof u)||typeof P.removeAttribute!="function"||typeof P.setAttribute!="function"||typeof P.namespaceURI!="string"||typeof P.insertBefore!="function"||typeof P.hasChildNodes!="function")},Zs=function(P){return Ar(s)==="object"?P instanceof s:P&&Ar(P)==="object"&&typeof P.nodeType=="number"&&typeof P.nodeName=="string"},Or=function(P,te,ae){B[P]&&jE(B[P],function(Ne){Ne.call(e,te,ae,Dn)})},Kv=function(P){var te;if(Or("beforeSanitizeElements",P,null),ZD(P)||At(/[\u0080-\uFFFF]/,P.nodeName))return xr(P),!0;var ae=Xe(P.nodeName);if(Or("uponSanitizeElement",P,{tagName:ae,allowedTags:m}),P.hasChildNodes()&&!Zs(P.firstElementChild)&&(!Zs(P.content)||!Zs(P.content.firstElementChild))&&At(/<[/\w]/g,P.innerHTML)&&At(/<[/\w]/g,P.textContent)||ae==="select"&&At(/<template/i,P.innerHTML))return xr(P),!0;if(!m[ae]||Z[ae]){if(!Z[ae]&&qv(ae)&&(k.tagNameCheck instanceof RegExp&&At(k.tagNameCheck,ae)||k.tagNameCheck instanceof Function&&k.tagNameCheck(ae)))return!1;if(Q&&!ce[ae]){var Ne=R(P)||P.parentNode,Gt=v(P)||P.childNodes;if(Gt&&Ne)for(var xt=Gt.length,Ct=xt-1;Ct>=0;--Ct)Ne.insertBefore(w(Gt[Ct],!0),y(P))}return xr(P),!0}return P instanceof a&&!KD(P)||(ae==="noscript"||ae==="noembed"||ae==="noframes")&&At(/<\/no(script|embed|frames)/i,P.innerHTML)?(xr(P),!0):(Ce&&P.nodeType===3&&(te=P.textContent,te=yn(te,C," "),te=yn(te,z," "),te=yn(te,fe," "),P.textContent!==te&&(zo(e.removed,{element:P.cloneNode()}),P.textContent=te)),Or("afterSanitizeElements",P,null),!1)},Zv=function(P,te,ae){if(G&&(te==="id"||te==="name")&&(ae in r||ae in YD))return!1;if(!(oe&&!Y[te]&&At(K,te))){if(!(ne&&At(ie,te))){if(!E[te]||Y[te]){if(!(qv(P)&&(k.tagNameCheck instanceof RegExp&&At(k.tagNameCheck,P)||k.tagNameCheck instanceof Function&&k.tagNameCheck(P))&&(k.attributeNameCheck instanceof RegExp&&At(k.attributeNameCheck,te)||k.attributeNameCheck instanceof Function&&k.attributeNameCheck(te))||te==="is"&&k.allowCustomizedBuiltInElements&&(k.tagNameCheck instanceof RegExp&&At(k.tagNameCheck,ae)||k.tagNameCheck instanceof Function&&k.tagNameCheck(ae))))return!1}else if(!gn[te]){if(!At(h,yn(ae,me,""))){if(!((te==="src"||te==="xlink:href"||te==="href")&&P!=="script"&&YE(ae,"data:")===0&&ve[P])){if(!(X&&!At(U,yn(ae,me,"")))){if(ae)return!1}}}}}}return!0},qv=function(P){return P.indexOf("-")>0},Xv=function(P){var te,ae,Ne,Gt;Or("beforeSanitizeAttributes",P,null);var xt=P.attributes;if(xt){var Ct={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:E};for(Gt=xt.length;Gt--;){te=xt[Gt];var dc=te,pt=dc.name,pf=dc.namespaceURI;if(ae=pt==="value"?te.value:GE(te.value),Ne=Xe(pt),Ct.attrName=Ne,Ct.attrValue=ae,Ct.keepAttr=!0,Ct.forceKeepAttr=void 0,Or("uponSanitizeAttribute",P,Ct),ae=Ct.attrValue,!Ct.forceKeepAttr&&(gf(pt,P),!!Ct.keepAttr)){if(!ye&&At(/\/>/i,ae)){gf(pt,P);continue}Ce&&(ae=yn(ae,C," "),ae=yn(ae,z," "),ae=yn(ae,fe," "));var Qv=Xe(P.nodeName);if(Zv(Qv,Ne,ae)){if(j&&(Ne==="id"||Ne==="name")&&(gf(pt,P),ae=D+ae),M&&Ar(f)==="object"&&typeof f.getAttributeType=="function"&&!pf)switch(f.getAttributeType(Qv,Ne)){case"TrustedHTML":{ae=M.createHTML(ae);break}case"TrustedScriptURL":{ae=M.createScriptURL(ae);break}}try{pf?P.setAttributeNS(pf,pt,ae):P.setAttribute(pt,ae),xg(e.removed)}catch{}}}}Or("afterSanitizeAttributes",P,null)}},qD=function ge(P){var te,ae=Gv(P);for(Or("beforeSanitizeShadowDOM",P,null);te=ae.nextNode();)Or("uponSanitizeShadowNode",te,null),!Kv(te)&&(te.content instanceof i&&ge(te.content),Xv(te));Or("afterSanitizeShadowDOM",P,null)};return e.sanitize=function(ge){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},te,ae,Ne,Gt,xt;if(qe=!ge,qe&&(ge="<!-->"),typeof ge!="string"&&!Zs(ge))if(typeof ge.toString=="function"){if(ge=ge.toString(),typeof ge!="string")throw Cu("dirty is not a string, aborting")}else throw Cu("toString is not a function");if(!e.isSupported){if(Ar(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof ge=="string")return t.toStaticHTML(ge);if(Zs(ge))return t.toStaticHTML(ge.outerHTML)}return ge}if(V||ff(P),e.removed=[],typeof ge=="string"&&(re=!1),re){if(ge.nodeName){var Ct=Xe(ge.nodeName);if(!m[Ct]||Z[Ct])throw Cu("root node is forbidden and cannot be sanitized in-place")}}else if(ge instanceof s)te=Yv("<!---->"),ae=te.ownerDocument.importNode(ge,!0),ae.nodeType===1&&ae.nodeName==="BODY"||ae.nodeName==="HTML"?te=ae:te.appendChild(ae);else{if(!x&&!Ce&&!p&&ge.indexOf("<")===-1)return M&&H?M.createHTML(ge):ge;if(te=Yv(ge),!te)return x?null:H?I:""}te&&F&&xr(te.firstChild);for(var dc=Gv(re?ge:te);Ne=dc.nextNode();)Ne.nodeType===3&&Ne===Gt||Kv(Ne)||(Ne.content instanceof i&&qD(Ne.content),Xv(Ne),Gt=Ne);if(Gt=null,re)return ge;if(x){if(_)for(xt=W.call(te.ownerDocument);te.firstChild;)xt.appendChild(te.firstChild);else xt=te;return(E.shadowroot||E.shadowrootmod)&&(xt=ue.call(n,xt,!0)),xt}var pt=p?te.outerHTML:te.innerHTML;return p&&m["!doctype"]&&te.ownerDocument&&te.ownerDocument.doctype&&te.ownerDocument.doctype.name&&At(ox,te.ownerDocument.doctype.name)&&(pt="<!DOCTYPE "+te.ownerDocument.doctype.name+`>
`+pt),Ce&&(pt=yn(pt,C," "),pt=yn(pt,z," "),pt=yn(pt,fe," ")),M&&H?M.createHTML(pt):pt},e.setConfig=function(ge){ff(ge),V=!0},e.clearConfig=function(){Dn=null,V=!1},e.isValidAttribute=function(ge,P,te){Dn||ff({});var ae=Xe(ge),Ne=Xe(P);return Zv(ae,Ne,te)},e.addHook=function(ge,P){typeof P=="function"&&(B[ge]=B[ge]||[],zo(B[ge],P))},e.removeHook=function(ge){if(B[ge])return xg(B[ge])},e.removeHooks=function(ge){B[ge]&&(B[ge]=[])},e.removeAllHooks=function(){B={}},e}var lx=Hg();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var kg;function se(){return kg.apply(null,arguments)}function cx(t){kg=t}function Cn(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function ai(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function He(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Eu(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(He(t,e))return!1;return!0}function Lt(t){return t===void 0}function or(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function jo(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function Pg(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function Ir(t,e){for(var n in e)He(e,n)&&(t[n]=e[n]);return He(e,"toString")&&(t.toString=e.toString),He(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Un(t,e,n,r){return ap(t,e,n,r,!0).utc()}function ux(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function _e(t){return t._pf==null&&(t._pf=ux()),t._pf}var xu;Array.prototype.some?xu=Array.prototype.some:xu=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function Ou(t){var e=null,n=!1,r=t._d&&!isNaN(t._d.getTime());if(r&&(e=_e(t),n=xu.call(e.parsedDateParts,function(i){return i!=null}),r=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r;return t._isValid}function _a(t){var e=Un(NaN);return t!=null?Ir(_e(e),t):_e(e).userInvalidated=!0,e}var Ng=se.momentProperties=[],Mu=!1;function Au(t,e){var n,r,i,o=Ng.length;if(Lt(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Lt(e._i)||(t._i=e._i),Lt(e._f)||(t._f=e._f),Lt(e._l)||(t._l=e._l),Lt(e._strict)||(t._strict=e._strict),Lt(e._tzm)||(t._tzm=e._tzm),Lt(e._isUTC)||(t._isUTC=e._isUTC),Lt(e._offset)||(t._offset=e._offset),Lt(e._pf)||(t._pf=_e(e)),Lt(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=Ng[n],i=e[r],Lt(i)||(t[r]=i);return t}function Uo(t){Au(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Mu===!1&&(Mu=!0,se.updateOffset(this),Mu=!1)}function Sn(t){return t instanceof Uo||t!=null&&t._isAMomentObject!=null}function Dg(t){se.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function rn(t,e){var n=!0;return Ir(function(){if(se.deprecationHandler!=null&&se.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])He(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}Dg(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var Lg={};function Fg(t,e){se.deprecationHandler!=null&&se.deprecationHandler(t,e),Lg[t]||(Dg(e),Lg[t]=!0)}se.suppressDeprecationWarnings=!1,se.deprecationHandler=null;function Yn(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function hx(t){var e,n;for(n in t)He(t,n)&&(e=t[n],Yn(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function Iu(t,e){var n=Ir({},t),r;for(r in e)He(e,r)&&(ai(t[r])&&ai(e[r])?(n[r]={},Ir(n[r],t[r]),Ir(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)He(t,r)&&!He(e,r)&&ai(t[r])&&(n[r]=Ir({},n[r]));return n}function Hu(t){t!=null&&this.set(t)}var ku;Object.keys?ku=Object.keys:ku=function(t){var e,n=[];for(e in t)He(t,e)&&n.push(e);return n};var dx={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function fx(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return Yn(r)?r.call(e,n):r}function Gn(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var Pu=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Ta=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Nu={},zi={};function pe(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(zi[t]=i),e&&(zi[e[0]]=function(){return Gn(i.apply(this,arguments),e[1],e[2])}),n&&(zi[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function mx(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function gx(t){var e=t.match(Pu),n,r;for(n=0,r=e.length;n<r;n++)zi[e[n]]?e[n]=zi[e[n]]:e[n]=mx(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=Yn(e[s])?e[s].call(i,t):e[s];return o}}function Ea(t,e){return t.isValid()?(e=$g(e,t.localeData()),Nu[e]=Nu[e]||gx(e),Nu[e](t)):t.localeData().invalidDate()}function $g(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(Ta.lastIndex=0;n>=0&&Ta.test(t);)t=t.replace(Ta,r),Ta.lastIndex=0,n-=1;return t}var px={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function wx(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(Pu).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var bx="Invalid date";function vx(){return this._invalidDate}var yx="%d",Cx=/\d{1,2}/;function Sx(t){return this._ordinal.replace("%d",t)}var Rx={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function _x(t,e,n,r){var i=this._relativeTime[n];return Yn(i)?i(t,e,n,r):i.replace(/%d/i,t)}function Tx(t,e){var n=this._relativeTime[t>0?"future":"past"];return Yn(n)?n(e):n.replace(/%s/i,e)}var Wg={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function on(t){return typeof t=="string"?Wg[t]||Wg[t.toLowerCase()]:void 0}function Du(t){var e={},n,r;for(r in t)He(t,r)&&(n=on(r),n&&(e[n]=t[r]));return e}var Ex={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function xx(t){var e=[],n;for(n in t)He(t,n)&&e.push({unit:n,priority:Ex[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}var Bg=/\d/,Zt=/\d\d/,Vg=/\d{3}/,Lu=/\d{4}/,xa=/[+-]?\d{6}/,We=/\d\d?/,zg=/\d\d\d\d?/,jg=/\d\d\d\d\d\d?/,Oa=/\d{1,3}/,Fu=/\d{1,4}/,Ma=/[+-]?\d{1,6}/,ji=/\d+/,Aa=/[+-]?\d+/,Ox=/Z|[+-]\d\d:?\d\d/gi,Ia=/Z|[+-]\d\d(?::?\d\d)?/gi,Mx=/[+-]?\d+(\.\d{1,3})?/,Yo=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Ui=/^[1-9]\d?/,$u=/^([1-9]\d|\d)/,Ha;Ha={};function le(t,e,n){Ha[t]=Yn(e)?e:function(r,i){return r&&n?n:e}}function Ax(t,e){return He(Ha,t)?Ha[t](e._strict,e._locale):new RegExp(Ix(t))}function Ix(t){return sr(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function sr(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function sn(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Oe(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=sn(e)),n}var Wu={};function De(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),or(e)&&(r=function(o,s){s[e]=Oe(o)}),i=t.length,n=0;n<i;n++)Wu[t[n]]=r}function Go(t,e){De(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function Hx(t,e,n){e!=null&&He(Wu,t)&&Wu[t](e,n._a,n,t)}function ka(t){return t%4===0&&t%100!==0||t%400===0}var St=0,ar=1,Kn=2,at=3,Rn=4,lr=5,li=6,kx=7,Px=8;pe("Y",0,0,function(){var t=this.year();return t<=9999?Gn(t,4):"+"+t}),pe(0,["YY",2],0,function(){return this.year()%100}),pe(0,["YYYY",4],0,"year"),pe(0,["YYYYY",5],0,"year"),pe(0,["YYYYYY",6,!0],0,"year"),le("Y",Aa),le("YY",We,Zt),le("YYYY",Fu,Lu),le("YYYYY",Ma,xa),le("YYYYYY",Ma,xa),De(["YYYYY","YYYYYY"],St),De("YYYY",function(t,e){e[St]=t.length===2?se.parseTwoDigitYear(t):Oe(t)}),De("YY",function(t,e){e[St]=se.parseTwoDigitYear(t)}),De("Y",function(t,e){e[St]=parseInt(t,10)});function Ko(t){return ka(t)?366:365}se.parseTwoDigitYear=function(t){return Oe(t)+(Oe(t)>68?1900:2e3)};var Ug=Yi("FullYear",!0);function Nx(){return ka(this.year())}function Yi(t,e){return function(n){return n!=null?(Yg(this,t,n),se.updateOffset(this,e),this):Zo(this,t)}}function Zo(t,e){if(!t.isValid())return NaN;var n=t._d,r=t._isUTC;switch(e){case"Milliseconds":return r?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return r?n.getUTCSeconds():n.getSeconds();case"Minutes":return r?n.getUTCMinutes():n.getMinutes();case"Hours":return r?n.getUTCHours():n.getHours();case"Date":return r?n.getUTCDate():n.getDate();case"Day":return r?n.getUTCDay():n.getDay();case"Month":return r?n.getUTCMonth():n.getMonth();case"FullYear":return r?n.getUTCFullYear():n.getFullYear();default:return NaN}}function Yg(t,e,n){var r,i,o,s,a;if(!(!t.isValid()||isNaN(n))){switch(r=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?r.setUTCMilliseconds(n):r.setMilliseconds(n));case"Seconds":return void(i?r.setUTCSeconds(n):r.setSeconds(n));case"Minutes":return void(i?r.setUTCMinutes(n):r.setMinutes(n));case"Hours":return void(i?r.setUTCHours(n):r.setHours(n));case"Date":return void(i?r.setUTCDate(n):r.setDate(n));case"FullYear":break;default:return}o=n,s=t.month(),a=t.date(),a=a===29&&s===1&&!ka(o)?28:a,i?r.setUTCFullYear(o,s,a):r.setFullYear(o,s,a)}}function Dx(t){return t=on(t),Yn(this[t])?this[t]():this}function Lx(t,e){if(typeof t=="object"){t=Du(t);var n=xx(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=on(t),Yn(this[t]))return this[t](e);return this}function Fx(t,e){return(t%e+e)%e}var Je;Array.prototype.indexOf?Je=Array.prototype.indexOf:Je=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function Bu(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=Fx(e,12);return t+=(e-n)/12,n===1?ka(t)?29:28:31-n%7%2}pe("M",["MM",2],"Mo",function(){return this.month()+1}),pe("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)}),pe("MMMM",0,0,function(t){return this.localeData().months(this,t)}),le("M",We,Ui),le("MM",We,Zt),le("MMM",function(t,e){return e.monthsShortRegex(t)}),le("MMMM",function(t,e){return e.monthsRegex(t)}),De(["M","MM"],function(t,e){e[ar]=Oe(t)-1}),De(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[ar]=i:_e(n).invalidMonth=t});var $x="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Gg="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Kg=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Wx=Yo,Bx=Yo;function Vx(t,e){return t?Cn(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||Kg).test(e)?"format":"standalone"][t.month()]:Cn(this._months)?this._months:this._months.standalone}function zx(t,e){return t?Cn(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[Kg.test(e)?"format":"standalone"][t.month()]:Cn(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function jx(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=Un([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=Je.call(this._shortMonthsParse,s),i!==-1?i:null):(i=Je.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=Je.call(this._shortMonthsParse,s),i!==-1?i:(i=Je.call(this._longMonthsParse,s),i!==-1?i:null)):(i=Je.call(this._longMonthsParse,s),i!==-1?i:(i=Je.call(this._shortMonthsParse,s),i!==-1?i:null))}function Ux(t,e,n){var r,i,o;if(this._monthsParseExact)return jx.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=Un([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function Zg(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=Oe(e);else if(e=t.localeData().monthsParse(e),!or(e))return t}var n=e,r=t.date();return r=r<29?r:Math.min(r,Bu(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,r):t._d.setMonth(n,r),t}function qg(t){return t!=null?(Zg(this,t),se.updateOffset(this,!0),this):Zo(this,"Month")}function Yx(){return Bu(this.year(),this.month())}function Gx(t){return this._monthsParseExact?(He(this,"_monthsRegex")||Xg.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(He(this,"_monthsShortRegex")||(this._monthsShortRegex=Wx),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function Kx(t){return this._monthsParseExact?(He(this,"_monthsRegex")||Xg.call(this),t?this._monthsStrictRegex:this._monthsRegex):(He(this,"_monthsRegex")||(this._monthsRegex=Bx),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function Xg(){function t(l,c){return c.length-l.length}var e=[],n=[],r=[],i,o,s,a;for(i=0;i<12;i++)o=Un([2e3,i]),s=sr(this.monthsShort(o,"")),a=sr(this.months(o,"")),e.push(s),n.push(a),r.push(a),r.push(s);e.sort(t),n.sort(t),r.sort(t),this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Zx(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function qo(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Pa(t,e,n){var r=7+e-n,i=(7+qo(t,0,r).getUTCDay()-e)%7;return-i+r-1}function Qg(t,e,n,r,i){var o=(7+n-r)%7,s=Pa(t,r,i),a=1+7*(e-1)+o+s,l,c;return a<=0?(l=t-1,c=Ko(l)+a):a>Ko(t)?(l=t+1,c=a-Ko(t)):(l=t,c=a),{year:l,dayOfYear:c}}function Xo(t,e,n){var r=Pa(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+cr(s,e,n)):i>cr(t.year(),e,n)?(o=i-cr(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function cr(t,e,n){var r=Pa(t,e,n),i=Pa(t+1,e,n);return(Ko(t)-r+i)/7}pe("w",["ww",2],"wo","week"),pe("W",["WW",2],"Wo","isoWeek"),le("w",We,Ui),le("ww",We,Zt),le("W",We,Ui),le("WW",We,Zt),Go(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=Oe(t)});function qx(t){return Xo(t,this._week.dow,this._week.doy).week}var Xx={dow:0,doy:6};function Qx(){return this._week.dow}function Jx(){return this._week.doy}function e3(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function t3(t){var e=Xo(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}pe("d",0,"do","day"),pe("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)}),pe("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)}),pe("dddd",0,0,function(t){return this.localeData().weekdays(this,t)}),pe("e",0,0,"weekday"),pe("E",0,0,"isoWeekday"),le("d",We),le("e",We),le("E",We),le("dd",function(t,e){return e.weekdaysMinRegex(t)}),le("ddd",function(t,e){return e.weekdaysShortRegex(t)}),le("dddd",function(t,e){return e.weekdaysRegex(t)}),Go(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:_e(n).invalidWeekday=t}),Go(["d","e","E"],function(t,e,n,r){e[r]=Oe(t)});function n3(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function r3(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function Vu(t,e){return t.slice(e,7).concat(t.slice(0,e))}var i3="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Jg="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),o3="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),s3=Yo,a3=Yo,l3=Yo;function c3(t,e){var n=Cn(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?Vu(n,this._week.dow):t?n[t.day()]:n}function u3(t){return t===!0?Vu(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function h3(t){return t===!0?Vu(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function d3(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=Un([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=Je.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=Je.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=Je.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=Je.call(this._weekdaysParse,s),i!==-1||(i=Je.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=Je.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=Je.call(this._shortWeekdaysParse,s),i!==-1||(i=Je.call(this._weekdaysParse,s),i!==-1)?i:(i=Je.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=Je.call(this._minWeekdaysParse,s),i!==-1||(i=Je.call(this._weekdaysParse,s),i!==-1)?i:(i=Je.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function f3(t,e,n){var r,i,o;if(this._weekdaysParseExact)return d3.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=Un([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function m3(t){if(!this.isValid())return t!=null?this:NaN;var e=Zo(this,"Day");return t!=null?(t=n3(t,this.localeData()),this.add(t-e,"d")):e}function g3(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function p3(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=r3(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function w3(t){return this._weekdaysParseExact?(He(this,"_weekdaysRegex")||zu.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(He(this,"_weekdaysRegex")||(this._weekdaysRegex=s3),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function b3(t){return this._weekdaysParseExact?(He(this,"_weekdaysRegex")||zu.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(He(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=a3),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function v3(t){return this._weekdaysParseExact?(He(this,"_weekdaysRegex")||zu.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(He(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=l3),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function zu(){function t(u,d){return d.length-u.length}var e=[],n=[],r=[],i=[],o,s,a,l,c;for(o=0;o<7;o++)s=Un([2e3,1]).day(o),a=sr(this.weekdaysMin(s,"")),l=sr(this.weekdaysShort(s,"")),c=sr(this.weekdays(s,"")),e.push(a),n.push(l),r.push(c),i.push(a),i.push(l),i.push(c);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function ju(){return this.hours()%12||12}function y3(){return this.hours()||24}pe("H",["HH",2],0,"hour"),pe("h",["hh",2],0,ju),pe("k",["kk",2],0,y3),pe("hmm",0,0,function(){return""+ju.apply(this)+Gn(this.minutes(),2)}),pe("hmmss",0,0,function(){return""+ju.apply(this)+Gn(this.minutes(),2)+Gn(this.seconds(),2)}),pe("Hmm",0,0,function(){return""+this.hours()+Gn(this.minutes(),2)}),pe("Hmmss",0,0,function(){return""+this.hours()+Gn(this.minutes(),2)+Gn(this.seconds(),2)});function ep(t,e){pe(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}ep("a",!0),ep("A",!1);function tp(t,e){return e._meridiemParse}le("a",tp),le("A",tp),le("H",We,$u),le("h",We,Ui),le("k",We,Ui),le("HH",We,Zt),le("hh",We,Zt),le("kk",We,Zt),le("hmm",zg),le("hmmss",jg),le("Hmm",zg),le("Hmmss",jg),De(["H","HH"],at),De(["k","kk"],function(t,e,n){var r=Oe(t);e[at]=r===24?0:r}),De(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t}),De(["h","hh"],function(t,e,n){e[at]=Oe(t),_e(n).bigHour=!0}),De("hmm",function(t,e,n){var r=t.length-2;e[at]=Oe(t.substr(0,r)),e[Rn]=Oe(t.substr(r)),_e(n).bigHour=!0}),De("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[at]=Oe(t.substr(0,r)),e[Rn]=Oe(t.substr(r,2)),e[lr]=Oe(t.substr(i)),_e(n).bigHour=!0}),De("Hmm",function(t,e,n){var r=t.length-2;e[at]=Oe(t.substr(0,r)),e[Rn]=Oe(t.substr(r))}),De("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[at]=Oe(t.substr(0,r)),e[Rn]=Oe(t.substr(r,2)),e[lr]=Oe(t.substr(i))});function C3(t){return(t+"").toLowerCase().charAt(0)==="p"}var S3=/[ap]\.?m?\.?/i,R3=Yi("Hours",!0);function _3(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var np={calendar:dx,longDateFormat:px,invalidDate:bx,ordinal:yx,dayOfMonthOrdinalParse:Cx,relativeTime:Rx,months:$x,monthsShort:Gg,week:Xx,weekdays:i3,weekdaysMin:o3,weekdaysShort:Jg,meridiemParse:S3},Ue={},Qo={},Jo;function T3(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function rp(t){return t&&t.toLowerCase().replace("_","-")}function E3(t){for(var e=0,n,r,i,o;e<t.length;){for(o=rp(t[e]).split("-"),n=o.length,r=rp(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=Na(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&T3(o,r)>=n-1)break;n--}e++}return Jo}function x3(t){return!!(t&&t.match("^[^/\\\\]*$"))}function Na(t){var e=null,n;if(Ue[t]===void 0&&typeof module<"u"&&module&&module.exports&&x3(t))try{e=Jo._abbr,n=require,n("./locale/"+t),Hr(e)}catch{Ue[t]=null}return Ue[t]}function Hr(t,e){var n;return t&&(Lt(e)?n=ur(t):n=Uu(t,e),n?Jo=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Jo._abbr}function Uu(t,e){if(e!==null){var n,r=np;if(e.abbr=t,Ue[t]!=null)Fg("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=Ue[t]._config;else if(e.parentLocale!=null)if(Ue[e.parentLocale]!=null)r=Ue[e.parentLocale]._config;else if(n=Na(e.parentLocale),n!=null)r=n._config;else return Qo[e.parentLocale]||(Qo[e.parentLocale]=[]),Qo[e.parentLocale].push({name:t,config:e}),null;return Ue[t]=new Hu(Iu(r,e)),Qo[t]&&Qo[t].forEach(function(i){Uu(i.name,i.config)}),Hr(t),Ue[t]}else return delete Ue[t],null}function O3(t,e){if(e!=null){var n,r,i=np;Ue[t]!=null&&Ue[t].parentLocale!=null?Ue[t].set(Iu(Ue[t]._config,e)):(r=Na(t),r!=null&&(i=r._config),e=Iu(i,e),r==null&&(e.abbr=t),n=new Hu(e),n.parentLocale=Ue[t],Ue[t]=n),Hr(t)}else Ue[t]!=null&&(Ue[t].parentLocale!=null?(Ue[t]=Ue[t].parentLocale,t===Hr()&&Hr(t)):Ue[t]!=null&&delete Ue[t]);return Ue[t]}function ur(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Jo;if(!Cn(t)){if(e=Na(t),e)return e;t=[t]}return E3(t)}function M3(){return ku(Ue)}function Yu(t){var e,n=t._a;return n&&_e(t).overflow===-2&&(e=n[ar]<0||n[ar]>11?ar:n[Kn]<1||n[Kn]>Bu(n[St],n[ar])?Kn:n[at]<0||n[at]>24||n[at]===24&&(n[Rn]!==0||n[lr]!==0||n[li]!==0)?at:n[Rn]<0||n[Rn]>59?Rn:n[lr]<0||n[lr]>59?lr:n[li]<0||n[li]>999?li:-1,_e(t)._overflowDayOfYear&&(e<St||e>Kn)&&(e=Kn),_e(t)._overflowWeeks&&e===-1&&(e=kx),_e(t)._overflowWeekday&&e===-1&&(e=Px),_e(t).overflow=e),t}var A3=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,I3=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,H3=/Z|[+-]\d\d(?::?\d\d)?/,Da=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Gu=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],k3=/^\/?Date\((-?\d+)/i,P3=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,N3={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function ip(t){var e,n,r=t._i,i=A3.exec(r)||I3.exec(r),o,s,a,l,c=Da.length,u=Gu.length;if(i){for(_e(t).iso=!0,e=0,n=c;e<n;e++)if(Da[e][1].exec(i[1])){s=Da[e][0],o=Da[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=u;e<n;e++)if(Gu[e][1].exec(i[3])){a=(i[2]||" ")+Gu[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(H3.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),Zu(t)}else t._isValid=!1}function D3(t,e,n,r,i,o){var s=[L3(t),Gg.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function L3(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function F3(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function $3(t,e,n){if(t){var r=Jg.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return _e(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function W3(t,e,n){if(t)return N3[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function op(t){var e=P3.exec(F3(t._i)),n;if(e){if(n=D3(e[4],e[3],e[2],e[5],e[6],e[7]),!$3(e[1],n,t))return;t._a=n,t._tzm=W3(e[8],e[9],e[10]),t._d=qo.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),_e(t).rfc2822=!0}else t._isValid=!1}function B3(t){var e=k3.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(ip(t),t._isValid===!1)delete t._isValid;else return;if(op(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:se.createFromInputFallback(t)}se.createFromInputFallback=rn("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function Gi(t,e,n){return t??e??n}function V3(t){var e=new Date(se.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function Ku(t){var e,n,r=[],i,o,s;if(!t._d){for(i=V3(t),t._w&&t._a[Kn]==null&&t._a[ar]==null&&z3(t),t._dayOfYear!=null&&(s=Gi(t._a[St],i[St]),(t._dayOfYear>Ko(s)||t._dayOfYear===0)&&(_e(t)._overflowDayOfYear=!0),n=qo(s,0,t._dayOfYear),t._a[ar]=n.getUTCMonth(),t._a[Kn]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[at]===24&&t._a[Rn]===0&&t._a[lr]===0&&t._a[li]===0&&(t._nextDay=!0,t._a[at]=0),t._d=(t._useUTC?qo:Zx).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[at]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(_e(t).weekdayMismatch=!0)}}function z3(t){var e,n,r,i,o,s,a,l,c;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=Gi(e.GG,t._a[St],Xo(Be(),1,4).year),r=Gi(e.W,1),i=Gi(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,c=Xo(Be(),o,s),n=Gi(e.gg,t._a[St],c.year),r=Gi(e.w,c.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>cr(n,o,s)?_e(t)._overflowWeeks=!0:l!=null?_e(t)._overflowWeekday=!0:(a=Qg(n,r,i,o,s),t._a[St]=a.year,t._dayOfYear=a.dayOfYear)}se.ISO_8601=function(){},se.RFC_2822=function(){};function Zu(t){if(t._f===se.ISO_8601){ip(t);return}if(t._f===se.RFC_2822){op(t);return}t._a=[],_e(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,c,u;for(i=$g(t._f,t._locale).match(Pu)||[],u=i.length,n=0;n<u;n++)o=i[n],r=(e.match(Ax(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&_e(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),zi[o]?(r?_e(t).empty=!1:_e(t).unusedTokens.push(o),Hx(o,r,t)):t._strict&&!r&&_e(t).unusedTokens.push(o);_e(t).charsLeftOver=a-l,e.length>0&&_e(t).unusedInput.push(e),t._a[at]<=12&&_e(t).bigHour===!0&&t._a[at]>0&&(_e(t).bigHour=void 0),_e(t).parsedDateParts=t._a.slice(0),_e(t).meridiem=t._meridiem,t._a[at]=j3(t._locale,t._a[at],t._meridiem),c=_e(t).era,c!==null&&(t._a[St]=t._locale.erasConvertYear(c,t._a[St])),Ku(t),Yu(t)}function j3(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function U3(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){_e(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=Au({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],Zu(e),Ou(e)&&(s=!0),o+=_e(e).charsLeftOver,o+=_e(e).unusedTokens.length*10,_e(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));Ir(t,n||e)}function Y3(t){if(!t._d){var e=Du(t._i),n=e.day===void 0?e.date:e.day;t._a=Pg([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),Ku(t)}}function G3(t){var e=new Uo(Yu(sp(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function sp(t){var e=t._i,n=t._f;return t._locale=t._locale||ur(t._l),e===null||n===void 0&&e===""?_a({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),Sn(e)?new Uo(Yu(e)):(jo(e)?t._d=e:Cn(n)?U3(t):n?Zu(t):K3(t),Ou(t)||(t._d=null),t))}function K3(t){var e=t._i;Lt(e)?t._d=new Date(se.now()):jo(e)?t._d=new Date(e.valueOf()):typeof e=="string"?B3(t):Cn(e)?(t._a=Pg(e.slice(0),function(n){return parseInt(n,10)}),Ku(t)):ai(e)?Y3(t):or(e)?t._d=new Date(e):se.createFromInputFallback(t)}function ap(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(ai(t)&&Eu(t)||Cn(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,G3(o)}function Be(t,e,n,r){return ap(t,e,n,r,!1)}var Z3=rn("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Be.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:_a()}),q3=rn("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Be.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:_a()});function lp(t,e){var n,r;if(e.length===1&&Cn(e[0])&&(e=e[0]),!e.length)return Be();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function X3(){var t=[].slice.call(arguments,0);return lp("isBefore",t)}function Q3(){var t=[].slice.call(arguments,0);return lp("isAfter",t)}var J3=function(){return Date.now?Date.now():+new Date},es=["year","quarter","month","week","day","hour","minute","second","millisecond"];function eO(t){var e,n=!1,r,i=es.length;for(e in t)if(He(t,e)&&!(Je.call(es,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[es[r]]){if(n)return!1;parseFloat(t[es[r]])!==Oe(t[es[r]])&&(n=!0)}return!0}function tO(){return this._isValid}function nO(){return _n(NaN)}function La(t){var e=Du(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,c=e.second||0,u=e.millisecond||0;this._isValid=eO(e),this._milliseconds=+u+c*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=ur(),this._bubble()}function Fa(t){return t instanceof La}function qu(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function rO(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)Oe(t[s])!==Oe(e[s])&&o++;return o+i}function cp(t,e){pe(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+Gn(~~(n/60),2)+e+Gn(~~n%60,2)})}cp("Z",":"),cp("ZZ",""),le("Z",Ia),le("ZZ",Ia),De(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=Xu(Ia,t)});var iO=/([\+\-]|\d\d)/gi;function Xu(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(iO)||["-",0,0],o=+(i[1]*60)+Oe(i[2]),o===0?0:i[0]==="+"?o:-o)}function Qu(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(Sn(t)||jo(t)?t.valueOf():Be(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),se.updateOffset(n,!1),n):Be(t).local()}function Ju(t){return-Math.round(t._d.getTimezoneOffset())}se.updateOffset=function(){};function oO(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=Xu(Ia,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=Ju(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?fp(this,_n(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,se.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:Ju(this)}function sO(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function aO(t){return this.utcOffset(0,t)}function lO(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(Ju(this),"m")),this}function cO(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=Xu(Ox,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function uO(t){return this.isValid()?(t=t?Be(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function hO(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function dO(){if(!Lt(this._isDSTShifted))return this._isDSTShifted;var t={},e;return Au(t,this),t=sp(t),t._a?(e=t._isUTC?Un(t._a):Be(t._a),this._isDSTShifted=this.isValid()&&rO(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function fO(){return this.isValid()?!this._isUTC:!1}function mO(){return this.isValid()?this._isUTC:!1}function up(){return this.isValid()?this._isUTC&&this._offset===0:!1}var gO=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,pO=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function _n(t,e){var n=t,r=null,i,o,s;return Fa(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:or(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=gO.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:Oe(r[Kn])*i,h:Oe(r[at])*i,m:Oe(r[Rn])*i,s:Oe(r[lr])*i,ms:Oe(qu(r[li]*1e3))*i}):(r=pO.exec(t))?(i=r[1]==="-"?-1:1,n={y:ci(r[2],i),M:ci(r[3],i),w:ci(r[4],i),d:ci(r[5],i),h:ci(r[6],i),m:ci(r[7],i),s:ci(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=wO(Be(n.from),Be(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new La(n),Fa(t)&&He(t,"_locale")&&(o._locale=t._locale),Fa(t)&&He(t,"_isValid")&&(o._isValid=t._isValid),o}_n.fn=La.prototype,_n.invalid=nO;function ci(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function hp(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function wO(t,e){var n;return t.isValid()&&e.isValid()?(e=Qu(e,t),t.isBefore(e)?n=hp(t,e):(n=hp(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function dp(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(Fg(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=_n(n,r),fp(this,i,t),this}}function fp(t,e,n,r){var i=e._milliseconds,o=qu(e._days),s=qu(e._months);t.isValid()&&(r=r??!0,s&&Zg(t,Zo(t,"Month")+s*n),o&&Yg(t,"Date",Zo(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&se.updateOffset(t,o||s))}var bO=dp(1,"add"),vO=dp(-1,"subtract");function mp(t){return typeof t=="string"||t instanceof String}function yO(t){return Sn(t)||jo(t)||mp(t)||or(t)||SO(t)||CO(t)||t===null||t===void 0}function CO(t){var e=ai(t)&&!Eu(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||He(t,o);return e&&n}function SO(t){var e=Cn(t),n=!1;return e&&(n=t.filter(function(r){return!or(r)&&mp(t)}).length===0),e&&n}function RO(t){var e=ai(t)&&!Eu(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||He(t,o);return e&&n}function _O(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function TO(t,e){arguments.length===1&&(arguments[0]?yO(arguments[0])?(t=arguments[0],e=void 0):RO(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Be(),r=Qu(n,this).startOf("day"),i=se.calendarFormat(this,r)||"sameElse",o=e&&(Yn(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,Be(n)))}function EO(){return new Uo(this)}function xO(t,e){var n=Sn(t)?t:Be(t);return this.isValid()&&n.isValid()?(e=on(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function OO(t,e){var n=Sn(t)?t:Be(t);return this.isValid()&&n.isValid()?(e=on(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function MO(t,e,n,r){var i=Sn(t)?t:Be(t),o=Sn(e)?e:Be(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function AO(t,e){var n=Sn(t)?t:Be(t),r;return this.isValid()&&n.isValid()?(e=on(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function IO(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function HO(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function kO(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=Qu(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=on(e),e){case"year":o=$a(this,r)/12;break;case"month":o=$a(this,r);break;case"quarter":o=$a(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:sn(o)}function $a(t,e){if(t.date()<e.date())return-$a(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}se.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",se.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function PO(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function NO(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?Ea(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Yn(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Ea(n,"Z")):Ea(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function DO(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function LO(t){t||(t=this.isUtc()?se.defaultFormatUtc:se.defaultFormat);var e=Ea(this,t);return this.localeData().postformat(e)}function FO(t,e){return this.isValid()&&(Sn(t)&&t.isValid()||Be(t).isValid())?_n({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function $O(t){return this.from(Be(),t)}function WO(t,e){return this.isValid()&&(Sn(t)&&t.isValid()||Be(t).isValid())?_n({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function BO(t){return this.to(Be(),t)}function gp(t){var e;return t===void 0?this._locale._abbr:(e=ur(t),e!=null&&(this._locale=e),this)}var pp=rn("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function wp(){return this._locale}var Wa=1e3,Ki=60*Wa,Ba=60*Ki,bp=(365*400+97)*24*Ba;function Zi(t,e){return(t%e+e)%e}function vp(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-bp:new Date(t,e,n).valueOf()}function yp(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-bp:Date.UTC(t,e,n)}function VO(t){var e,n;if(t=on(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?yp:vp,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Zi(e+(this._isUTC?0:this.utcOffset()*Ki),Ba);break;case"minute":e=this._d.valueOf(),e-=Zi(e,Ki);break;case"second":e=this._d.valueOf(),e-=Zi(e,Wa);break}return this._d.setTime(e),se.updateOffset(this,!0),this}function zO(t){var e,n;if(t=on(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?yp:vp,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Ba-Zi(e+(this._isUTC?0:this.utcOffset()*Ki),Ba)-1;break;case"minute":e=this._d.valueOf(),e+=Ki-Zi(e,Ki)-1;break;case"second":e=this._d.valueOf(),e+=Wa-Zi(e,Wa)-1;break}return this._d.setTime(e),se.updateOffset(this,!0),this}function jO(){return this._d.valueOf()-(this._offset||0)*6e4}function UO(){return Math.floor(this.valueOf()/1e3)}function YO(){return new Date(this.valueOf())}function GO(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function KO(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function ZO(){return this.isValid()?this.toISOString():null}function qO(){return Ou(this)}function XO(){return Ir({},_e(this))}function QO(){return _e(this).overflow}function JO(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}pe("N",0,0,"eraAbbr"),pe("NN",0,0,"eraAbbr"),pe("NNN",0,0,"eraAbbr"),pe("NNNN",0,0,"eraName"),pe("NNNNN",0,0,"eraNarrow"),pe("y",["y",1],"yo","eraYear"),pe("y",["yy",2],0,"eraYear"),pe("y",["yyy",3],0,"eraYear"),pe("y",["yyyy",4],0,"eraYear"),le("N",eh),le("NN",eh),le("NNN",eh),le("NNNN",u5),le("NNNNN",h5),De(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?_e(n).era=i:_e(n).invalidEra=t}),le("y",ji),le("yy",ji),le("yyy",ji),le("yyyy",ji),le("yo",d5),De(["y","yy","yyy","yyyy"],St),De(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[St]=n._locale.eraYearOrdinalParse(t,i):e[St]=parseInt(t,10)});function e5(t,e){var n,r,i,o=this._eras||ur("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=se(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=se(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function t5(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function n5(t,e){var n=t.since<=t.until?1:-1;return e===void 0?se(t.since).year():se(t.since).year()+(e-t.offset)*n}function r5(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function i5(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function o5(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function s5(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-se(i[t].since).year())*n+i[t].offset;return this.year()}function a5(t){return He(this,"_erasNameRegex")||th.call(this),t?this._erasNameRegex:this._erasRegex}function l5(t){return He(this,"_erasAbbrRegex")||th.call(this),t?this._erasAbbrRegex:this._erasRegex}function c5(t){return He(this,"_erasNarrowRegex")||th.call(this),t?this._erasNarrowRegex:this._erasRegex}function eh(t,e){return e.erasAbbrRegex(t)}function u5(t,e){return e.erasNameRegex(t)}function h5(t,e){return e.erasNarrowRegex(t)}function d5(t,e){return e._eraYearOrdinalRegex||ji}function th(){var t=[],e=[],n=[],r=[],i,o,s,a,l,c=this.eras();for(i=0,o=c.length;i<o;++i)s=sr(c[i].name),a=sr(c[i].abbr),l=sr(c[i].narrow),e.push(s),t.push(a),n.push(l),r.push(s),r.push(a),r.push(l);this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}pe(0,["gg",2],0,function(){return this.weekYear()%100}),pe(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Va(t,e){pe(0,[t,t.length],0,e)}Va("gggg","weekYear"),Va("ggggg","weekYear"),Va("GGGG","isoWeekYear"),Va("GGGGG","isoWeekYear"),le("G",Aa),le("g",Aa),le("GG",We,Zt),le("gg",We,Zt),le("GGGG",Fu,Lu),le("gggg",Fu,Lu),le("GGGGG",Ma,xa),le("ggggg",Ma,xa),Go(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=Oe(t)}),Go(["gg","GG"],function(t,e,n,r){e[r]=se.parseTwoDigitYear(t)});function f5(t){return Cp.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function m5(t){return Cp.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function g5(){return cr(this.year(),1,4)}function p5(){return cr(this.isoWeekYear(),1,4)}function w5(){var t=this.localeData()._week;return cr(this.year(),t.dow,t.doy)}function b5(){var t=this.localeData()._week;return cr(this.weekYear(),t.dow,t.doy)}function Cp(t,e,n,r,i){var o;return t==null?Xo(this,r,i).year:(o=cr(t,r,i),e>o&&(e=o),v5.call(this,t,e,n,r,i))}function v5(t,e,n,r,i){var o=Qg(t,e,n,r,i),s=qo(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}pe("Q",0,"Qo","quarter"),le("Q",Bg),De("Q",function(t,e){e[ar]=(Oe(t)-1)*3});function y5(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}pe("D",["DD",2],"Do","date"),le("D",We,Ui),le("DD",We,Zt),le("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient}),De(["D","DD"],Kn),De("Do",function(t,e){e[Kn]=Oe(t.match(We)[0])});var Sp=Yi("Date",!0);pe("DDD",["DDDD",3],"DDDo","dayOfYear"),le("DDD",Oa),le("DDDD",Vg),De(["DDD","DDDD"],function(t,e,n){n._dayOfYear=Oe(t)});function C5(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}pe("m",["mm",2],0,"minute"),le("m",We,$u),le("mm",We,Zt),De(["m","mm"],Rn);var S5=Yi("Minutes",!1);pe("s",["ss",2],0,"second"),le("s",We,$u),le("ss",We,Zt),De(["s","ss"],lr);var R5=Yi("Seconds",!1);pe("S",0,0,function(){return~~(this.millisecond()/100)}),pe(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),pe(0,["SSS",3],0,"millisecond"),pe(0,["SSSS",4],0,function(){return this.millisecond()*10}),pe(0,["SSSSS",5],0,function(){return this.millisecond()*100}),pe(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),pe(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),pe(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),pe(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),le("S",Oa,Bg),le("SS",Oa,Zt),le("SSS",Oa,Vg);var kr,Rp;for(kr="SSSS";kr.length<=9;kr+="S")le(kr,ji);function _5(t,e){e[li]=Oe(("0."+t)*1e3)}for(kr="S";kr.length<=9;kr+="S")De(kr,_5);Rp=Yi("Milliseconds",!1),pe("z",0,0,"zoneAbbr"),pe("zz",0,0,"zoneName");function T5(){return this._isUTC?"UTC":""}function E5(){return this._isUTC?"Coordinated Universal Time":""}var ee=Uo.prototype;ee.add=bO,ee.calendar=TO,ee.clone=EO,ee.diff=kO,ee.endOf=zO,ee.format=LO,ee.from=FO,ee.fromNow=$O,ee.to=WO,ee.toNow=BO,ee.get=Dx,ee.invalidAt=QO,ee.isAfter=xO,ee.isBefore=OO,ee.isBetween=MO,ee.isSame=AO,ee.isSameOrAfter=IO,ee.isSameOrBefore=HO,ee.isValid=qO,ee.lang=pp,ee.locale=gp,ee.localeData=wp,ee.max=q3,ee.min=Z3,ee.parsingFlags=XO,ee.set=Lx,ee.startOf=VO,ee.subtract=vO,ee.toArray=GO,ee.toObject=KO,ee.toDate=YO,ee.toISOString=NO,ee.inspect=DO,typeof Symbol<"u"&&Symbol.for!=null&&(ee[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),ee.toJSON=ZO,ee.toString=PO,ee.unix=UO,ee.valueOf=jO,ee.creationData=JO,ee.eraName=r5,ee.eraNarrow=i5,ee.eraAbbr=o5,ee.eraYear=s5,ee.year=Ug,ee.isLeapYear=Nx,ee.weekYear=f5,ee.isoWeekYear=m5,ee.quarter=ee.quarters=y5,ee.month=qg,ee.daysInMonth=Yx,ee.week=ee.weeks=e3,ee.isoWeek=ee.isoWeeks=t3,ee.weeksInYear=w5,ee.weeksInWeekYear=b5,ee.isoWeeksInYear=g5,ee.isoWeeksInISOWeekYear=p5,ee.date=Sp,ee.day=ee.days=m3,ee.weekday=g3,ee.isoWeekday=p3,ee.dayOfYear=C5,ee.hour=ee.hours=R3,ee.minute=ee.minutes=S5,ee.second=ee.seconds=R5,ee.millisecond=ee.milliseconds=Rp,ee.utcOffset=oO,ee.utc=aO,ee.local=lO,ee.parseZone=cO,ee.hasAlignedHourOffset=uO,ee.isDST=hO,ee.isLocal=fO,ee.isUtcOffset=mO,ee.isUtc=up,ee.isUTC=up,ee.zoneAbbr=T5,ee.zoneName=E5,ee.dates=rn("dates accessor is deprecated. Use date instead.",Sp),ee.months=rn("months accessor is deprecated. Use month instead",qg),ee.years=rn("years accessor is deprecated. Use year instead",Ug),ee.zone=rn("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",sO),ee.isDSTShifted=rn("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",dO);function x5(t){return Be(t*1e3)}function O5(){return Be.apply(null,arguments).parseZone()}function _p(t){return t}var ke=Hu.prototype;ke.calendar=fx,ke.longDateFormat=wx,ke.invalidDate=vx,ke.ordinal=Sx,ke.preparse=_p,ke.postformat=_p,ke.relativeTime=_x,ke.pastFuture=Tx,ke.set=hx,ke.eras=e5,ke.erasParse=t5,ke.erasConvertYear=n5,ke.erasAbbrRegex=l5,ke.erasNameRegex=a5,ke.erasNarrowRegex=c5,ke.months=Vx,ke.monthsShort=zx,ke.monthsParse=Ux,ke.monthsRegex=Kx,ke.monthsShortRegex=Gx,ke.week=qx,ke.firstDayOfYear=Jx,ke.firstDayOfWeek=Qx,ke.weekdays=c3,ke.weekdaysMin=h3,ke.weekdaysShort=u3,ke.weekdaysParse=f3,ke.weekdaysRegex=w3,ke.weekdaysShortRegex=b3,ke.weekdaysMinRegex=v3,ke.isPM=C3,ke.meridiem=_3;function za(t,e,n,r){var i=ur(),o=Un().set(r,e);return i[n](o,t)}function Tp(t,e,n){if(or(t)&&(e=t,t=void 0),t=t||"",e!=null)return za(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=za(t,r,n,"month");return i}function nh(t,e,n,r){typeof t=="boolean"?(or(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,or(e)&&(n=e,e=void 0),e=e||"");var i=ur(),o=t?i._week.dow:0,s,a=[];if(n!=null)return za(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=za(e,(s+o)%7,r,"day");return a}function M5(t,e){return Tp(t,e,"months")}function A5(t,e){return Tp(t,e,"monthsShort")}function I5(t,e,n){return nh(t,e,n,"weekdays")}function H5(t,e,n){return nh(t,e,n,"weekdaysShort")}function k5(t,e,n){return nh(t,e,n,"weekdaysMin")}Hr("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=Oe(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}}),se.lang=rn("moment.lang is deprecated. Use moment.locale instead.",Hr),se.langData=rn("moment.langData is deprecated. Use moment.localeData instead.",ur);var hr=Math.abs;function P5(){var t=this._data;return this._milliseconds=hr(this._milliseconds),this._days=hr(this._days),this._months=hr(this._months),t.milliseconds=hr(t.milliseconds),t.seconds=hr(t.seconds),t.minutes=hr(t.minutes),t.hours=hr(t.hours),t.months=hr(t.months),t.years=hr(t.years),this}function Ep(t,e,n,r){var i=_n(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function N5(t,e){return Ep(this,t,e,1)}function D5(t,e){return Ep(this,t,e,-1)}function xp(t){return t<0?Math.floor(t):Math.ceil(t)}function L5(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=xp(rh(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=sn(t/1e3),r.seconds=i%60,o=sn(i/60),r.minutes=o%60,s=sn(o/60),r.hours=s%24,e+=sn(s/24),l=sn(Op(e)),n+=l,e-=xp(rh(l)),a=sn(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function Op(t){return t*4800/146097}function rh(t){return t*146097/4800}function F5(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=on(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+Op(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(rh(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function dr(t){return function(){return this.as(t)}}var Mp=dr("ms"),$5=dr("s"),W5=dr("m"),B5=dr("h"),V5=dr("d"),z5=dr("w"),j5=dr("M"),U5=dr("Q"),Y5=dr("y"),G5=Mp;function K5(){return _n(this)}function Z5(t){return t=on(t),this.isValid()?this[t+"s"]():NaN}function ui(t){return function(){return this.isValid()?this._data[t]:NaN}}var q5=ui("milliseconds"),X5=ui("seconds"),Q5=ui("minutes"),J5=ui("hours"),eM=ui("days"),tM=ui("months"),nM=ui("years");function rM(){return sn(this.days()/7)}var fr=Math.round,qi={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function iM(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function oM(t,e,n,r){var i=_n(t).abs(),o=fr(i.as("s")),s=fr(i.as("m")),a=fr(i.as("h")),l=fr(i.as("d")),c=fr(i.as("M")),u=fr(i.as("w")),d=fr(i.as("y")),g=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(g=g||u<=1&&["w"]||u<n.w&&["ww",u]),g=g||c<=1&&["M"]||c<n.M&&["MM",c]||d<=1&&["y"]||["yy",d],g[2]=e,g[3]=+t>0,g[4]=r,iM.apply(null,g)}function sM(t){return t===void 0?fr:typeof t=="function"?(fr=t,!0):!1}function aM(t,e){return qi[t]===void 0?!1:e===void 0?qi[t]:(qi[t]=e,t==="s"&&(qi.ss=e-1),!0)}function lM(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=qi,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},qi,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=oM(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var ih=Math.abs;function Xi(t){return(t>0)-(t<0)||+t}function ja(){if(!this.isValid())return this.localeData().invalidDate();var t=ih(this._milliseconds)/1e3,e=ih(this._days),n=ih(this._months),r,i,o,s,a=this.asSeconds(),l,c,u,d;return a?(r=sn(t/60),i=sn(r/60),t%=60,r%=60,o=sn(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",c=Xi(this._months)!==Xi(a)?"-":"",u=Xi(this._days)!==Xi(a)?"-":"",d=Xi(this._milliseconds)!==Xi(a)?"-":"",l+"P"+(o?c+o+"Y":"")+(n?c+n+"M":"")+(e?u+e+"D":"")+(i||r||t?"T":"")+(i?d+i+"H":"")+(r?d+r+"M":"")+(t?d+s+"S":"")):"P0D"}var Ae=La.prototype;Ae.isValid=tO,Ae.abs=P5,Ae.add=N5,Ae.subtract=D5,Ae.as=F5,Ae.asMilliseconds=Mp,Ae.asSeconds=$5,Ae.asMinutes=W5,Ae.asHours=B5,Ae.asDays=V5,Ae.asWeeks=z5,Ae.asMonths=j5,Ae.asQuarters=U5,Ae.asYears=Y5,Ae.valueOf=G5,Ae._bubble=L5,Ae.clone=K5,Ae.get=Z5,Ae.milliseconds=q5,Ae.seconds=X5,Ae.minutes=Q5,Ae.hours=J5,Ae.days=eM,Ae.weeks=rM,Ae.months=tM,Ae.years=nM,Ae.humanize=lM,Ae.toISOString=ja,Ae.toString=ja,Ae.toJSON=ja,Ae.locale=gp,Ae.localeData=wp,Ae.toIsoString=rn("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",ja),Ae.lang=pp,pe("X",0,0,"unix"),pe("x",0,0,"valueOf"),le("x",Aa),le("X",Mx),De("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)}),De("x",function(t,e,n){n._d=new Date(Oe(t))});//! moment.js
se.version="2.30.1",cx(Be),se.fn=ee,se.min=X3,se.max=Q3,se.now=J3,se.utc=Un,se.unix=x5,se.months=M5,se.isDate=jo,se.locale=Hr,se.invalid=_a,se.duration=_n,se.isMoment=Sn,se.weekdays=I5,se.parseZone=O5,se.localeData=ur,se.isDuration=Fa,se.monthsShort=A5,se.weekdaysMin=k5,se.defineLocale=Uu,se.updateLocale=O3,se.locales=M3,se.weekdaysShort=H5,se.normalizeUnits=on,se.relativeTimeRounding=sM,se.relativeTimeThreshold=aM,se.calendarFormat=_O,se.prototype=ee,se.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function cM(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function Ap(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function oh(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function ts(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function sh(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function hi(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function we(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function Ip(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return we(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function Hp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function qt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return ts(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),c=n[a]?n[a]:"";return o+l+c},"").trim()}function ah(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function Me(t){return typeof t<"u"}function Ft(t){return typeof t>"u"}function di(t){return t===null||t===""||Ft(t)}function uM(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const ns="length",rs=t=>parseInt(t,16),kp=t=>parseInt(t,10),Ua=(t,e,n)=>t.substr(e,n),is=t=>t.codePointAt(0)-65,lh=t=>`${t}`.replace(/\-/g,""),hM=t=>rs(Ua(lh(t),rs("12"),is("F")))/(rs(Ua(lh(t),is("B"),~~![][ns]))||9),dM=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let Pp=!1;const Np={invalid:()=>qt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return qt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>qt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},Dp={invalid:()=>qt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return qt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>qt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function fM(t,e){const n=!di(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="14.5.0";let o,s="invalid",a="invalid";t=lh(t||"");const l=mM(t);if(n||r||l)if(l){const c=se("30/07/2024","DD/MM/YYYY"),u=Math.floor(c.toDate().getTime()/864e5),d=hM(t);o=se((d+1)*864e5,"x").format("MMMM DD, YYYY"),u>d?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(dM()&&(s="valid",a="valid"),!Pp&&s!=="valid"&&(Np[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](Np[s]({keyValidityDate:o,hotVersion:i})),Pp=!0),a!=="valid"&&e.parentNode&&Dp[a]({keyValidityDate:o,hotVersion:i})){const u=document.createElement("div");u.className="hot-display-license-info",u.innerHTML=Dp[a]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(u,e.nextSibling)}}function mM(t){let e=[][ns],n=e;if(t[ns]!==is("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=is(i.shift());o;o=is(i.shift()||"A"))--o<""[ns]?n=n|(kp(`${kp(rs(r)+(rs(Ua(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=Ua(t,o,o?i[ns]===1?9:8:6);return n===e}function Qi(t){return t[0].toUpperCase()+t.substr(1)}function Lp(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function gM(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function pM(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function Fp(t,e){return lx.sanitize(t,e)}const Ya=t=>["tabindex",t],wM=()=>["role","treegrid"],mr=()=>["role","presentation"],bM=()=>["role","gridcell"],vM=()=>["role","rowheader"],$p=()=>["role","rowgroup"],yM=()=>["role","columnheader"],ch=()=>["role","row"],CM=()=>["scope","col"],SM=()=>["scope","row"],uh=()=>["aria-hidden","true"],RM=()=>["aria-multiselectable","true"],Wp=t=>["aria-rowcount",t],Ga=t=>["aria-colcount",t],Bp=t=>["aria-rowindex",t],hh=t=>["aria-colindex",t],Vp=()=>["aria-readonly","true"],zp=()=>["aria-invalid","true"],jp=()=>["aria-selected","true"];function _M(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function TM(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function EM(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function os(t){return EM(t)&&t.parent}function Up(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function Ka(t,e,n){const r=[];let i=t;for(;i&&(i=Up(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function dh(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function xM(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function fi(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function Yp(t){return!t||!t.length?[]:t.filter(e=>!!e)}function Gp(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),{regexFree:r,regexes:n}}function Ye(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function Ee(t,e){typeof e=="string"&&(e=e.split(" ")),e=Yp(e),e.length>0&&t.classList.add(...e)}function Ge(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=Gp(e,!0);n=Yp(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function Fe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function ss(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=Gp(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function Kp(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)Kp(e[n])}}function Ji(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const OM=/(<(.*)>|&(.*);)/;function MM(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;OM.test(e)?t.innerHTML=n?Fp(e):e:as(t,e)}function as(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(Ji(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function ls(t){const e=t.ownerDocument.documentElement;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return ls(n.host.impl);if(n.host)return ls(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(Pr(n).display==="none")return!1;n=n.parentNode}return!0}function Xt(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function Zp(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function fh(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function mh(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Zp(e):t.scrollTop}function qp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?fh(e):t.scrollLeft}function Za(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function AM(t){return t.scrollHeight-t.clientHeight}function IM(t){return t.scrollWidth-t.clientWidth}function qa(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=Pr(r,n),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function gh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=Pr(t,n);if(i[e]!==""&&i[e]!==void 0)return i[e]}function Pr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function lt(t){return t.offsetWidth}function Qt(t){return t.offsetHeight}function eo(t){return t.clientHeight||t.innerHeight}function Xp(t){return t.clientWidth||t.innerWidth}function HM(t){return t.selectionStart?t.selectionStart:0}function Qp(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function Jp(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let ph;function kM(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i}function It(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return ph===void 0&&(ph=kM(t)),ph}function PM(t){return t.offsetWidth!==t.clientWidth}function NM(t){return t.offsetHeight!==t.clientHeight}function wh(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function Xa(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Qa(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function e1(t){return Qa(t)&&t.hasAttribute("data-hot-input")===!1}function DM(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function t1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();Fe(t,"contenteditable",!0),n&&Fe(t,...uh()),e&&Ee(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function n1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&Ge(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function LM(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;t1(t,n),e(),n1(t,n)}function Ke(t){return typeof t=="function"}function FM(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function $M(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function bh(t,e,n,r,i,o,s,a){return Me(a)?t.call(e,n,r,i,o,s,a):Me(s)?t.call(e,n,r,i,o,s):Me(o)?t.call(e,n,r,i,o):Me(i)?t.call(e,n,r,i):Me(r)?t.call(e,n,r):Me(n)?t.call(e,n):t.call(e)}var WM=rt,r1=jm,BM=bt,i1=Xr,VM=ga,o1=WM([].push),zM=function(t){if(BM(t))return t;if(r1(t)){for(var e=t.length,n=[],r=0;r<e;r++){var i=t[r];typeof i=="string"?o1(n,i):(typeof i=="number"||i1(i)==="Number"||i1(i)==="String")&&o1(n,VM(i))}var o=n.length,s=!0;return function(a,l){if(s)return s=!1,l;if(r1(this))return l;for(var c=0;c<o;c++)if(n[c]===a)return l}}},jM=Ot,s1=$i,a1=fa,UM=ir,cs=rt,l1=Dt,c1=bt,u1=Ac,h1=lu,YM=zM,KM=Mc,ZM=String,Nr=s1("JSON","stringify"),Ja=cs(/./.exec),d1=cs("".charAt),qM=cs("".charCodeAt),XM=cs("".replace),QM=cs(1 .toString),JM=/[\uD800-\uDFFF]/g,f1=/^[\uD800-\uDBFF]$/,m1=/^[\uDC00-\uDFFF]$/,g1=!KM||l1(function(){var t=s1("Symbol")("stringify detection");return Nr([t])!=="[null]"||Nr({a:t})!=="{}"||Nr(Object(t))!=="{}"}),p1=l1(function(){return Nr("\uDF06\uD834")!=='"\\udf06\\ud834"'||Nr("\uDEAD")!=='"\\udead"'}),eA=function(t,e){var n=h1(arguments),r=YM(e);if(!(!c1(r)&&(t===void 0||u1(t))))return n[1]=function(i,o){if(c1(r)&&(o=UM(r,this,ZM(i),o)),!u1(o))return o},a1(Nr,null,n)},tA=function(t,e,n){var r=d1(n,e-1),i=d1(n,e+1);return Ja(f1,t)&&!Ja(m1,i)||Ja(m1,t)&&!Ja(f1,r)?"\\u"+QM(qM(t,0),16):t};Nr&&jM({target:"JSON",stat:!0,arity:3,forced:g1||p1},{stringify:function(e,n,r){var i=h1(arguments),o=a1(g1?eA:Nr,null,i);return p1&&typeof o=="string"?XM(o,JM,tA):o}});function us(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Le(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=us(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[us(n[0])]:e[r]=[]:e[r]=null)})),e}function nA(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function to(t,e,n){const r=Array.isArray(n);return Le(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function w1(t,e){Le(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),w1(t[r],e[r])):t[r]=e[r]})}function Dr(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function et(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return we(n,i=>{t.MIXINS.push(i.MIXIN_NAME),Le(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(u,d){const g=`_${u}`,f=b=>{let w=b;return(Array.isArray(w)||an(w))&&(w=Dr(w)),w};return function(){return this[g]===void 0&&(this[g]=f(d)),this[g]}},l=function(u){const d=`_${u}`;return function(g){this[d]=g}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function b1(t,e){return JSON.stringify(t)===JSON.stringify(e)}function an(t){return Object.prototype.toString.call(t)==="[object Object]"}function gr(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function Le(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function rA(t,e){const n=e.split(".");let r=t;return Le(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function vh(t,e,n){const r=e.split(".");let i=t;r.forEach((o,s)=>{s!==r.length-1?(Lr(i,o)||(i[o]={}),i=i[o]):i[o]=n})}function yh(t){if(!an(t))return 0;const e=function(n){let r=0;return an(n)?Le(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function Tn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function Lr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function v1(t){return window.requestAnimationFrame(t)}function y1(t){window.cancelAnimationFrame(t)}function iA(){return"ontouchstart"in window}function oA(){return typeof window<"u"}const ln=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},Fr={chrome:ln((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:ln(t=>/CriOS/.test(t)),edge:ln(t=>/Edge/.test(t)),edgeWebKit:ln(t=>/EdgiOS/.test(t)),firefox:ln(t=>/Firefox/.test(t)),firefoxWebKit:ln(t=>/FxiOS/.test(t)),mobile:ln(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:ln((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},el={mac:ln(t=>/^Mac/.test(t)),win:ln(t=>/^Win/.test(t)),linux:ln(t=>/^Linux/.test(t)),ios:ln(t=>/iPhone|iPad|iPod/i.test(t))};function sA(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Le(Fr,n=>{let{test:r}=n;return void r(t,e)})}function aA(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Le(el,e=>{let{test:n}=e;return void n(t)})}oA()&&(sA(),aA());function lA(){return Fr.chrome.value}function cA(){return Fr.chromeWebKit.value}function Ch(){return Fr.firefox.value}function uA(){return Fr.firefoxWebKit.value}function C1(){return Fr.safari.value}function hA(){return Fr.edge.value}function no(){return Fr.mobile.value}function S1(){return el.ios.value}function dA(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&el.mac.value}function R1(){return el.mac.value}const be={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Ch()?182:174,AUDIO_MUTE:Ch()?181:173,AUDIO_UP:Ch()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},fA=[be.ALT,be.ARROW_DOWN,be.ARROW_LEFT,be.ARROW_RIGHT,be.ARROW_UP,be.AUDIO_DOWN,be.AUDIO_MUTE,be.AUDIO_UP,be.BACKSPACE,be.CAPS_LOCK,be.DELETE,be.END,be.ENTER,be.ESCAPE,be.F1,be.F2,be.F3,be.F4,be.F5,be.F6,be.F7,be.F8,be.F9,be.F10,be.F11,be.F12,be.F13,be.F14,be.F15,be.F16,be.F17,be.F18,be.F19,be.HOME,be.INSERT,be.MEDIA_NEXT,be.MEDIA_PLAY_PAUSE,be.MEDIA_PREV,be.MEDIA_STOP,be.NULL,be.NUM_LOCK,be.PAGE_DOWN,be.PAGE_UP,be.PAUSE,be.SCROLL_LOCK,be.SHIFT,be.TAB];function mA(t){return fA.includes(t)}function gA(t){return[be.CONTROL,be.COMMAND_LEFT,be.COMMAND_RIGHT,be.COMMAND_FIREFOX].includes(t)}function pA(t,e){const n=e.split("|");let r=!1;return we(n,i=>{if(t===be[i])return r=!0,!1}),r}function tl(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function mi(t){return t.isImmediatePropagationEnabled===!1}function nl(t){return t.button===2}function _1(t){return t.button===0}function wA(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!(e instanceof HTMLElement)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}var T1={},bA=Sm,vA=tu,yA=Object.keys||function(e){return bA(e,vA)},CA=$n,SA=lm,RA=Qr,_A=Jr,TA=na,EA=yA;T1.f=CA&&!SA?Object.defineProperties:function(e,n){_A(e);for(var r=TA(n),i=EA(n),o=i.length,s=0,a;o>s;)RA.f(e,a=i[s++],r[a]);return e};var xA=Jr,OA=T1,E1=tu,MA=Gc,AA=lg,IA=$c,HA=mm,x1=">",O1="<",Sh="prototype",Rh="script",M1=HA("IE_PROTO"),_h=function(){},A1=function(t){return O1+Rh+x1+t+O1+"/"+Rh+x1},I1=function(t){t.write(A1("")),t.close();var e=t.parentWindow.Object;return t=null,e},kA=function(){var t=IA("iframe"),e="java"+Rh+":",n;return t.style.display="none",AA.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(A1("document.F=Object")),n.close(),n.F},rl,il=function(){try{rl=new ActiveXObject("htmlfile")}catch{}il=typeof document<"u"?document.domain&&rl?I1(rl):kA():I1(rl);for(var t=E1.length;t--;)delete il[Sh][E1[t]];return il()};MA[M1]=!0;var PA=Object.create||function(e,n){var r;return e!==null?(_h[Sh]=xA(e),r=new _h,_h[Sh]=null,r[M1]=e):r=il(),n===void 0?r:OA.f(r,n)},NA=Bi,DA=PA,LA=Qr.f,Th=NA("unscopables"),Eh=Array.prototype;Eh[Th]===void 0&&LA(Eh,Th,{configurable:!0,value:DA(null)});var xh=function(t){Eh[Th][t]=!0},FA=xh;FA("flatMap");function gi(){Me(console)&&console.warn(...arguments)}function $A(){Me(console)&&console.error(...arguments)}function WA(t,e,n){return(e=BA(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BA(t){var e=VA(t,"string");return typeof e=="symbol"?e:e+""}function VA(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const ro=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],zA=qt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,Oh=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Mh=new Map([[]]),ol=new WeakMap;class Ve{static getSingleton(){return UA()}constructor(){WA(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return we(ro,n=>{e[n]=[],this.initOrderMap(e,n)}),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;if(Array.isArray(n))we(n,o=>this.add(e,o,r));else{Oh.has(e)&&gi(pM(zA,{hookName:e,removedInVersion:Oh.get(e)})),Mh.has(e)&&gi(Mh.get(e));const o=this.getBucket(r);if(typeof o[e]>"u"&&(this.register(e),o[e]=[],this.initOrderMap(o,e)),n.skip=!1,o[e].indexOf(n)===-1){let s=!1;n.initialHook&&we(o[e],(a,l)=>{if(a.initialHook)return o[e][l]=n,s=!0,!1}),s||o[e].push(n)}this.setCallbackOrderIndex(o,e,n,i),this.orderBucketByOrderIndex(o,e)}return this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;Array.isArray(n)?we(n,o=>this.once(e,o,r)):(n.runOnce=!0,this.add(e,n,r,i))}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=this.getBucket(r);return typeof i[e]<"u"&&i[e].indexOf(n)>=0?(n.skip=!0,!0):!1}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const r=this.getBucket(n);return!!(r[e]!==void 0&&r[e].length)}run(e,n,r,i,o,s,a,l){{const c=this.globalBucket[n],u=c?c.length:0;let d=0;if(u)for(;d<u;){if(!c[d]||c[d].skip){d+=1;continue}const g=bh(c[d],e,r,i,o,s,a,l);g!==void 0&&(r=g),c[d]&&c[d].runOnce&&this.remove(n,c[d]),d+=1}}{const c=this.getBucket(e)[n],u=c?c.length:0;let d=0;if(u)for(;d<u;){if(!c[d]||c[d].skip){d+=1;continue}const g=bh(c[d],e,r,i,o,s,a,l);g!==void 0&&(r=g),c[d]&&c[d].runOnce&&this.remove(n,c[d],e),d+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Le(this.getBucket(e),(n,r,i)=>i[r].length=0)}register(e){this.isRegistered(e)||ro.push(e)}deregister(e){this.isRegistered(e)&&ro.splice(ro.indexOf(e),1)}isDeprecated(e){return Mh.has(e)||Oh.has(e)}isRegistered(e){return ro.indexOf(e)>=0}getRegistered(){return ro}setCallbackOrderIndex(e,n,r,i){const o=Number.isInteger(i)?i:0,s=this.getCallbackOrderMap(e,n);s.set(o,[...s.get(o)||[],r])}orderBucketByOrderIndex(e,n){const r=this.getCallbackOrderMap(e,n);r===void 0||r.size===0||r.size===1&&r.has(0)||(e[n]=[...r].sort((i,o)=>i[0]-o[0]).flatMap(i=>{let[,o]=i;return o}))}initOrderMap(e,n){ol.has(e)||ol.set(e,[]),ol.get(e)[n]=new Map}getCallbackOrderMap(e,n){return ol.get(e)[n]}}const jA=new Ve;function UA(){return jA}const Ah=new Map;function io(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Ah.has(t)||Ah.set(t,new Map);const e=Ah.get(t);function n(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s}}const Ih=new WeakMap,{register:YA,getItem:H1,hasItem:k1,getNames:JD,getValues:e7}=io("editors");function GA(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},Ve.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function KA(t,e){let n;if(typeof t=="function")Ih.get(t)||N1(null,t),n=Ih.get(t);else if(typeof t=="string")n=H1(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function P1(t){if(typeof t=="function")return t;if(!k1(t))throw Error(`No registered editor found under "${t}" name`);return H1(t).getConstructor()}function N1(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new GA(e);typeof t=="string"&&YA(t,n),Ih.set(e,n)}function ZA(t,e,n){return(e=qA(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qA(t){var e=XA(t,"string");return typeof e=="symbol"?e:e+""}function XA(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;ZA(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,QA(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function QA(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),tl(this)},t}function JA(t,e){eI(t,e),e.add(t)}function eI(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wi(t,e,n){return(e=tI(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tI(t){var e=nI(t,"string");return typeof e=="symbol"?e:e+""}function nI(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function D1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Hh=new WeakSet;class kh{constructor(e,n,r){JA(this,Hh),wi(this,"hot",void 0),wi(this,"tableMeta",void 0),wi(this,"selection",void 0),wi(this,"eventManager",void 0),wi(this,"destroyed",!1),wi(this,"activeEditor",void 0),wi(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new pi(e),this.hot.addHook("afterDocumentKeyDown",i=>D1(Hh,this,rI).call(this,i)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",i=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",i)}),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>D1(Hh,this,iI).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,c=>{c&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:r,col:i}=n,o=this.hot.runHooks("modifyGetCellCoords",r,i);let s=r,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(r,i,!0);if(l){const c=this.hot.getCellEditor(this.cellProperties),u=this.hot.colToProp(a),d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=KA(c,this.hot),this.activeEditor.prepare(r,i,u,l,d,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,n,r);if(n instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function rI(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||mi(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!mA(n)&&!gA(n)&&!r&&!this.isEditorOpened()&&this.openEditor("",t)}function iI(t,e){e.isCell()&&this.openEditor(null,t,!0)}const L1=new WeakMap;kh.getInstance=function(t,e,n){let r=L1.get(t);return r||(r=new kh(t,e,n),L1.set(t,r)),r};function oI(t,e){F1(t,e),e.add(t)}function hs(t,e,n){F1(t,e),e.set(t,n)}function F1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ze(t,e){return t.get(pr(t,e))}function ds(t,e,n){return t.set(pr(t,e),n),n}function pr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const oo=Object.freeze({CELL:"cell",MIXED:"mixed"});var ht=new WeakMap,sl=new WeakMap,al=new WeakMap,ll=new WeakMap,cl=new WeakMap,$r=new WeakSet;class sI{constructor(e){var n=this;oI(this,$r),hs(this,ht,void 0),hs(this,sl,void 0),hs(this,al,1),hs(this,ll,null),hs(this,cl,new Map);const r=e.getSettings();ds(ht,this,e),ds(sl,this,r.imeFastEdit?oo.MIXED:oo.CELL),Ze(ht,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return pr($r,n,lI).call(n,...o)}),Ze(ht,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return pr($r,n,$1).call(n,...o)}),Ze(ht,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return pr($r,n,$1).call(n,...o)}),Ze(ht,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return pr($r,n,aI).call(n,...o)})}getFocusMode(){return Ze(sl,this)}setFocusMode(e){Object.values(oo).includes(e)?ds(sl,this,e):gi(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Ze(al,this)}setRefocusDelay(e){ds(al,this,e)}setRefocusElementGetter(e){ds(ll,this,e)}getRefocusElement(){if(typeof Ze(ll,this)=="function")return Ze(ll,this).call(this);var e;return(e=Ze(ht,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,o;const s=(i=Ze(ht,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=Ze(ht,this).runHooks("modifyFocusedElement",s.row,s.col,r);a instanceof HTMLElement||(a=r),a&&!((o=Ze(ht,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):pr($r,this,Ph).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ze(al,this);const r=this.getRefocusElement();Ze(ht,this).getSettings().imeFastEdit&&!((e=Ze(ht,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&r&&(Ze(cl,this).has(n)||Ze(cl,this).set(n,FM(()=>{r.select()},n)),Ze(cl,this).get(n)())}}function Ph(t){var e;const n=(e=Ze(ht,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!Ze(ht,this).selection.isCellVisible(n)){t(null);return}const r=Ze(ht,this).getCell(n.row,n.col,!0);r===null?Ze(ht,this).addHookOnce("afterScroll",()=>{t(Ze(ht,this).getCell(n.row,n.col,!0))}):t(r)}function $1(){pr($r,this,Ph).call(this,t=>{const{activeElement:e}=Ze(ht,this).rootDocument;e&&e1(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function aI(){pr($r,this,Ph).call(this,t=>{this.getFocusMode()===oo.MIXED&&t.nodeName==="TD"&&this.refocusToEditorTextarea()})}function lI(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?oo.MIXED:oo.CELL)}var cI=Wn,uI=Xr,hI=Bi,dI=hI("match"),fI=function(t){var e;return cI(t)&&((e=t[dI])!==void 0?!!e:uI(t)==="RegExp")},mI=Jr,gI=function(){var t=mI(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},pI=ir,wI=Bn,bI=xc,vI=gI,W1=RegExp.prototype,yI=function(t){var e=t.flags;return e===void 0&&!("flags"in W1)&&!wI(t,"flags")&&bI(W1,t)?pI(vI,t):e},Nh=rt,CI=sa,SI=Math.floor,Dh=Nh("".charAt),RI=Nh("".replace),Lh=Nh("".slice),_I=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,TI=/\$([$&'`]|\d{1,2})/g,EI=function(t,e,n,r,i,o){var s=n+t.length,a=r.length,l=TI;return i!==void 0&&(i=CI(i),l=_I),RI(o,l,function(c,u){var d;switch(Dh(u,0)){case"$":return"$";case"&":return t;case"`":return Lh(e,0,n);case"'":return Lh(e,s);case"<":d=i[Lh(u,1,-1)];break;default:var g=+u;if(g===0)return c;if(g>a){var f=SI(g/10);return f===0?c:f<=a?r[f-1]===void 0?Dh(u,1):r[f-1]+Dh(u,1):c}d=r[g-1]}return d===void 0?"":d})},xI=Ot,OI=ir,Fh=rt,B1=ko,MI=bt,AI=_c,II=fI,fs=ga,HI=Ic,kI=yI,PI=EI,NI=Bi,DI=NI("replace"),LI=TypeError,$h=Fh("".indexOf);Fh("".replace);var V1=Fh("".slice),FI=Math.max;xI({target:"String",proto:!0},{replaceAll:function(e,n){var r=B1(this),i,o,s,a,l,c,u,d,g,f,b=0,w="";if(!AI(e)){if(i=II(e),i&&(o=fs(B1(kI(e))),!~$h(o,"g")))throw new LI("`.replaceAll` does not allow non-global regexes");if(s=HI(e,DI),s)return OI(s,e,r,n)}for(a=fs(r),l=fs(e),c=MI(n),c||(n=fs(n)),u=l.length,d=FI(1,u),g=$h(a,l);g!==-1;)f=c?fs(n(l,g,a)):PI(l,a,g,[],void 0,n),w+=V1(a,b,g)+f,b=g+u,g=g+d>a.length?-1:$h(a,l,g+d);return b<a.length&&(w+=V1(a,b)),w}});const z1={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},$I=new RegExp(Object.keys(z1).map(t=>`(${t})`).join("|"),"gi");function WI(t){return(t&&t.nodeName||"")==="TABLE"}function j1(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],c=["<tbody>","</tbody>"],u=n?1:0,d=e?1:0;for(let g=0;g<o;g+=1){const f=e&&g===0,b=[];for(let y=0;y<s;y+=1){const v=!f&&n&&y===0;let R="";if(f)R=`<th>${t.getColHeader(y-u)}</th>`;else if(v)R=`<th>${t.getRowHeader(g-d)}</th>`;else{const T=i[g][y],{hidden:M,rowspan:I,colspan:L}=t.getCellMeta(g-d,y-u);if(!M){const N=[];if(I&&N.push(`rowspan="${I}"`),L&&N.push(`colspan="${L}"`),di(T))R=`<td ${N.join(" ")}></td>`;else{const $=T.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");R=`<td ${N.join(" ")}>${$}</td>`}}}b.push(R)}const w=["<tr>",...b,"</tr>"].join("");f?l.splice(1,0,w):c.splice(-1,0,w)}return a.splice(1,0,l.join(""),c.join("")),a.join("")}function U1(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],c=di(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,u=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(u.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${c}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function BI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const T=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,M=>{const I=M.match(/<td\b[^>]*?>/g)[0],L=/<p.*?>/g,N=M.substring(I.length,M.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(L,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${I}${N}</td>`});i.insertAdjacentHTML("afterbegin",`${T}`),o=i.querySelector("table")}if(!o||!WI(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),c=l?Array.from(l.cells).reduce((T,M)=>T+M.colSpan,0)-(a?1:0):0,u=o.tFoot&&Array.from(o.tFoot.rows)||[],d=[];let g=!1,f=0,b=0;if(o.tHead){const T=Array.from(o.tHead.rows).filter(M=>{const I=M.querySelector("td")!==null;return I&&d.push(M),!I});f=T.length,g=f>0,f>1?n.nestedHeaders=Array.from(T).reduce((M,I)=>{const L=Array.from(I.cells).reduce((N,$,W)=>{if(a&&W===0)return N;const{colSpan:q,innerHTML:ue}=$,A=q>1?{label:ue,colspan:q}:ue;return N.push(A),N},[]);return M.push(L),M},[]):g&&(n.colHeaders=Array.from(T[0].children).reduce((M,I,L)=>(a&&L===0||M.push(I.innerHTML),M),[]))}d.length&&(n.fixedRowsTop=d.length),u.length&&(n.fixedRowsBottom=u.length);const w=[...d,...Array.from(o.tBodies).reduce((T,M)=>(T.push(...Array.from(M.rows)),T),[]),...u];b=w.length;const y=new Array(b);for(let T=0;T<b;T++)y[T]=new Array(c);const v=[],R=[];for(let T=0;T<b;T++){const M=w[T],I=Array.from(M.cells),L=I.length;for(let N=0;N<L;N++){const $=I[N],{nodeName:W,innerHTML:q,rowSpan:ue,colSpan:A}=$,B=y[T].findIndex(C=>C===void 0);if(W==="TD"){if(ue>1||A>1){for(let K=T;K<T+ue;K++)if(K<b)for(let ie=B;ie<B+A;ie++)y[K][ie]=null;const z=$.getAttribute("style");z&&z.includes("mso-ignore:colspan")||v.push({col:B,row:T,rowspan:ue,colspan:A})}let C="";s&&/excel/gi.test(s.content)?C=q.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):C=q.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),y[T][B]=C.replace($I,z=>z1[z])}else R.push(q)}}return v.length&&(n.mergeCells=v),R.length&&(n.rowHeaders=R),y.length&&(n.data=y),n}function Wr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function VI(t){return Wr(t,[","])}function dt(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function Y1(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function zI(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function ze(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const Wh="asc",jI="desc",G1=new Map([[Wh,[-1,1]],[jI,[1,-1]]]),UI=t=>`The priority '${t}' is already declared in a map.`,YI=t=>`The priority '${t}' is not a number.`;function GI(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=Ke(t)?t:UI,e=Ke(e)?e:YI;function r(o,s){if(!Wr(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Wh;const[s,a]=G1.get(o)||G1.get(Wh);return[...n].sort((l,c)=>l[0]<c[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const KI=t=>`The id '${t}' is already declared in a map.`;function ul(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=Ke(t)?t:KI;function n(c,u){if(l(c))throw new Error(t(c));e.set(c,u)}function r(c){return e.delete(c)}function i(){e.clear()}function o(c){const[u]=a().find(d=>{let[g,f]=d;return c===f?g:!1})||[null];return u}function s(c){return e.get(c)}function a(){return[...e]}function l(c){return e.has(c)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const ZI=t=>`'${t}' value is already declared in a unique set.`;function qI(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=Ke(t)?t:ZI;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const Bh=t=>`There is already registered "${t}" plugin.`,K1=GI({errorPriorityExists:t=>`There is already registered plugin on priority "${t}".`,errorPriorityNaN:t=>`The priority "${t}" is not a number.`}),Z1=qI({errorItemExists:Bh}),Vh=ul({errorIdExists:Bh});function q1(){return[...K1.getItems(),...Z1.getItems()]}function zh(t){const e=Qi(t);return Vh.getItem(e)}function XI(t){return!!zh(t)}function hl(t,e,n){[t,e,n]=JI(t,e,n),zh(t)===void 0&&QI(t,e,n)}function QI(t,e,n){const r=Qi(t);if(Vh.hasItem(r))throw new Error(Bh(r));n===void 0?Z1.addItem(r):K1.addItem(n,r),Vh.addItem(r,e)}function JI(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:eH,getItem:tH,hasItem:X1,getNames:r7,getValues:i7}=io("renderers");function Q1(t){if(typeof t=="function")return t;if(!X1(t))throw Error(`No registered renderer found under "${t}" name`);return tH(t)}function nH(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),eH(t,e)}const{register:rH,getItem:iH,hasItem:J1,getNames:o7,getValues:s7}=io("validators");function oH(t){if(typeof t=="function")return t;if(!J1(t))throw Error(`No registered validator found under "${t}" name`);return iH(t)}function sH(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),rH(t,e)}var aH=Ot,lH=sa,cH=Jc,uH=Do,hH=xh;aH({target:"Array",proto:!0},{at:function(e){var n=lH(this),r=cH(n),i=uH(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:n[o]}}),hH("at");var dH=Ot,fH=rt,mH=ko,gH=Do,pH=ga,wH=Dt,bH=fH("".charAt),vH=wH(function(){return"𠮷".at(-2)!=="\uD842"});dH({target:"String",proto:!0,forced:vH},{at:function(e){var n=pH(mH(this)),r=n.length,i=gH(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:bH(n,o)}});function ms(t,e,n){return(e=yH(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yH(t){var e=CH(t,"string");return typeof e=="symbol"?e:e+""}function CH(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class SH{constructor(){ms(this,"count",0),ms(this,"startColumn",null),ms(this,"endColumn",null),ms(this,"startPosition",null),ms(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=n,a=i>0?o+1:o;r>=i&&r+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:c,columnWidth:u}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const b=c[this.endColumn]+u-c[this.startColumn-1];if(b<=i&&(this.startColumn-=1),b>=i)break}this.startPosition=(n=c[this.startColumn])!==null&&n!==void 0?n:null;const d=s>0?i+1:i,g=r+i-d,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);g<-1*o||r>c.at(-1)||-1*r-i>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function gs(t,e,n){return(e=RH(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RH(t){var e=_H(t,"string");return typeof e=="symbol"?e:e+""}function _H(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TH{constructor(){gs(this,"count",0),gs(this,"startRow",null),gs(this,"endRow",null),gs(this,"startPosition",null),gs(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=n;r>=i&&r+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:c}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const g=l[this.endRow]+c-l[this.startRow-1];if(g<=i-o&&(this.startRow-=1),g>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null;const u=r+i-o,d=this.startRow===null?0:e.getRowHeight(this.startRow);u<d||r>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function ps(t,e,n){return(e=EH(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EH(t){var e=xH(t,"string");return typeof e=="symbol"?e:e+""}function xH(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ew{constructor(){ps(this,"count",0),ps(this,"startColumn",null),ps(this,"endColumn",null),ps(this,"startPosition",null),ps(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o}=n;r<=i&&(this.startColumn=e);const s=i>0?o+1:o;r>=i&&r<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:c,columnWidth:u}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=c[this.endColumn]+u-c[this.startColumn-1];if(this.startColumn-=1,f>i)break}this.startPosition=(n=c[this.startColumn])!==null&&n!==void 0?n:null;const d=s>0?i+1:i;r+i-d<-1*o||r>c.at(-1)+u||-1*r-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function ws(t,e,n){return(e=OH(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function OH(t){var e=MH(t,"string");return typeof e=="symbol"?e:e+""}function MH(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tw{constructor(){ws(this,"count",0),ws(this,"startRow",null),ws(this,"endRow",null),ws(this,"startPosition",null),ws(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o}=n;r<=i&&(this.startRow=e),r>=i&&r<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:c}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+c-l[this.startRow-1];if(this.startRow-=1,d>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null,r+i-o<0||r>l.at(-1)+c?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function bs(t,e,n){return(e=AH(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AH(t){var e=IH(t,"string");return typeof e=="symbol"?e:e+""}function IH(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HH{constructor(){bs(this,"count",0),bs(this,"startColumn",0),bs(this,"endColumn",0),bs(this,"startPosition",0),bs(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function vs(t,e,n){return(e=kH(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kH(t){var e=PH(t,"string");return typeof e=="symbol"?e:e+""}function PH(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NH{constructor(){vs(this,"count",0),vs(this,"startRow",0),vs(this,"endRow",0),vs(this,"startPosition",0),vs(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}class DH extends ew{finalize(e){var n;super.finalize(e);const{overrideFn:r,totalColumns:i,startPositions:o}=e;this.startColumn!==null&&typeof r=="function"&&r(this),this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=o[this.startColumn])!==null&&n!==void 0?n:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}class LH extends tw{finalize(e){var n;super.finalize(e);const{overrideFn:r,totalRows:i,startPositions:o}=e;this.startRow!==null&&typeof r=="function"&&r(this),this.startRow<0&&(this.startRow=0),this.startPosition=(n=o[this.startRow])!==null&&n!==void 0?n:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function nw(t,e,n){return(e=FH(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FH(t){var e=$H(t,"string");return typeof e=="symbol"?e:e+""}function $H(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rw{constructor(e){nw(this,"calculationTypes",[]),nw(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[r,i]=n;this.calculationResults.set(r,i),i.initialize(e)})}_process(e,n){this.calculationTypes.forEach(r=>{let[,i]=r;return i.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,r]=n;return r.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function En(t,e,n){return(e=WH(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WH(t){var e=BH(t,"string");return typeof e=="symbol"?e:e+""}function BH(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const dl=50;class VH extends rw{constructor(e){let{calculationTypes:n,viewportWidth:r,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(n),En(this,"viewportWidth",0),En(this,"scrollOffset",0),En(this,"zeroBasedScrollOffset",0),En(this,"totalColumns",0),En(this,"columnWidthFn",null),En(this,"columnWidth",0),En(this,"overrideFn",null),En(this,"inlineStartOffset",0),En(this,"totalCalculatedWidth",0),En(this,"startPositions",[]),En(this,"needReverse",!0),this.viewportWidth=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?dl:n}}function cn(t,e,n){return(e=zH(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zH(t){var e=jH(t,"string");return typeof e=="symbol"?e:e+""}function jH(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const UH=23;class YH extends rw{constructor(e){let{calculationTypes:n,viewportHeight:r,scrollOffset:i,totalRows:o,rowHeightFn:s,overrideFn:a,horizontalScrollbarHeight:l}=e;super(n),cn(this,"viewportHeight",0),cn(this,"scrollOffset",0),cn(this,"zeroBasedScrollOffset",0),cn(this,"totalRows",0),cn(this,"rowHeightFn",null),cn(this,"rowHeight",0),cn(this,"overrideFn",null),cn(this,"horizontalScrollbarHeight",0),cn(this,"innerViewportHeight",0),cn(this,"totalCalculatedHeight",0),cn(this,"startPositions",[]),cn(this,"needReverse",!0),this.viewportHeight=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=s,this.overrideFn=a,this.horizontalScrollbarHeight=l??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?UH:n}}function GH(t,e,n){KH(t,e),e.set(t,n)}function KH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iw(t,e,n){return(e=ZH(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZH(t){var e=qH(t,"string");return typeof e=="symbol"?e:e+""}function qH(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function so(t,e){return t.get(sw(t,e))}function ow(t,e,n){return t.set(sw(t,e),n),n}function sw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var wr=new WeakMap;class bi{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;iw(this,"row",null),iw(this,"col",null),GH(this,wr,!1),ow(wr,this,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return so(wr,this)}isSouthEastOf(e){return this.row>=e.row&&(so(wr,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(so(wr,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(so(wr,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(so(wr,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof bi&&ow(wr,this,e.isRtl()),this}clone(){return new bi(this.row,this.col,so(wr,this))}toObject(){return{row:this.row,col:this.col}}}function XH(t,e,n){QH(t,e),e.set(t,n)}function QH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jh(t,e,n){return(e=JH(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JH(t){var e=e4(t,"string");return typeof e=="symbol"?e:e+""}function e4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function un(t,e){return t.get(aw(t,e))}function t4(t,e,n){return t.set(aw(t,e),n),n}function aw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var $t=new WeakMap;class ys{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;jh(this,"highlight",null),jh(this,"from",null),jh(this,"to",null),XH(this,$t,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),t4($t,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(r.row,s.row),c=Math.min(r.col,s.col),u=Math.max(i.row,a.row),d=Math.max(i.col,a.col),g=this._createCellCoords(l,c),f=this._createCellCoords(u,d);return this.from=g,this.to=f,this.setDirection(o),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return un($t,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return un($t,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return un($t,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return un($t,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return un($t,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return un($t,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return un($t,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return un($t,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof bi))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push(un($t,this)?"left":"right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push(un($t,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new ys(this.highlight,this.from,this.to,un($t,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new bi(e,n,un($t,this))}}function Zn(t,e,n){n4(t,e),e.set(t,n)}function n4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function de(t,e){return t.get(lw(t,e))}function Br(t,e,n){return t.set(lw(t,e),n),n}function lw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var hn=new WeakMap,Uh=new WeakMap,ft=new WeakMap,ao=new WeakMap,fl=new WeakMap,xn=new WeakMap,Yh=new WeakMap,Cs=new WeakMap,vi=new WeakMap,qn=new WeakMap;class cw{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Zn(this,hn,void 0),Zn(this,Uh,void 0),Zn(this,ft,void 0),Zn(this,ao,void 0),Zn(this,fl,void 0),Zn(this,xn,void 0),Zn(this,Yh,void 0),Zn(this,Cs,void 0),Zn(this,vi,[null,null]),Zn(this,qn,[null,null]),Br(hn,this,r),Br(Uh,this,n),Br(ft,this,o),Br(ao,this,s),Br(fl,this,a),Br(xn,this,i),Br(Yh,this,e),this.registerEvents()}registerEvents(){de(xn,this).addEventListener(de(ft,this).holder,"contextmenu",r=>this.onContextMenu(r)),de(xn,this).addEventListener(de(ft,this).TABLE,"mouseover",r=>this.onMouseOver(r)),de(xn,this).addEventListener(de(ft,this).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{de(xn,this).addEventListener(de(ft,this).holder,"touchstart",r=>this.onTouchStart(r)),de(xn,this).addEventListener(de(ft,this).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),de(xn,this).addEventListener(de(ft,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||de(hn,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,de(hn,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{de(xn,this).addEventListener(de(ft,this).holder,"mouseup",r=>this.onMouseUp(r)),de(xn,this).addEventListener(de(ft,this).holder,"mousedown",r=>this.onMouseDown(r))};no()?e():(iA()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(de(Cs,this)&&r){const[i,o]=[r.row,de(Cs,this).from.row],[s,a]=[r.col,de(Cs,this).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=de(ft,this).TABLE,i=Ka(e,["TD","TH"],r);return i?(n.coords=de(ft,this).getCoords(i),n.TD=i):Ye(e,"wtBorder")&&Ye(e,"current")?(n.coords=de(ao,this).getFocusSelection().cellRange.highlight,n.TD=de(ft,this).getCell(n.coords)):Ye(e,"wtBorder")&&Ye(e,"area")&&de(ao,this).getAreaSelection().cellRange&&(n.coords=de(ao,this).getAreaSelection().cellRange.to,n.TD=de(ft,this).getCell(n.coords)),n}onMouseDown(e){const n=de(Uh,this).rootDocument.activeElement,r=$M(_M,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);Ye(i,"corner")?de(hn,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&de(hn,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(de(qn,this)[0]=o.TD,clearTimeout(de(vi,this)[0]),de(vi,this)[0]=setTimeout(()=>{de(qn,this)[0]=null},1e3))}onContextMenu(e){if(de(hn,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!de(hn,this).has("onCellMouseOver"))return;const n=de(ft,this).TABLE,r=Ka(e.target,["TD","TH"],n),i=de(fl,this)||this;r&&r!==i.lastMouseOver&&dh(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,de(ft,this).getCoords(r),r))}onMouseOut(e){if(!de(hn,this).has("onCellMouseOut"))return;const n=de(ft,this).TABLE,r=Ka(e.target,["TD","TH"],n),i=Ka(e.relatedTarget,["TD","TH"],n),o=de(fl,this)||this;r&&r!==i&&dh(r,n)&&(this.callListener("onCellMouseOut",e,de(ft,this).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&de(hn,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===de(qn,this)[0]&&n.TD===de(qn,this)[1]?(Ye(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),de(qn,this)[0]=null,de(qn,this)[1]=null):n.TD===de(qn,this)[0]&&(de(qn,this)[1]=n.TD,clearTimeout(de(vi,this)[1]),de(vi,this)[1]=setTimeout(()=>{de(qn,this)[1]=null},500)))}onTouchStart(e){Br(Cs,this,de(ao,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=Me(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&de(hn,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];S1()&&(cA()||uA())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=de(hn,this).getSettingPure(e);o&&o(n,r,i,de(Yh,this).call(this))}destroy(){clearTimeout(de(vi,this)[0]),clearTimeout(de(vi,this)[1]),de(xn,this).destroy()}}function Gh(t,e,n){return(e=r4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r4(t){var e=i4(t,"string");return typeof e=="symbol"?e:e+""}function i4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class o4{constructor(e,n,r){Gh(this,"offset",void 0),Gh(this,"total",void 0),Gh(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function Kh(t,e,n){return(e=s4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s4(t){var e=a4(t,"string");return typeof e=="symbol"?e:e+""}function a4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class l4{constructor(e,n,r){Kh(this,"offset",void 0),Kh(this,"total",void 0),Kh(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const c4=0,ml=1,gl=2;function pl(t,e,n){return(e=u4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u4(t){var e=h4(t,"string");return typeof e=="symbol"?e:e+""}function h4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uw{constructor(){pl(this,"currentSize",0),pl(this,"nextSize",0),pl(this,"currentOffset",0),pl(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function Zh(t,e,n){return(e=d4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d4(t){var e=f4(t,"string");return typeof e=="symbol"?e:e+""}function f4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class m4{constructor(){Zh(this,"size",new uw),Zh(this,"workingSpace",c4),Zh(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof uw}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=ml,e.workingSpace=gl,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=gl,e.workingSpace=ml,this.sharedSize=e.getViewSize()}}function lo(t,e,n){return(e=g4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g4(t){var e=p4(t,"string");return typeof e=="symbol"?e:e+""}function p4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hw{constructor(e,n,r){lo(this,"rootNode",void 0),lo(this,"nodesPool",void 0),lo(this,"sizeSet",new m4),lo(this,"childNodeType",void 0),lo(this,"visualIndex",0),lo(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=n,this.childNodeType=r.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:n}=this;let r=0;if(this.isSharedViewSet()){let i=e.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)r+=1;else if(n.isPlaceOn(ml))break;i=i.nextElementSibling}}else r=e.childElementCount;return r}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:n}=this,r=this.isSharedViewSet(),{nextSize:i}=n.getViewSize();let o=this.getRenderedChildCount();for(;o<i;){const a=this.nodesPool();!r||r&&n.isPlaceOn(gl)?e.appendChild(a):e.insertBefore(a,e.firstChild),o+=1}const s=r&&n.isPlaceOn(ml);for(;o>i;)e.removeChild(s?e.firstChild:e.lastChild),o-=1}render(){const{rootNode:e,sizeSet:n}=this;let r=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(gl)&&(r+=n.sharedSize.nextSize);let i=e.childNodes[r];if(i.tagName!==this.childNodeType){const o=this.nodesPool();e.replaceChild(o,i),i=o}this.collectedNodes.push(i),this.visualIndex+=1}end(){}}class dw extends hw{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function w4(t,e,n){return(e=b4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b4(t){var e=v4(t,"string");return typeof e=="symbol"?e:e+""}function v4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class y4{constructor(e){w4(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function Ss(t,e,n){return(e=C4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function C4(t){var e=S4(t,"string");return typeof e=="symbol"?e:e+""}function S4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Rs{constructor(e,n){Ss(this,"nodesPool",null),Ss(this,"nodeType",void 0),Ss(this,"rootNode",void 0),Ss(this,"table",null),Ss(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new y4(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function fw(t,e,n){return(e=R4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function R4(t){var e=_4(t,"string");return typeof e=="symbol"?e:e+""}function _4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class T4 extends Rs{constructor(){super("TH"),fw(this,"orderViews",new WeakMap),fw(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new dw(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const c=this.obtainOrderView(l),u=o.obtainOrderView(l);c.appendView(u).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let d=0;d<r;d++){c.render();const g=c.getCurrentNode();g.className="",g.removeAttribute("style"),ss(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Fe(g,[vM(),SM(),hh(d+1),Ya(-1)]),n[d](a,g,d)}c.end()}}}class E4 extends Rs{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&Ji(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Fe(this.rootNode,[$p()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&Fe(s,[ch(),Bp(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),c=s.childNodes[a+o];c.className="",c.removeAttribute("style"),ss(c,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Fe(c,[hh(a+1+this.table.rowHeadersCount),Ya(-1),yM(),...a>=0?[CM()]:[ch()]]),r[n](l,c,n)}}}}let mw=!1;class x4 extends Rs{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!mw&&e>1e3&&(mw=!0,gi(qt`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getStretchedColumnWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&Ee(r,"rowHeader")}}function O4(t,e,n){return(e=M4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M4(t){var e=A4(t,"string");return typeof e=="symbol"?e:e+""}function A4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let gw=!1;class I4 extends Rs{constructor(e){super("TR",e),O4(this,"orderView",void 0),this.orderView=new hw(e,n=>this.nodesPool.obtain(n),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!gw&&e>1e3&&(gw=!0,gi(qt`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Fe(this.rootNode,[$p()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;Fe(o,[ch(),Bp(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}}this.orderView.end()}}function pw(t,e,n){return(e=H4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function H4(t){var e=k4(t,"string");return typeof e=="symbol"?e:e+""}function k4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class P4 extends Rs{constructor(){super("TD"),pw(this,"orderViews",new WeakMap),pw(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new dw(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),c=r.getRenderedNode(a);this.sourceRowIndex=l;const u=this.obtainOrderView(c),d=i.obtainOrderView(c);u.prependView(d).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let g=0;g<n;g++){u.render();const f=u.getCurrentNode(),b=this.table.renderedColumnToSource(g);if(Ye(f,"hide")||(f.className=""),f.removeAttribute("style"),f.removeAttribute("dir"),ss(f,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,b,f),this.table.isAriaEnabled()){var o,s;Fe(f,[...f.hasAttribute("role")?[]:[bM()],Ya(-1),hh(b+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}u.end()}}}function ct(t,e,n){return(e=N4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N4(t){var e=D4(t,"string");return typeof e=="symbol"?e:e+""}function D4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class L4{constructor(e){let{cellRenderer:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ct(this,"rootNode",void 0),ct(this,"rootDocument",void 0),ct(this,"rowHeaders",null),ct(this,"columnHeaders",null),ct(this,"colGroup",null),ct(this,"rows",null),ct(this,"cells",null),ct(this,"rowFilter",null),ct(this,"columnFilter",null),ct(this,"rowUtils",null),ct(this,"columnUtils",null),ct(this,"rowsToRender",0),ct(this,"columnsToRender",0),ct(this,"rowHeaderFunctions",[]),ct(this,"rowHeadersCount",0),ct(this,"columnHeaderFunctions",[]),ct(this,"columnHeadersCount",0),ct(this,"cellRenderer",void 0),ct(this,"activeOverlayName",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r);if(i.firstChild){const o=this.renderedRowToSource(r),s=this.rowUtils.getHeightByOverlayName(o,this.activeOverlayName);s?i.firstChild.style.height=`${s-1}px`:i.firstChild.style.height=""}}}}class F4{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new L4(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new T4,columnHeaders:new E4(n),colGroup:new x4(r),rows:new I4(i),cells:new P4}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function _s(t,e,n){$4(t,e),e.set(t,n)}function $4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wl(t,e,n){return(e=W4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W4(t){var e=B4(t,"string");return typeof e=="symbol"?e:e+""}function B4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rt(t,e){return t.get(ww(t,e))}function Ts(t,e,n){return t.set(ww(t,e),n),n}function ww(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var bl=new WeakMap,co=new WeakMap,Es=new WeakMap,vl=new WeakMap,yi=new WeakMap;class V4{constructor(e){let{totalColumns:n,stretchMode:r,stretchingColumnWidthFn:i,columnWidthFn:o}=e;wl(this,"stretchAllRatio",0),wl(this,"stretchLastWidth",0),wl(this,"stretchAllColumnsWidth",[]),_s(this,bl,0),wl(this,"needVerifyLastColumnWidth",!0),_s(this,co,()=>0),_s(this,Es,s=>s),_s(this,vl,s=>s),_s(this,yi,()=>"none"),Ts(co,this,n),Ts(yi,this,r),Ts(Es,this,i??Rt(Es,this)),Ts(vl,this,o??Rt(vl,this))}refreshStretching(e){if(Rt(yi,this).call(this)==="none")return;this.stretchAllRatio=0,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0,this.stretchLastWidth=0,Ts(bl,this,e);let n=0;for(let i=0;i<Rt(co,this).call(this);i++){const o=this._getColumnWidth(i),s=Rt(Es,this).call(this,void 0,i);typeof s=="number"?e-=s:n+=o}const r=e-n;if(Rt(yi,this).call(this)==="all"&&r>0)this.stretchAllRatio=e/n,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(Rt(yi,this).call(this)==="last"&&e!==1/0){const i=this._getColumnWidth(Rt(co,this).call(this)-1),o=r+i;this.stretchLastWidth=o>=0?o:i}}getStretchedColumnWidth(e,n){let r=null;return Rt(yi,this).call(this)==="all"&&this.stretchAllRatio!==0?r=this._getStretchedAllColumnWidth(e,n):Rt(yi,this).call(this)==="last"&&this.stretchLastWidth!==0&&(r=this._getStretchedLastColumnWidth(e)),r}_getStretchedAllColumnWidth(e,n){let r=0;if(!this.stretchAllColumnsWidth[e]){const i=Math.round(n*this.stretchAllRatio),o=Rt(Es,this).call(this,i,e);o===void 0?this.stretchAllColumnsWidth[e]=i:this.stretchAllColumnsWidth[e]=isNaN(o)?this._getColumnWidth(e):o}if(this.stretchAllColumnsWidth.length===Rt(co,this).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let i=0;i<this.stretchAllColumnsWidth.length;i++)r+=this.stretchAllColumnsWidth[i];r!==Rt(bl,this)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=Rt(bl,this)-r)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){return e===Rt(co,this).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(e){let n=Rt(vl,this).call(this,e);return isNaN(n)&&(n=dl),n}}function yl(t,e,n){return(e=z4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function z4(t){var e=j4(t,"string");return typeof e=="symbol"?e:e+""}function j4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class U4{constructor(e,n){yl(this,"dataAccessObject",void 0),yl(this,"wtSettings",void 0),yl(this,"headerWidths",new Map),yl(this,"stretching",void 0),this.dataAccessObject=e,this.wtSettings=n,this.stretching=new V4({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(r,i)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",r,i),columnWidthFn:r=>this.dataAccessObject.wtTable.getColumnWidth(r)})}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){let n=this.getWidth(e);const r=this.stretching.getStretchedColumnWidth(e,n);return r&&(n=r),n}getHeaderHeight(e){let n=this.wtSettings.getSetting("defaultRowHeight");const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}refreshStretching(){const{wtTable:e,wtViewport:n,cloneSource:r}=this.dataAccessObject,i=r?r.wtTable.holder:e.holder,o=i.offsetHeight<i.scrollHeight?It():0;this.stretching.refreshStretching(n.getViewportWidth()-o)}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(this.refreshStretching(),n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<r;o++){let s=Array.isArray(n)?n[o]:n;s=s??i,this.headerWidths.set(o,s)}}}}function bw(t,e,n){return(e=Y4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y4(t){var e=G4(t,"string");return typeof e=="symbol"?e:e+""}function G4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class K4{constructor(e,n){bw(this,"dataAccessObject",void 0),bw(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}getHeightByOverlayName(e,n){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(r=r===void 0?i:Math.max(r,i)),r}}function Xn(t,e,n){return(e=Z4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Z4(t){var e=q4(t,"string");return typeof e=="symbol"?e:e+""}function q4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uo{constructor(e,n,r,i,o){Xn(this,"wtSettings",null),Xn(this,"domBindings",void 0),Xn(this,"TBODY",null),Xn(this,"THEAD",null),Xn(this,"COLGROUP",null),Xn(this,"hasTableHeight",!0),Xn(this,"hasTableWidth",!0),Xn(this,"isTableVisible",!1),Xn(this,"tableOffset",0),Xn(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,Kp(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new K4(this.dataAccessObject,this.wtSettings),this.columnUtils=new U4(this.dataAccessObject,this.wtSettings),this.tableRenderer=new F4({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ye(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Fe(r,[mr()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ye(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Fe(r,[mr()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ye(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Fe(r.parentNode,[mr()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Fe(r,[mr()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,c=n.getSetting("columnHeaders"),u=c.length;let d=e;if(this.isMaster&&(r.beforeDraw(),this.holderOffset=Xt(this.holder),d=i.createCalculators(d),l&&!n.getSetting("fixedColumnsStart"))){const f=r.inlineStartOverlay.getScrollPosition(),b=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,b!==this.correctHeaderWidth&&(d=!1)}if(d)this.isMaster&&r.refresh(!0);else{this.isMaster?this.tableOffset=Xt(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=o>0?this.getFirstRenderedRow():0,b=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new l4(f,o,u),this.columnFilter=new o4(b,s,l);let w=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const y={};this.wtSettings.getSetting("beforeDraw",!0,y),w=y.skipRender!==!0}if(w){this.tableRenderer.setHeaderContentRenderers(a,c),(this.is(Qn)||this.is(Vr))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let y;if(this.isMaster&&(y=this.dataAccessObject.workspaceWidth,i.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Qn))&&this.markOversizedRows(),this.isMaster){this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),r.refresh(!1),r.applyToDOM();const v=lt(this.hider),R=lt(this.TABLE);v!==0&&R!==v&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),y!==i.getWorkspaceWidth()&&(i.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Qn)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let g=!1;return this.isMaster&&(g=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(g=r.bottomOverlay.resetFixedPosition()||g),g=r.inlineStartOverlay.resetFixedPosition()||g,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),g?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(d),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("defaultRowHeight");let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=eo(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Qn))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r);if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Up(n,["TD","TH"])),n===null)return null;const r=n.parentNode,i=r.parentNode;let o=xM(r),s=n.cellIndex;return fi(Ri,n,this.wtRootElement)||fi(Ci,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):fi(Vr,n,this.wtRootElement)||fi(Qn,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):o=this.rowFilter.renderedToSource(o),fi(Ri,n,this.wtRootElement)||fi(Si,n,this.wtRootElement)||fi(Vr,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.wtSettings.getSetting("defaultRowHeight"),r=eo(this.TBODY)-1;let i,o,s,a,l;if(!(n===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,s=this.rowFilter.renderedToSource(e),i=this.getRowHeight(s),a=this.getTrForRow(s),l=a.querySelector("th"),l?o=eo(l):o=eo(a)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<o||i<o)&&(o+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=o)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return lt(this.TABLE)}getHeight(){return Qt(this.TABLE)}getTotalWidth(){const e=lt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=Qt(this.hider);return e!==0?e:this.getHeight()}isVisible(){return ls(this.TABLE)}_modifyRowHeaderWidth(e){let n=Ke(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const X4="stickyRowsBottom",qh={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return t===0||e===0?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};gr(qh,"MIXIN_NAME",X4,{writable:!1,enumerable:!1});const Q4="stickyColumnsStart",Cl={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};gr(Cl,"MIXIN_NAME",Q4,{writable:!1,enumerable:!1});class Xh extends uo{constructor(e,n,r,i){super(e,n,r,i,Vr)}}et(Xh,qh),et(Xh,Cl);const Ci="top",Qn="bottom",Si="inline_start",Ri="top_inline_start_corner",Vr="bottom_inline_start_corner",vw=[Ci,Qn,Si,Ri,Vr],J4=new Map([[Ci,`ht_clone_${Ci}`],[Qn,`ht_clone_${Qn}`],[Si,`ht_clone_${Si} ht_clone_left`],[Ri,`ht_clone_${Ri} ht_clone_top_left_corner`],[Vr,`ht_clone_${Vr} ht_clone_bottom_left_corner`]]);function ek(t,e){tk(t,e),e.add(t)}function tk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nk(t,e,n){return(e=rk(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rk(t){var e=ik(t,"string");return typeof e=="symbol"?e:e+""}function ik(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Sl(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var xs=new WeakSet;class ok{constructor(e){ek(this,xs),nk(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,r,i,o){const s=this.scrollViewportHorizontally(e.col,r,o),a=this.scrollViewportVertically(e.row,n,i);return s||a}scrollViewportHorizontally(e,n,r){const{drawn:i,totalColumns:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=n===void 0&&r===void 0,{fixedColumnsStart:a,inlineStartOverlay:l}=this.dataAccessObject;if(s&&e<a||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),!Number.isInteger(e)||e<0||e>o))return!1;const c=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn();let d=!1;return(s&&(e<c||e>u)||!s)&&(d=l.scrollTo(e,s?e>=this.getLastPartiallyVisibleColumn():n)),d}scrollViewportVertically(e,n,r){const{drawn:i,totalRows:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=n===void 0&&r===void 0,{fixedRowsBottom:a,fixedRowsTop:l,topOverlay:c}=this.dataAccessObject;if(s&&(e<l||e>o-a-1)||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),!Number.isInteger(e)||e<0||e>o))return!1;const u=this.getFirstVisibleRow(),d=this.getLastVisibleRow();let g=!1;return(s&&(e<u||e>d)||!s)&&(g=c.scrollTo(e,s?e>=this.getLastPartiallyVisibleRow():r)),g}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return Sl(xs,this,Cw).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return Sl(xs,this,Cw).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return Sl(xs,this,yw).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return Sl(xs,this,yw).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function yw(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const u=r.TABLE.getBoundingClientRect(),g=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(u.right-g)}else l=Xt(r.wtRootElement).left;const c=Math.abs(qp(s,s));if(l>c){const u=Xp(s);let d=i.getRowHeaderWidth();for(let g=1;g<=o;g++)if(d+=n.sumCellSizes(g-1,g),l+d-c>=u){t=g-2;break}}}return t}function Cw(t){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=Xt(n.wtRootElement),a=mh(o,o);if(s.top>a){const l=eo(o);let c=r.getColumnHeaderHeight();for(let u=1;u<=i;u++)if(c+=e.sumCellSizes(u-1,u),s.top+c-a>=l){t=u-2;break}}}return t}function On(t,e,n){return(e=sk(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sk(t){var e=ak(t,"string");return typeof e=="symbol"?e:e+""}function ak(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qh{get eventManager(){return new pi(this)}constructor(e,n){On(this,"wtTable",void 0),On(this,"wtScroll",void 0),On(this,"wtViewport",void 0),On(this,"wtOverlays",void 0),On(this,"selectionManager",void 0),On(this,"wtEvent",void 0),On(this,"guid",`wt_${Lp()}`),On(this,"drawInterrupted",!1),On(this,"drawn",!1),On(this,"domBindings",void 0),On(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new ok(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){as(r,e[n])}])}}createCellCoords(e,n){return new bi(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new ys(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r,i,o){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return e<0?!1:this.wtScroll.scrollViewportVertically(e,n,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function Sw(t,e,n){return(e=lk(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lk(t){var e=ck(t,"string");return typeof e=="symbol"?e:e+""}function ck(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uk extends Qh{constructor(e,n,r){super(e,n),Sw(this,"cloneSource",void 0),Sw(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new cw(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function hk(t,e,n){return(e=dk(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dk(t){var e=fk(t,"string");return typeof e=="symbol"?e:e+""}function fk(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Os{constructor(e,n,r,i,o){hk(this,"wtSettings",null),gr(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:c,wtRootElement:u}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=c,this.wtRootElement=u,this.trimmingContainer=qa(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=qa(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Za(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){gi(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,c={start:this.getRelativeStartPosition(l),top:l.offsetTop},u={start:this.getRelativeStartPosition(e),top:e.offsetTop};let d=null;return i?d=this.getRelativeCellPositionWithinWindow(s,o,u,c):d=this.getRelativeCellPositionWithinHolder(s,a,o,u,c),d}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+It())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const c=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+c.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(vw.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${J4.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&Fe(o,[mr()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const c=this.wtSettings.getSetting("preventOverflow");return c===!0||c==="horizontal"&&this.type===Ci||c==="vertical"&&this.type===Si?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Za(e.TABLE),new uk(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.needFullRender&&this.clone.draw(e)}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;[r,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class mk extends Os{constructor(e,n,r,i,o,s){super(e,n,Vr,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new Xh(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else Xa(n),this.repositionOverlay();let r=Qt(this.clone.wtTable.TABLE);const i=lt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=It(r)),i.style.bottom=`${o}px`}}const gk="calculatedColumns",Rl={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};gr(Rl,"MIXIN_NAME",gk,{writable:!1,enumerable:!1});class Jh extends uo{constructor(e,n,r,i){super(e,n,r,i,Qn)}}et(Jh,qh),et(Jh,Rl);function pk(t,e,n){return(e=wk(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wk(t){var e=bk(t,"string");return typeof e=="symbol"?e:e+""}function bk(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vk extends Os{constructor(e,n,r,i){super(e,n,Qn,r,i),pk(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new Jh(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=It(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.mainTableScrollableElement===n?(n.scrollTo(fh(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,wtSettings:i}=this.wot,o=i.getSetting("defaultRowHeight");let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=It(r),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||l==="horizontal"){let u=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=o),u=Math.min(u,e.wtRootElement.scrollWidth),a.width=`${u}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let c=Qt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(c=0),a.height=`${c}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=It(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return mh(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=Ye(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(Ee(s,"innerBorderBottom"),o=!a):(Ge(s,"innerBorderBottom"),o=a)}return o}}const yk="calculatedRows",ed={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};gr(ed,"MIXIN_NAME",yk,{writable:!1,enumerable:!1});class td extends uo{constructor(e,n,r,i){super(e,n,r,i,Si)}}et(td,ed),et(td,Cl);const Ck="localHooks",br={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)bh(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};gr(br,"MIXIN_NAME",Ck,{writable:!1,enumerable:!1});let Rw=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};et(Rw,br);const Sk="active-header",_w="header",nd="area",rd="focus",Rk="fill",_k="row",Tk="column",Ek="custom-selection",id=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var xk=xh;xk("flat");function Ok(t,e){Ew(t,e),e.add(t)}function Tw(t,e,n){Ew(t,e),e.set(t,n)}function Ew(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tt(t,e){return t.get(Ms(t,e))}function xw(t,e,n){return t.set(Ms(t,e),n),n}function Ms(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Mn=new WeakMap,Wt=new WeakMap,_l=new WeakSet;class Mk{constructor(){Ok(this,_l),Tw(this,Mn,void 0),Tw(this,Wt,void 0)}setActiveOverlay(e){return xw(Wt,this,e),this}setActiveSelection(e){return xw(Mn,this,e),this}scan(){const e=tt(Mn,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=tt(Mn,this).getCorners(),{wtTable:s}=tt(Wt,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let c=0;for(let u=-s.getRowHeadersCount();u<a;u++){const d=s.columnFilter.renderedToSource(u);if(!(d<r||d>o)){for(let g=-l;g<0;g++){if(g<n||g>i)continue;const f=g+l;let b=s.getColumnHeader(d,f);const w=tt(Wt,this).getSetting("onBeforeHighlightingColumnHeader",d,f,{selectionType:tt(Mn,this).settings.selectionType,columnCursor:c,selectionWidth:o-r+1});w!==null&&(w!==d&&(b=s.getColumnHeader(w,f)),e(b))}c+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=tt(Mn,this).getCorners(),{wtTable:s}=tt(Wt,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let c=0;for(let u=-s.getColumnHeadersCount();u<a;u++){const d=s.rowFilter.renderedToSource(u);if(!(d<n||d>i)){for(let g=-l;g<0;g++){if(g<r||g>o)continue;const f=g+l;let b=s.getRowHeader(d,f);const w=tt(Wt,this).getSetting("onBeforeHighlightingRowHeader",d,f,{selectionType:tt(Mn,this).settings.selectionType,rowCursor:c,selectionHeight:i-n+1});w!==null&&(w!==d&&(b=s.getRowHeader(w,f)),e(b))}c+=1}}}scanCellsRange(e){const[n,r,i,o]=tt(Mn,this).getCorners(),{wtTable:s}=tt(Wt,this);Ms(_l,this,od).call(this,(a,l)=>{if(a>=n&&a<=i&&l>=r&&l<=o){const c=s.getCell(tt(Wt,this).createCellCoords(a,l)),u=tt(Wt,this).getSetting("onAfterDrawSelection",a,l,tt(Mn,this).settings.layerLevel);typeof u=="string"&&Ee(c,u),e(c)}})}scanRowsInCellsRange(e){const[n,,r]=tt(Mn,this).getCorners(),{wtTable:i}=tt(Wt,this);Ms(_l,this,od).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(tt(Wt,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=tt(Mn,this).getCorners(),{wtTable:i}=tt(Wt,this);Ms(_l,this,od).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(tt(Wt,this).createCellCoords(o,s));e(a)}})}}function od(t){const{wtTable:e}=tt(Wt,this),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class Ow{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=id,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),tl(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],c=n.createElement("div");c.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(c.className+=" hidden"),i=c.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(c)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),no()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const n=10,r=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const i={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`};Le(i,(s,a)=>{this.selectionHandles.styles.bottomHitArea[a]=s,this.selectionHandles.styles.topHitArea[a]=s});const o={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};Le(o,(s,a)=>{this.selectionHandles.styles.bottom[a]=s,this.selectionHandles.styles.top[a]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:c,topHitArea:u,bottom:d,bottomHitArea:g}=this.selectionHandles.styles,f=parseInt(c.borderWidth,10),b=parseInt(c.width,10),w=parseInt(u.width,10),y=this.wot.wtTable.getWidth(),v=this.wot.wtTable.getHeight();c.top=`${parseInt(r-b-1,10)}px`,c[l]=`${parseInt(i-b-1,10)}px`,u.top=`${parseInt(r-w/4*3,10)}px`,u[l]=`${parseInt(i-w/4*3,10)}px`;const R=Math.min(parseInt(i+o,10),y-b-f*2),T=Math.min(parseInt(i+o-w/4,10),y-w-f*2);d[l]=`${R}px`,g[l]=`${T}px`;const M=Math.min(parseInt(r+s,10),v-b-f*2),I=Math.min(parseInt(r+s-w/4,10),v-w-f*2);d.top=`${M}px`,g.top=`${I}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(c.display="block",u.display="block",this.isPartRange(e,n)?(d.display="none",g.display="none"):(d.display="block",g.display="block")):(c.display="none",d.display="none",u.display="none",g.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(c.zIndex="9999",u.zIndex="9999"):(c.zIndex="",u.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:n,rootDocument:r,rootWindow:i}=this.wot;let o,s,a,l,c,u;const d=n.getRenderedRowsCount();for(let ie=0;ie<d;ie+=1){const U=n.rowFilter.renderedToSource(ie);if(U>=e[0]&&U<=e[2]){o=U,c=e[0];break}}for(let ie=d-1;ie>=0;ie-=1){const U=n.rowFilter.renderedToSource(ie);if(U>=e[0]&&U<=e[2]){s=U;break}}const g=n.getRenderedColumnsCount();for(let ie=0;ie<g;ie+=1){const U=n.columnFilter.renderedToSource(ie);if(U>=e[1]&&U<=e[3]){a=U,u=e[1];break}}for(let ie=g-1;ie>=0;ie-=1){const U=n.columnFilter.renderedToSource(ie);if(U>=e[1]&&U<=e[3]){l=U;break}}if(o===void 0||a===void 0){this.disappear();return}let f=n.getCell(this.wot.createCellCoords(o,a));const b=o!==s||a!==l,w=b?n.getCell(this.wot.createCellCoords(s,l)):f,y=Xt(f),v=b?Xt(w):y,R=Xt(n.TABLE),T=lt(n.TABLE),M=y.top,I=y.left,L=this.wot.wtSettings.getSetting("rtlMode");let N=0,$=0;if(L){const ie=lt(f),U=i.innerWidth-R.left-T;$=I+ie-v.left,N=i.innerWidth-I-ie-U-1}else $=v.left+lt(w)-I,N=I-R.left-1;if(this.isEntireColumnSelected(o,s)){const ie=this.getDimensionsFromHeader("columns",a,l,c,R);let U=null;ie&&([U,N,$]=ie),U&&(f=U)}let W=M-R.top-1,q=v.top+Qt(w)-M;if(this.isEntireRowSelected(a,l)){const ie=this.getDimensionsFromHeader("rows",o,s,u,R);let U=null;ie&&([U,W,q]=ie),U&&(f=U)}const ue=Pr(f,i);parseInt(ue.borderTopWidth,10)>0&&(W+=1,q=q>0?q-1:0),parseInt(ue[L?"borderRightWidth":"borderLeftWidth"],10)>0&&(N+=1,$=$>0?$-1:0);const A=L?"right":"left";this.topStyle.top=`${W}px`,this.topStyle[A]=`${N}px`,this.topStyle.width=`${$}px`,this.topStyle.display="block",this.startStyle.top=`${W}px`,this.startStyle[A]=`${N}px`,this.startStyle.height=`${q}px`,this.startStyle.display="block";const B=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${W+q-B}px`,this.bottomStyle[A]=`${N}px`,this.bottomStyle.width=`${$}px`,this.bottomStyle.display="block",this.endStyle.top=`${W}px`,this.endStyle[A]=`${N+$-B}px`,this.endStyle.height=`${q+1}px`,this.endStyle.display="block";let C=this.settings.border.cornerVisible;C=typeof C=="function"?C(this.settings.layerLevel):C;const z=this.wot.getSetting("onModifyGetCellCoords",s,l);let[fe,K]=[s,l];if(z&&Array.isArray(z)&&([,,fe,K]=z),no()||!C||this.isPartRange(fe,K))this.cornerStyle.display="none";else{this.cornerStyle.top=`${W+q+this.cornerCenterPointOffset-1}px`,this.cornerStyle[A]=`${N+$+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let ie=qa(n.TABLE);const U=ie===i;U&&(ie=r.documentElement);const me=parseInt(this.cornerDefaultStyle.width,10)/2,h=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const m=U?w.getBoundingClientRect().left:w.offsetLeft;let S=!1,E=0;L?(E=m-parseInt(this.cornerDefaultStyle.width,10)/2,S=E<0):(E=m+lt(w)+parseInt(this.cornerDefaultStyle.width,10)/2,S=E>=Xp(ie)),S&&(this.cornerStyle[A]=`${Math.floor(N+$+this.cornerCenterPointOffset-me)}px`,this.cornerStyle[L?"borderLeftWidth":"borderRightWidth"]=0)}s===this.wot.getSetting("totalRows")-1&&(U?w.getBoundingClientRect().top:w.offsetTop)+Qt(w)+parseInt(this.cornerDefaultStyle.height,10)/2>=eo(ie)&&(this.cornerStyle.top=`${Math.floor(W+q+this.cornerCenterPointOffset-h)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}no()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(s,l,W,N,$,q)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,c=null,u=null,d=null,g=null,f=null,b=null,w=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},c=function(){return Qt(...arguments)},u="ht__selection--rows",f="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},c=function(){return lt(...arguments)},u="ht__selection--columns",f="left";break}if(a.classList.contains(u)){const y=this.wot.getSetting("columnHeaders").length;if(b=l(n,y-i),w=l(r,y-i),!b||!w)return!1;const v=Xt(b),R=Xt(w);return b&&w&&(d=v[f]-o[f]-1,g=R[f]+c(w)-v[f]),[b,d,g]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?Ee(this[e],"hidden"):(Ye(this[e],"hidden")&&Ge(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?Ee(this[e],"hidden"):Ge(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",no()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function Ak(t,e){Mw(t,e),e.add(t)}function ho(t,e,n){Mw(t,e),e.set(t,n)}function Mw(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xe(t,e){return t.get(sd(t,e))}function Aw(t,e,n){return t.set(sd(t,e),n),n}function sd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var _t=new WeakMap,Bt=new WeakMap,ad=new WeakMap,As=new WeakMap,ld=new WeakMap,_i=new WeakMap,Iw=new WeakSet;class Ik{constructor(e){Ak(this,Iw),ho(this,_t,void 0),ho(this,Bt,void 0),ho(this,ad,new Mk),ho(this,As,new WeakMap),ho(this,ld,new WeakSet),ho(this,_i,new Map),Aw(Bt,this,e)}setActiveOverlay(e){return Aw(_t,this,e),xe(ad,this).setActiveOverlay(xe(_t,this)),xe(As,this).has(xe(_t,this))||xe(As,this).set(xe(_t,this),new Set),this}getFocusSelection(){return xe(Bt,this)!==null?xe(Bt,this).getFocus():null}getAreaSelection(){return xe(Bt,this)!==null?xe(Bt,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(xe(_i,this).has(e)){const r=xe(_i,this).get(e);if(r.has(xe(_t,this)))return r.get(xe(_t,this));const i=new Ow(xe(_t,this),e.settings);return r.set(xe(_t,this),i),i}const n=new Ow(xe(_t,this),e.settings);return xe(_i,this).set(e,new Map([[xe(_t,this),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=xe(_i,this).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){xe(_i,this).get(e).forEach(n=>n.destroy()),xe(_i,this).delete(e)}render(e){if(xe(Bt,this)===null)return;e&&sd(Iw,this,Hk).call(this);const n=Array.from(xe(Bt,this)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:c,selectionType:u}=s.settings;xe(ld,this).has(s)||(xe(ld,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const d=this.getBorderInstance(s);if(s.isEmpty()){d==null||d.disappear();continue}a&&xe(ad,this).setActiveSelection(s).scan().forEach(b=>{if(r.has(b)){const w=r.get(b);w.has(a)&&c===!0?w.set(a,w.get(a)+1):w.set(a,1)}else r.set(b,new Map([[a,1]]));l&&(i.has(b)||i.set(b,[]),b.nodeName==="TH"&&i.get(b).push(...l))});const g=s.getCorners();xe(_t,this).getSetting("onBeforeDrawBorders",g,u),d==null||d.appear(g)}r.forEach((o,s)=>{var a;const l=Array.from(o).map(c=>{let[u,d]=c;return d===1?u:[u,...Array.from({length:d-1},(g,f)=>`${u}-${f+1}`)]}).flat();l.forEach(c=>xe(As,this).get(xe(_t,this)).add(c)),Ee(s,l),s.nodeName==="TD"&&Array.isArray((a=xe(Bt,this).options)===null||a===void 0?void 0:a.cellAttributes)&&Fe(s,xe(Bt,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{Fe(o,[...i.get(o)])})}}function Hk(){const t=xe(As,this).get(xe(_t,this)),e=xe(_t,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=xe(_t,this).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=xe(Bt,this).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=xe(Bt,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=xe(Bt,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...xe(Bt,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)Ge(o[a],n),ss(o[a],s)}),t.clear()}class kk extends Os{constructor(e,n,r,i){super(e,n,Si,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new td(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),wh(r,`${o}px`,"0px")):(o=this.getScrollPosition(),Xa(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===n&&n.scrollX!==e?(n.scrollTo(e,Zp(n)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getStretchedColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=It(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="vertical"){let c=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(c-=i),c=Math.min(c,e.wtRootElement.scrollHeight),s.height=`${c}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=lt(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(id.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:r}=this,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!Ye(a.parentNode,"innerBorderInlineStart")?1:0;let c=this.getTableParentOffset(),u=0;if(n){const d=this.wot.wtTable.getColumnWidth(e),g=this.wot.wtViewport.getViewportWidth();d>g&&(n=!1)}return n&&a.offsetWidth!==a.clientWidth&&(u=It(this.domBindings.rootDocument)),n?(c+=this.sumCellSizes(0,e+1),c-=this.wot.wtViewport.getViewportWidth(),c+=l):c+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),c+=u,IM(this.mainTableScrollableElement)===c-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(c)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(qp(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,r=this.wot.wtTable.holder.parentNode,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),s=n.getSetting("totalRows"),a=n.getSetting("preventOverflow")==="vertical";s?Ge(r,"emptyRows"):Ee(r,"emptyRows");let l=!1;if(!a){if(o&&!i.length)Ee(r,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const c=Ye(r,"innerBorderInlineStart");e?(Ee(r,"innerBorderLeft innerBorderInlineStart"),l=!c):(Ge(r,"innerBorderLeft innerBorderInlineStart"),l=c)}}return l}}const Pk="stickyRowsTop",cd={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};gr(cd,"MIXIN_NAME",Pk,{writable:!1,enumerable:!1});class ud extends uo{constructor(e,n,r,i){super(e,n,r,i,Ri)}}et(ud,cd),et(ud,Cl);function Hw(t,e,n){return(e=Nk(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nk(t){var e=Dk(t,"string");return typeof e=="symbol"?e:e+""}function Dk(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Lk extends Os{constructor(e,n,r,i,o,s){super(e,n,Ri,r,i),Hw(this,"topOverlay",void 0),Hw(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new ud(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();wh(e,`${i}px`,`${o}px`)}else Xa(e);let n=Qt(this.clone.wtTable.TABLE);const r=lt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class hd extends uo{constructor(e,n,r,i){super(e,n,r,i,Ci)}}et(hd,cd),et(hd,Rl);function Fk(t,e,n){return(e=$k(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $k(t){var e=Wk(t,"string");return typeof e=="symbol"?e:e+""}function Wk(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bk extends Os{constructor(e,n,r,i){super(e,n,Ci,r,i),Fk(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new hd(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),c=Math.ceil(l.bottom),u=e.offsetHeight;o=c===u,i=this.getOverlayOffset(),wh(e,"0px",`${i}px`)}else i=this.getScrollPosition(),Xa(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const n=this.domBindings.rootWindow;let r=!1;return this.mainTableScrollableElement===n&&n.scrollY!==e?(n.scrollTo(fh(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultRowHeight");let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=It(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let c=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=i),c=Math.min(c,e.wtRootElement.scrollWidth),s.width=`${c}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=Qt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(id.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder,a=i.getSetting("columnHeaders"),c=i.getSetting("fixedRowsTop")===0&&a.length>0&&!Ye(s.parentNode,"innerBorderTop")?1:0;let u=this.getTableParentOffset(),d=0;if(n){const g=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();g>f&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(d=It(this.domBindings.rootDocument)),n){const g=i.getSetting("fixedRowsBottom"),f=i.getSetting("totalRows");u+=this.sumCellSizes(0,e+1),u-=r.wtViewport.getViewportHeight()-this.sumCellSizes(f-g,f),u+=1,u+=c}else u+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return u+=d,AM(this.mainTableScrollableElement)===u-c&&c>0&&this.wot.wtOverlays.expandHiderVerticallyBy(c),this.setScrollPosition(u)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return mh(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:r}=this,i=this.wot.wtTable.holder.parentNode,o=r.getSetting("totalColumns"),s=r.getSetting("preventOverflow")==="horizontal";o?Ge(i,"emptyColumns"):Ee(i,"emptyColumns");let a=!1;if(!n&&!s){const l=r.getSetting("fixedRowsTop"),c=this.cachedFixedRowsTop!==l,u=r.getSetting("columnHeaders");if((c||l===0)&&u.length>0){const d=Ye(i,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||r.getSetting("totalRows")===0?(Ee(i,"innerBorderTop"),a=!d):(Ge(i,"innerBorderTop"),a=d)}}return a}}function Tl(t,e,n){Vk(t,e),e.set(t,n)}function Vk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vr(t,e,n){return(e=zk(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zk(t){var e=jk(t,"string");return typeof e=="symbol"?e:e+""}function jk(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ti(t,e,n){return t.set(kw(t,e),n),n}function yr(t,e){return t.get(kw(t,e))}function kw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var fo=new WeakMap,El=new WeakMap,mo=new WeakMap,xl=new WeakMap;class Uk{constructor(e,n,r,i,o,s){vr(this,"wot",null),Tl(this,fo,[]),vr(this,"topOverlay",null),vr(this,"bottomOverlay",null),vr(this,"inlineStartOverlay",null),vr(this,"topInlineStartCornerOverlay",null),vr(this,"bottomInlineStartCornerOverlay",null),vr(this,"browserLineHeight",void 0),vr(this,"wtSettings",null),Tl(this,El,!1),Tl(this,mo,0),Tl(this,xl,null),vr(this,"resizeObserver",new ResizeObserver(u=>{v1(()=>{!Array.isArray(u)||!u.length||(Ti(mo,this,yr(mo,this)+1),yr(mo,this)===100&&(gi("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),yr(xl,this)!==null&&clearTimeout(yr(xl,this)),Ti(xl,this,setTimeout(()=>{Ti(mo,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=It(a);const c=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=c?s.holder:Za(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...yr(fo,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new Bk(...e),this.bottomOverlay=new vk(...e),this.inlineStartOverlay=new kk(...e),this.topInlineStartCornerOverlay=new Lk(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new mk(...e,this.bottomOverlay,this.inlineStartOverlay),Ti(fo,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){Ti(El,this,yr(fo,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),yr(fo,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),yr(fo,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",d=>this.onKeyDown(d)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",d=>this.onTableScroll(d),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",d=>this.onTableScroll(d),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!lA())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",d=>this.onCloneWheel(d,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(d=>{if(d&&d.needFullRender){const{holder:g}=d.clone.wtTable;this.eventManager.addEventListener(g,"wheel",f=>this.onCloneWheel(f,a),l)}});let u;this.eventManager.addEventListener(n,"resize",()=>{clearTimeout(u),u=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize"),Ti(mo,this,0)},200)}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===r)return;const c=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&c)&&e.preventDefault()}onKeyDown(e){this.keyPressed=pA(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,n=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,[i,o]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=n.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=r.scrollTop!==o||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){n.scrollLeft=i;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=i)}this.verticalScrolling&&(r.scrollTop=o),this.refreshAll()}syncScrollWithMaster(){if(!yr(El,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),Ti(El,this,!1)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Za(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:r}=this.domBindings,i=this.scrollableElement===r,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),c=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,s)+1,u=a+this.inlineStartOverlay.sumCellSizes(0,o),g=n.hider.style,f=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,c-n.holder.clientHeight),b=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,u-n.holder.clientWidth),w=f()?1:0,y=b()?1:0;if(g.width=`${u+y}px`,g.height=`${c+w}px`,this.scrollbarSize>0){const{scrollHeight:v,scrollWidth:R}=n.wtRootElement,{scrollHeight:T,scrollWidth:M}=n.holder;this.hasScrollbarRight=v<T,this.hasScrollbarBottom=R<M,this.hasScrollbarRight&&n.hider.scrollWidth+this.scrollbarSize>R?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&n.hider.scrollHeight+this.scrollbarSize>v&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return we(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];we(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}function Pw(t,e,n){return(e=Yk(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yk(t){var e=Gk(t,"string");return typeof e=="symbol"?e:e+""}function Gk(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kk{constructor(e){Pw(this,"settings",{}),Pw(this,"defaults",Object.freeze(this.getDefaults())),Le(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);as(r,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?Le(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class dd extends uo{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=qa(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=gh(e,"height",n),o=gh(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let c=e.offsetWidth,u=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const g=e.cloneNode(!1);g.style.overflow="auto",g.style.position="absolute",e.nextElementSibling?r.insertBefore(g,e.nextElementSibling):r.appendChild(g);const f=parseInt(Pr(g,n).height,10);r.removeChild(g),f===0&&(u=0)}u=Math.min(u,l),s.height=i==="auto"?"auto":`${u}px`,c=Math.min(c,a),s.width=`${c}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:u>0,this.hasTableWidth=c>0}this.isTableVisible=ls(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let c=0;c<o;c++)for(let u=-1*a;u<l;u++)this.markIfOversizedColumnHeader(u);n.hasOversizedColumnHeadersMarked[r]=!0}}}et(dd,ed),et(dd,Rl);class Zk{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new NH:new LH],["fullyVisible",()=>new TH],["partiallyVisible",()=>new tw]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new HH:new DH],["fullyVisible",()=>new SH],["partiallyVisible",()=>new ew]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=Qt(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:n,rootWindow:r}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer,o=n.documentElement.offsetWidth,s=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),c=this.wtTable.TABLE.getBoundingClientRect(),u=l?c.right-o:c.left,d=o-u;let g,f;if(a)return lt(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?g=Math.min(d,o):g=Math.min(this.getContainerFillWidth(),d,o),i===r&&s>0&&this.sumColumnWidths(0,s-1)>g)return n.documentElement.clientWidth;if(i!==r&&(f=gh(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",r),f==="scroll"||f==="hidden"||f==="auto"))return Math.max(g,i.clientWidth);const b=e.getSetting("stretchH");return b==="none"||!b?Math.max(g,lt(this.wtTable.TABLE)):g}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",e.appendChild(n);const r=n.offsetWidth;return this.containerWidth=r,e.removeChild(n),r}getWorkspaceOffset(){return Xt(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Qt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=lt(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),c=n.getSetting("fixedRowsBottom"),u=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),c&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(u-c,u),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=It(this.domBindings.rootDocument),new YH({calculationTypes:e.map(d=>[d,this.rowsCalculatorTypes.get(d)()]),viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),rowHeightFn:d=>r.getRowHeight(d),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=It(this.domBindings.rootDocument)),new VH({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,r=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const o=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!n.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=r.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.rowsPartiallyVisibleCalculator.startRow,r=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:o}=this.rowsRenderCalculator;return n<i||n===i&&n>0?!1:!(r>o||r===o&&r<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.columnsPartiallyVisibleCalculator.startColumn,r=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:o}=this.columnsRenderCalculator;return n<i||n===i&&n>0?!1:!(r>o||r===o&&r<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){Le(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}class qk extends Qh{constructor(e,n){super(e,new Kk(n));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new dd(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new Zk(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new Ik(this.wtSettings.getSetting("selections")),this.wtEvent=new cw(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new Uk(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];Le(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),Ge(this.wtTable.wtRootElement.parentNode,n),Ee(this.wtTable.wtRootElement.parentNode,r)}getOverlayByName(e){var n;if(!vw.includes(e))return null;const r=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(n=this.wtOverlays[`${r}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class fd{constructor(e){e instanceof Qh?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new fd(n);return()=>r},this._wot=new qk(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r,i,o){return this._wot.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wot.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wot.scrollViewportVertically(e,n,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function Nw(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,c=o.isSelectedByCorner(),u=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(c||u)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):c&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):u&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!c&&!u&&i.col<0||c&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!c&&!u&&i.row<0||u&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const d=!o.inInSelection(i),g=n||r&&d;i.row<0&&i.col>=0&&!s.column?g&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?g&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?g&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function Xk(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),c=r.tableProps.countRows();r.markSource("mouse"),a&&!i.column?r.setRangeEnd(o(c-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n),r.markEndSource()}const Qk=new Map([["mousedown",Nw],["mouseover",Xk],["touchstart",Nw]]);function Dw(t,e){let{coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;Qk.get(t.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:_1(t)||t.type==="touchstart",isRightClick:nl(t)})}const Lw=new WeakMap,md=Symbol("rootInstance");function Jk(t){Lw.set(t,!0)}function eP(t){return t===md}function Ol(t){return Lw.has(t)}function tP(t,e){Fw(t,e),e.add(t)}function Ei(t,e,n){Fw(t,e),e.set(t,n)}function Fw(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zr(t,e,n){return(e=nP(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nP(t){var e=rP(t,"string");return typeof e=="symbol"?e:e+""}function rP(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mt(t,e){return t.get(Is(t,e))}function dn(t,e,n){return t.set(Is(t,e),n),n}function Is(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var gd=new WeakMap,Ml=new WeakMap,Al=new WeakMap,Cr=new WeakMap,An=new WeakMap,pd=new WeakMap,wd=new WeakMap,Il=new WeakSet;class iP{constructor(e){tP(this,Il),zr(this,"hot",void 0),zr(this,"eventManager",void 0),zr(this,"settings",void 0),zr(this,"THEAD",void 0),zr(this,"TBODY",void 0),zr(this,"_wt",void 0),zr(this,"activeWt",void 0),Ei(this,gd,0),Ei(this,Ml,0),zr(this,"postponedAdjustElementsSize",!1),Ei(this,Al,!1),Ei(this,Cr,void 0),Ei(this,An,void 0),Ei(this,pd,0),Ei(this,wd,0),this.hot=e,this.eventManager=new pi(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r,i,o){return this._wt.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wt.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wt.scrollViewportVertically(e,n,r)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),Ee(e,"handsontable"),dn(An,this,n.createElement("TABLE")),Ee(mt(An,this),"htCore"),this.hot.getSettings().tableClassName&&Ee(mt(An,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Fe(mt(An,this),[mr()]),Fe(e,[wM(),Wp(-1),Ga(this.hot.countCols()),RM()])),this.THEAD=n.createElement("THEAD"),mt(An,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),mt(An,this).appendChild(this.TBODY),this.hot.table=mt(An,this),this.hot.container.insertBefore(mt(An,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r,rootWindow:i}=this.hot,o=n.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{dn(Al,this,!0),this.isTextSelectionAllowed(a.target)||(Qp(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{dn(Al,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{mt(Al,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&Qp(i),a.preventDefault())}),this.eventManager.addEventListener(o,"keyup",a=>{r.isInProgress()&&!a.shiftKey&&r.finish()}),this.eventManager.addEventListener(o,"mouseup",a=>{r.isInProgress()&&_1(a)&&r.finish(),dn(Cr,this,!1);const l=e1(n.activeElement);Qa(n.activeElement)&&!l||(l||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(a.target)&&!nl(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",a=>{r.isInProgress()&&nl(a)&&(r.finish(),dn(Cr,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{r.isInProgress()&&r.finish(),dn(Cr,this,!1)}),this.eventManager.addEventListener(o,"mousedown",a=>{const l=a.target,c=a.x||a.clientX,u=a.y||a.clientY;let d=a.target;if(mt(Cr,this)||!e||!this.hot.view)return;const{holder:g}=this._wt.wtTable;if(d===g){const b=It(n);if(n.elementFromPoint(c+b,u)!==g||n.elementFromPoint(c,u+b)!==g)return}else for(;d!==o;){if(d===null){if(a.isTargetWebComponent)break;return}if(d===e)return;d=d.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=os(i);for(;s!==null;)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=os(s);this.eventManager.addEventListener(mt(An,this),"selectstart",a=>{this.settings.fragmentSelection||Qa(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:mt(An,this),isDataViewInstance:()=>Ol(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),dn(Ml,this,o.length),this.hot.getSettings().ariaTags&&Is(Il,this,$w).call(this)===this.hot.countCols()&&Is(Il,this,oP).call(this,mt(Ml,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),dn(gd,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,c]=this.translateFromRenderableToVisualIndex(o,s),u=this.hot.runHooks("modifyGetCellCoords",l,c);let d=l,g=c;Array.isArray(u)&&([d,g]=u);const f=this.hot.getCellMeta(d,g),b=this.hot.colToProp(g);let w=this.hot.getDataAtRowProp(d,b);this.hot.hasHook("beforeValueRender")&&(w=this.hot.runHooks("beforeValueRender",w,f)),this.hot.runHooks("beforeRenderer",a,l,c,b,w,f),this.hot.getCellRenderer(f)(this.hot,a,l,c,b,w,f),this.hot.runHooks("afterRenderer",a,l,c,b,w,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&ls(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const c=this.translateFromRenderableToVisualCoords(s),u={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,dn(Cr,this,!0),this.hot.runHooks("beforeOnCellMouseDown",o,c,a,u),!mi(o)&&(Dw(o,{coords:c,selection:this.hot.selection,controller:u,cellCoordsFactory:(d,g)=>this.hot._createCellCoords(d,g)}),this.hot.runHooks("afterOnCellMouseDown",o,c,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const c=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,dn(Cr,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,c,a),!mi(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,c,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const c=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,c,a),!mi(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,c,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const c=this.translateFromRenderableToVisualCoords(s),u={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,c,a,u),!mi(o)&&(mt(Cr,this)&&Dw(o,{coords:c,selection:this.hot.selection,controller:u,cellCoordsFactory:(d,g)=>this.hot._createCellCoords(d,g)}),this.hot.runHooks("afterOnCellMouseOver",o,c,a),this.activeWt=this._wt)},onCellMouseUp:(o,s,a,l)=>{const c=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,c,a),!(mi(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,c,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:o=>{const s=this.hot.rowIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollVertically",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onBeforeViewportScrollHorizontally:o=>{const s=this.hot.columnIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollHorizontally",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,c=o<0;let u=o;c||(u=l.getVisualFromRenderableIndex(o));const d=this.hot.runHooks("beforeHighlightingRowHeader",u,s,a);return c?d:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(d,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,c=o<0;let u=o;c||(u=l.getVisualFromRenderableIndex(o));const d=this.hot.runHooks("beforeHighlightingColumnHeader",u,s,a);return c?d:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(d,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[c,u]=this.translateFromRenderableToVisualIndex(o,s),d=this.hot.selection.getSelectedRange();if(d.size()>0){const f=d.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",c,u,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,c,u]=o,d=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(c),this.hot.columnIndexMapper.getVisualFromRenderableIndex(u)];return this.hot.runHooks("beforeDrawBorders",d,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(o,s)=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.runHooks("beforeStretchingColumnWidth",o,a)},onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a)=>{const l=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,u=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?l.getVisualFromRenderableIndex(o):o,g=this.hot.runHooks("modifyGetCellCoords",d,u,a);if(Array.isArray(g)){const[f,b,w,y]=g;return[f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f,b>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(b,1)):b,w>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(w,-1)):w,y>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(y,-1)):y]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,c=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(c+s,a-1);else if(s==="auto"){const u=Math.ceil(c/a*12);o.startRow=Math.max(l-u,0),o.endRow=Math.min(c+u,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,c=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(c+s,a-1)),s==="auto"){const u=Math.ceil(c/a*6);o.startColumn=Math.max(l-u,0),o.endColumn=Math.min(c+u,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new fd(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(Qa(e))return!0;const n=dh(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return mt(Cr,this)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!Ye(r,"relative")){Ji(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(n.firstChild){const s=n.firstChild;Ye(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,r,i),s.className="",Ee(s,["relative",...o()])):(Ji(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),c=o();a.classList.add("relative",...c),l.className="colHeader",this.settings.ariaTags&&(Fe(a,...mr()),Fe(l,...mr())),this.updateCellHeader(l,e,r,i),a.appendChild(l),n.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Ye(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):Ye(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?MM(e,r(n,i)):(as(e," "),Ee(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){dn(pd,this,e),dn(wd,this,n)}getLastSize(){return{width:mt(pd,this),height:mt(wd,this)}}getFirstRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedRow(),1):null}getLastRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedRow(),-1):null}getFirstRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedColumn(),1):null}getLastRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedColumn(),-1):null}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return mt(gd,this)}getRowHeadersCount(){return mt(Ml,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}isVisible(){return this._wt.wtTable.isVisible()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function $w(){return parseInt(this.hot.rootElement.getAttribute(Ga()[0]),10)}function oP(t){const e=Is(Il,this,$w).call(this)+t;Fe(this.hot.rootElement,...Ga(e))}const Ww="ABCDEFGHIJKLMNOPQRSTUVWXYZ".length;function sP(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%Ww,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/Ww,10);return n}function Bw(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&an(t[0])&&(e=yh(t[0]))),e}function Hs(t,e,n){return(e=aP(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aP(t){var e=lP(t,"string");return typeof e=="symbol"?e:e+""}function lP(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cP{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Hs(this,"hot",void 0),Hs(this,"data",void 0),Hs(this,"dataType","array"),Hs(this,"colToProp",()=>{}),Hs(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return we(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((c,u)=>{l[u]=this.getAtPhysicalCell(e,u,a)}):dt(n,r,c=>{l[c-n]=this.getAtPhysicalCell(e,c,a)});else if(an(a)||Ke(a))if(i?l=[]:l={},!o||i){const u=this.countFirstRowKeys()-1;dt(0,u,d=>{const g=this.colToProp(d);if(d>=(n||0)&&d<=(r||u)&&!Number.isInteger(g)){const f=this.getAtPhysicalCell(e,g,a);i?l.push(f):s?vh(l,g,f):l[g]=f}})}else Le(a,(c,u)=>{const d=this.getAtPhysicalCell(e,u,a);s?vh(l,u,d):l[u]=d});return l}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Tn(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}Number.isInteger(n)?this.data[e][n]=r:vh(this.data[e],n,r)}}getAtPhysicalCell(e,n,r){let i=null;if(r)if(typeof n=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?rA(r,n):r[n]}else typeof n=="function"?i=n(r):i=r[n];if(this.hot.hasHook("modifySourceData")){const o=Tn(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const c=[];return dt(o,a,u=>{c.push(i?this.getAtRow(u,void 0,void 0,r):this.getAtRow(u,s,l,r))}),c}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return Bw(this.data)}destroy(){this.data=null,this.hot=null}}function Vw(t,e,n){return(e=uP(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uP(t){var e=hP(t,"string");return typeof e=="symbol"?e:e+""}function hP(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ks{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Vw(this,"indexedValues",[]),Vw(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Ke(this.initValueOrFn)?dt(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):dt(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}et(ks,br);function zw(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>Ke(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function jw(t,e){return sh(t,(n,r)=>e.includes(r)===!1)}class Hl extends ks{insert(e,n){this.indexedValues=zw(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=jw(this.indexedValues,e),super.remove(e)}}class Uw extends Hl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return ts(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function Yw(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function kl(t,e){return sh(t,n=>e.includes(n)===!1)}function Gw(t,e){return hi(t,n=>n-e.filter(r=>r<n).length)}function Kw(t,e){const n=e[0],r=e.length;return hi(t,i=>i>=n?i+r:i)}function dP(t,e,n){return(e=fP(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fP(t){var e=mP(t,"string");return typeof e=="symbol"?e:e+""}function mP(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gP extends ks{constructor(){super(...arguments),dP(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=kl(this.orderOfIndexes,[e]),Ke(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=zw(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=Kw(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=jw(this.indexedValues,e),this.orderOfIndexes=kl(this.orderOfIndexes,e),this.orderOfIndexes=Gw(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Zw extends Hl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return ts(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}class pP extends ks{constructor(){super(e=>e)}insert(e,n){const r=Kw(this.indexedValues,n);this.indexedValues=Yw(r,e,n),super.insert(e,n)}remove(e){const n=kl(this.indexedValues,e);this.indexedValues=Gw(n,e),super.remove(e)}}const qw=new Map([["hiding",Uw],["index",ks],["linkedPhysicalIndexToValue",gP],["physicalIndexToValue",Hl],["trimming",Zw]]);function wP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!qw.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(qw.get(t))(e)}function bP(t,e,n){return(e=vP(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vP(t){var e=yP(t,"string");return typeof e=="symbol"?e:e+""}function yP(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bd{constructor(){bP(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)))}unregister(e){const n=this.collection.get(e);Me(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n))}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return Ft(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}et(bd,br);function vd(t,e,n){return(e=CP(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CP(t){var e=SP(t,"string");return typeof e=="symbol"?e:e+""}function SP(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xw extends bd{constructor(e,n){super(),vd(this,"mergedValuesCache",[]),vd(this,"aggregationFunction",void 0),vd(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=hi(this.get(),o=>o.getValues()),r=[],i=Me(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return hi(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return Me(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function RP(t,e,n){_P(t,e),e.set(t,n)}function _P(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function TP(t,e,n){return t.set(Qw(t,e),n),n}function EP(t,e){return t.get(Qw(t,e))}function Qw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var yd=new WeakMap;class Jw{constructor(){RP(this,yd,[])}subscribe(e){return this.addLocalHook("change",e),this._write(EP(yd,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){TP(yd,this,e)}}et(Jw,br);function eb(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function Ps(t,e,n){xP(t,e),e.set(t,n)}function xP(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fn(t,e){return t.get(tb(t,e))}function Pl(t,e,n){return t.set(tb(t,e),n),n}function tb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Nl=new WeakMap,Ns=new WeakMap,Dl=new WeakMap,Ll=new WeakMap,Fl=new WeakMap;class OP{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ps(this,Nl,new Set),Ps(this,Ns,[]),Ps(this,Dl,[]),Ps(this,Ll,!1),Ps(this,Fl,!1),Pl(Fl,this,e??!1)}createObserver(){const e=new Jw;return fn(Nl,this).add(e),e.addLocalHook("unsubscribe",()=>{fn(Nl,this).delete(e)}),e._writeInitialChanges(eb(fn(Ns,this),fn(Dl,this))),e}emit(e){let n=fn(Dl,this);(!fn(Ll,this)||fn(Ns,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(fn(Fl,this)):Pl(Ns,this,new Array(e.length).fill(fn(Fl,this))),fn(Ll,this)||(Pl(Ll,this,!0),n=fn(Ns,this)));const r=eb(n,e);fn(Nl,this).forEach(i=>i._write(r)),Pl(Dl,this,e)}}function Ht(t,e,n){return(e=MP(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MP(t){var e=AP(t,"string");return typeof e=="symbol"?e:e+""}function AP(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cd{constructor(){Ht(this,"indexesSequence",new pP),Ht(this,"trimmingMapsCollection",new Xw(e=>e.some(n=>n===!0),!1)),Ht(this,"hidingMapsCollection",new Xw(e=>e.some(n=>n===!0),!1)),Ht(this,"variousMapsCollection",new bd),Ht(this,"hidingChangesObservable",new OP({initialIndexValue:!1})),Ht(this,"notTrimmedIndexesCache",[]),Ht(this,"notHiddenIndexesCache",[]),Ht(this,"isBatched",!1),Ht(this,"indexesSequenceChanged",!1),Ht(this,"indexesChangeSource",void 0),Ht(this,"trimmedIndexesChanged",!1),Ht(this,"hiddenIndexesChanged",!1),Ht(this,"renderablePhysicalIndexesCache",[]),Ht(this,"fromPhysicalToVisualIndexesCache",new Map),Ht(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,wP(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Zw?this.trimmingMapsCollection.register(e,n):n instanceof Uw?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return Me(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return Me(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return Me(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return Me(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=hi(e,c=>this.getPhysicalFromVisualIndex(c)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=kl(this.getIndexesSequence(),r),a=s.filter(c=>this.isTrimmed(c)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const c=a[n];l=s.indexOf(c)}this.indexesChangeSource="move",this.setIndexesSequence(Yw(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const r=this.getNotTrimmedIndexes()[e],i=Me(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),s=hi(new Array(n).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}et(Cd,br);function IP(t,e){return Le(e,(n,r)=>{Ft(t[r])&&(t[r]=n)}),t}function nb(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function rb(t){Me(t)&&$A(qt`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function HP(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:kP,getValues:PP}=io("phraseFormatters");function NP(t,e){kP(t,e)}function DP(){return PP()}NP("pluralize",HP);const ib="ContextMenu:items",Se=ib,ob=`${Se}.noItems`,sb=`${Se}.insertRowAbove`,ab=`${Se}.insertRowBelow`,lb=`${Se}.insertColumnOnTheLeft`,cb=`${Se}.insertColumnOnTheRight`,ub=`${Se}.removeRow`,hb=`${Se}.removeColumn`,db=`${Se}.undo`,fb=`${Se}.redo`,mb=`${Se}.readOnly`,gb=`${Se}.clearColumn`,Sd=`${Se}.copy`,Rd=`${Se}.copyWithHeaders`,_d=`${Se}.copyWithGroupHeaders`,Td=`${Se}.copyHeadersOnly`,Ed=`${Se}.cut`,pb=`${Se}.freezeColumn`,wb=`${Se}.unfreezeColumn`,bb=`${Se}.mergeCells`,vb=`${Se}.unmergeCells`,yb=`${Se}.addComment`,Cb=`${Se}.editComment`,Sb=`${Se}.removeComment`,Rb=`${Se}.readOnlyComment`,_b=`${Se}.align`,Tb=`${Se}.align.left`,Eb=`${Se}.align.center`,xb=`${Se}.align.right`,Ob=`${Se}.align.justify`,Mb=`${Se}.align.top`,Ab=`${Se}.align.middle`,Ib=`${Se}.align.bottom`,Hb=`${Se}.borders`,kb=`${Se}.borders.top`,Pb=`${Se}.borders.right`,Nb=`${Se}.borders.bottom`,Db=`${Se}.borders.left`,Lb=`${Se}.borders.remove`,Fb=`${Se}.nestedHeaders.insertChildRow`,$b=`${Se}.nestedHeaders.detachFromParent`,Wb=`${Se}.hideColumn`,Bb=`${Se}.showColumn`,Vb=`${Se}.hideRow`,zb=`${Se}.showRow`,Vt="Filters:",Qe=`${Vt}conditions`,jb=`${Qe}.none`,Ub=`${Qe}.isEmpty`,Yb=`${Qe}.isNotEmpty`,Gb=`${Qe}.isEqualTo`,Kb=`${Qe}.isNotEqualTo`,Zb=`${Qe}.beginsWith`,qb=`${Qe}.endsWith`,Xb=`${Qe}.contains`,Qb=`${Qe}.doesNotContain`,LP=`${Qe}.byValue`,Jb=`${Qe}.greaterThan`,e0=`${Qe}.greaterThanOrEqualTo`,t0=`${Qe}.lessThan`,n0=`${Qe}.lessThanOrEqualTo`,r0=`${Qe}.isBetween`,i0=`${Qe}.isNotBetween`,o0=`${Qe}.after`,s0=`${Qe}.before`,a0=`${Qe}.today`,l0=`${Qe}.tomorrow`,c0=`${Qe}.yesterday`,u0=`${Vt}labels.filterByCondition`,h0=`${Vt}labels.filterByValue`,d0=`${Vt}labels.conjunction`,f0=`${Vt}labels.disjunction`,m0=`${Vt}values.blankCells`,g0=`${Vt}buttons.selectAll`,p0=`${Vt}buttons.clear`,w0=`${Vt}buttons.ok`,b0=`${Vt}buttons.cancel`,v0=`${Vt}buttons.placeholder.search`,y0=`${Vt}buttons.placeholder.value`,C0=`${Vt}buttons.placeholder.secondValue`,xd="CheckboxRenderer:",S0=`${xd}checked`,R0=`${xd}unchecked`,FP=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:S0,CHECKBOX_RENDERER_NAMESPACE:xd,CHECKBOX_UNCHECKED:R0,CONTEXTMENU_ITEMS_ADD_COMMENT:yb,CONTEXTMENU_ITEMS_ALIGNMENT:_b,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:Ib,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:Eb,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:Ob,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:Tb,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:Ab,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:xb,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:Mb,CONTEXTMENU_ITEMS_BORDERS:Hb,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:Nb,CONTEXTMENU_ITEMS_BORDERS_LEFT:Db,CONTEXTMENU_ITEMS_BORDERS_RIGHT:Pb,CONTEXTMENU_ITEMS_BORDERS_TOP:kb,CONTEXTMENU_ITEMS_CLEAR_COLUMN:gb,CONTEXTMENU_ITEMS_COPY:Sd,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:Td,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:_d,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:Rd,CONTEXTMENU_ITEMS_CUT:Ed,CONTEXTMENU_ITEMS_EDIT_COMMENT:Cb,CONTEXTMENU_ITEMS_FREEZE_COLUMN:pb,CONTEXTMENU_ITEMS_HIDE_COLUMN:Wb,CONTEXTMENU_ITEMS_HIDE_ROW:Vb,CONTEXTMENU_ITEMS_INSERT_LEFT:lb,CONTEXTMENU_ITEMS_INSERT_RIGHT:cb,CONTEXTMENU_ITEMS_MERGE_CELLS:bb,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:$b,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:Fb,CONTEXTMENU_ITEMS_NO_ITEMS:ob,CONTEXTMENU_ITEMS_READ_ONLY:mb,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:Rb,CONTEXTMENU_ITEMS_REDO:fb,CONTEXTMENU_ITEMS_REMOVE_BORDERS:Lb,CONTEXTMENU_ITEMS_REMOVE_COLUMN:hb,CONTEXTMENU_ITEMS_REMOVE_COMMENT:Sb,CONTEXTMENU_ITEMS_REMOVE_ROW:ub,CONTEXTMENU_ITEMS_ROW_ABOVE:sb,CONTEXTMENU_ITEMS_ROW_BELOW:ab,CONTEXTMENU_ITEMS_SHOW_COLUMN:Bb,CONTEXTMENU_ITEMS_SHOW_ROW:zb,CONTEXTMENU_ITEMS_UNDO:db,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:wb,CONTEXTMENU_ITEMS_UNMERGE_CELLS:vb,CONTEXT_MENU_ITEMS_NAMESPACE:ib,FILTERS_BUTTONS_CANCEL:b0,FILTERS_BUTTONS_CLEAR:p0,FILTERS_BUTTONS_OK:w0,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:v0,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:C0,FILTERS_BUTTONS_PLACEHOLDER_VALUE:y0,FILTERS_BUTTONS_SELECT_ALL:g0,FILTERS_CONDITIONS_AFTER:o0,FILTERS_CONDITIONS_BEFORE:s0,FILTERS_CONDITIONS_BEGINS_WITH:Zb,FILTERS_CONDITIONS_BETWEEN:r0,FILTERS_CONDITIONS_BY_VALUE:LP,FILTERS_CONDITIONS_CONTAINS:Xb,FILTERS_CONDITIONS_EMPTY:Ub,FILTERS_CONDITIONS_ENDS_WITH:qb,FILTERS_CONDITIONS_EQUAL:Gb,FILTERS_CONDITIONS_GREATER_THAN:Jb,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:e0,FILTERS_CONDITIONS_LESS_THAN:t0,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:n0,FILTERS_CONDITIONS_NAMESPACE:Qe,FILTERS_CONDITIONS_NONE:jb,FILTERS_CONDITIONS_NOT_BETWEEN:i0,FILTERS_CONDITIONS_NOT_CONTAIN:Qb,FILTERS_CONDITIONS_NOT_EMPTY:Yb,FILTERS_CONDITIONS_NOT_EQUAL:Kb,FILTERS_CONDITIONS_TODAY:a0,FILTERS_CONDITIONS_TOMORROW:l0,FILTERS_CONDITIONS_YESTERDAY:c0,FILTERS_DIVS_FILTER_BY_CONDITION:u0,FILTERS_DIVS_FILTER_BY_VALUE:h0,FILTERS_LABELS_CONJUNCTION:d0,FILTERS_LABELS_DISJUNCTION:f0,FILTERS_NAMESPACE:Vt,FILTERS_VALUES_BLANK_CELLS:m0},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const _0={languageCode:"en-US",[ob]:"No available options",[sb]:"Insert row above",[ab]:"Insert row below",[lb]:"Insert column left",[cb]:"Insert column right",[ub]:["Remove row","Remove rows"],[hb]:["Remove column","Remove columns"],[db]:"Undo",[fb]:"Redo",[mb]:"Read only",[gb]:"Clear column",[_b]:"Alignment",[Tb]:"Left",[Eb]:"Center",[xb]:"Right",[Ob]:"Justify",[Mb]:"Top",[Ab]:"Middle",[Ib]:"Bottom",[pb]:"Freeze column",[wb]:"Unfreeze column",[Hb]:"Borders",[kb]:"Top",[Pb]:"Right",[Nb]:"Bottom",[Db]:"Left",[Lb]:"Remove border(s)",[yb]:"Add comment",[Cb]:"Edit comment",[Sb]:"Delete comment",[Rb]:"Read-only comment",[bb]:"Merge cells",[vb]:"Unmerge cells",[Sd]:"Copy",[Rd]:["Copy with header","Copy with headers"],[_d]:["Copy with group header","Copy with group headers"],[Td]:["Copy header only","Copy headers only"],[Ed]:"Cut",[Fb]:"Insert child row",[$b]:"Detach from parent",[Wb]:["Hide column","Hide columns"],[Bb]:["Show column","Show columns"],[Vb]:["Hide row","Hide rows"],[zb]:["Show row","Show rows"],[jb]:"None",[Ub]:"Is empty",[Yb]:"Is not empty",[Gb]:"Is equal to",[Kb]:"Is not equal to",[Zb]:"Begins with",[qb]:"Ends with",[Xb]:"Contains",[Qb]:"Does not contain",[Jb]:"Greater than",[e0]:"Greater than or equal to",[t0]:"Less than",[n0]:"Less than or equal to",[r0]:"Is between",[i0]:"Is not between",[o0]:"After",[s0]:"Before",[a0]:"Today",[l0]:"Tomorrow",[c0]:"Yesterday",[m0]:"Blank cells",[u0]:"Filter by condition",[h0]:"Filter by value",[d0]:"And",[f0]:"Or",[g0]:"Select all",[p0]:"Clear",[w0]:"OK",[b0]:"Cancel",[v0]:"Search",[y0]:"Value",[C0]:"Second value",[S0]:"Checked",[R0]:"Unchecked"},$P=FP,Od=_0.languageCode,{register:WP,getItem:T0,hasItem:BP,getValues:VP}=io("languagesDictionaries");E0(_0);function E0(t,e){let n=t,r=e;return an(t)&&(r=t,n=r.languageCode),zP(n,r),WP(n,Dr(r)),Dr(r)}function zP(t,e){t!==Od&&IP(e,T0(Od))}function x0(t){return Md(t)?Dr(T0(t)):null}function Md(t){return BP(t)}function jP(){return VP()}function O0(t,e,n){const r=x0(t);if(r===null)return null;const i=r[e];if(Ft(i))return null;const o=UP(i,n);return Array.isArray(o)?o[0]:o}function UP(t,e){let n=t;return we(DP(),r=>{n=r(t,e)}),n}function YP(t){let e=nb(t);return Md(e)||(e=Od,rb(t)),e}function GP(t,e,n){return(e=KP(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KP(t){var e=ZP(t,"string");return typeof e=="symbol"?e:e+""}function ZP(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sr extends Rw{constructor(e,n){super(e,null),GP(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}function Ad(t){let{activeHeaderClassName:e,...n}=t;return new Sr({className:e,...n,selectionType:Sk})}function qP(t){let{areaCornerVisible:e,...n}=t;return new Sr({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:nd})}function XP(t){let{...e}=t;return new Sr({className:"highlight",...e,selectionType:nd})}function QP(t){let{columnClassName:e,...n}=t;return new Sr({className:e,...n,selectionType:Tk})}function JP(t){let{cellCornerVisible:e,...n}=t;return new Sr({className:"current",headerAttributes:[jp()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:rd})}function e6(t){let{border:e,visualCellRange:n,...r}=t;return new Sr({...e,...r,selectionType:Ek},n)}function t6(t){let{...e}=t;return new Sr({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:Rk})}function M0(t){let{headerClassName:e,...n}=t;return new Sr({className:e,...n,selectionType:_w})}function n6(t){let{rowClassName:e,...n}=t;return new Sr({className:e,...n,selectionType:_k})}function r6(t,e){i6(t,e),e.add(t)}function i6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zt(t,e,n){return(e=o6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o6(t){var e=s6(t,"string");return typeof e=="symbol"?e:e+""}function s6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Jn=new WeakSet;class a6{constructor(e){r6(this,Jn),zt(this,"options",void 0),zt(this,"layerLevel",0),zt(this,"focus",void 0),zt(this,"fill",void 0),zt(this,"layeredAreas",new Map),zt(this,"areas",new Map),zt(this,"rowHeaders",new Map),zt(this,"columnHeaders",new Map),zt(this,"activeRowHeaders",new Map),zt(this,"activeColumnHeaders",new Map),zt(this,"activeCornerHeaders",new Map),zt(this,"rowHighlights",new Map),zt(this,"columnHighlights",new Map),zt(this,"customSelections",[]),this.options=e,this.focus=JP(e),this.fill=t6(e)}isEnabledFor(e,n){let r=e;e===rd&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Rr(Jn,this,_r).call(this,this.layeredAreas,qP)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Rr(Jn,this,_r).call(this,this.areas,XP)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Rr(Jn,this,_r).call(this,this.rowHeaders,M0)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Rr(Jn,this,_r).call(this,this.columnHeaders,M0)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Rr(Jn,this,_r).call(this,this.activeRowHeaders,Ad)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Rr(Jn,this,_r).call(this,this.activeColumnHeaders,Ad)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Rr(Jn,this,_r).call(this,this.activeCornerHeaders,Ad)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Rr(Jn,this,_r).call(this,this.rowHighlights,n6)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Rr(Jn,this,_r).call(this,this.columnHighlights,QP)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(e6({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),we(this.areas.values(),e=>void e.clear()),we(this.layeredAreas.values(),e=>void e.clear()),we(this.rowHeaders.values(),e=>void e.clear()),we(this.columnHeaders.values(),e=>void e.clear()),we(this.activeRowHeaders.values(),e=>void e.clear()),we(this.activeColumnHeaders.values(),e=>void e.clear()),we(this.activeCornerHeaders.values(),e=>void e.clear()),we(this.rowHighlights.values(),e=>void e.clear()),we(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function _r(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}function A0(t,e,n){return(e=l6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l6(t){var e=c6(t,"string");return typeof e=="symbol"?e:e+""}function c6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class u6{constructor(e){A0(this,"ranges",[]),A0(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function h6(t,e){I0(t,e),e.add(t)}function Id(t,e,n){I0(t,e),e.set(t,n)}function I0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ie(t,e){return t.get(it(t,e))}function $l(t,e,n){return t.set(it(t,e),n),n}function it(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Wl=new WeakMap,$e=new WeakMap,In=new WeakMap,ut=new WeakSet;class Hd{constructor(e,n){h6(this,ut),Id(this,Wl,void 0),Id(this,$e,void 0),Id(this,In,{x:0,y:0}),$l(Wl,this,e),$l($e,this,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=Ie($e,this).createCellCoords(e,n);let o=Ie(Wl,this).current().highlight;const s=Ie($e,this).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:c,height:u}=it(ut,this,k0).call(this),{row:d,col:g}=it(ut,this,P0).call(this,o),f=Ie($e,this).fixedRowsBottom(),b=Ie($e,this).minSpareRows(),w=Ie($e,this).minSpareCols(),y=Ie($e,this).autoWrapRow(),v=Ie($e,this).autoWrapCol(),R=Ie($e,this).createCellCoords(d+i.row,g+i.col);if(R.row>=u){const I=Tn(r&&b>0&&f===0),L=R.col+1,N=Ie($e,this).createCellCoords(R.row-u,L>=c?L-c:L);this.runLocalHooks("beforeColumnWrap",I,it(ut,this,go).call(this,N),L>=c),I.value?this.runLocalHooks("insertRowRequire",Ie($e,this).countRenderableRows()):v&&R.assign(N)}else if(R.row<0){const I=Tn(v),L=R.col-1,N=Ie($e,this).createCellCoords(u+R.row,L<0?c+L:L);this.runLocalHooks("beforeColumnWrap",I,it(ut,this,go).call(this,N),L<0),v&&R.assign(N)}if(R.col>=c){const I=Tn(r&&w>0),L=R.row+1,N=Ie($e,this).createCellCoords(L>=u?L-u:L,R.col-c);this.runLocalHooks("beforeRowWrap",I,it(ut,this,go).call(this,N),L>=u),I.value?this.runLocalHooks("insertColRequire",Ie($e,this).countRenderableColumns()):y&&R.assign(N)}else if(R.col<0){const I=Tn(y),L=R.row-1,N=Ie($e,this).createCellCoords(L<0?u+L:L,c+R.col);this.runLocalHooks("beforeRowWrap",I,it(ut,this,go).call(this,N),L<0),y&&R.assign(N)}const{rowDir:T,colDir:M}=it(ut,this,H0).call(this,R);a=T,l=M,o=it(ut,this,go).call(this,R)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){const r=Ie($e,this).createCellCoords(e,n),i=Ie(Wl,this).current(),o=Ie($e,this).visualToRenderableCoords(i.highlight),s=it(ut,this,kd).call(this,i.to.row,i.from.row),a=it(ut,this,Pd).call(this,i.to.col,i.from.col),l=i.to.clone();let c=0,u=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:d,col:g}=it(ut,this,P0).call(this,i.highlight),f=Ie($e,this).createCellCoords(s+r.row,a+r.col),b=i.getTopStartCorner(),w=i.getTopEndCorner(),y=i.getBottomEndCorner();if(r.col<0&&a>=g&&f.col<g){const M=f.col-g;f.col=it(ut,this,Pd).call(this,b.col,w.col)+M}else if(r.col>0&&a<=g&&f.col>g){const M=it(ut,this,Pd).call(this,w.col,b.col),I=Math.max(f.col-M,1);f.col=M+I}if(r.row<0&&s>=d&&f.row<d){const M=f.row-d;f.row=it(ut,this,kd).call(this,b.row,y.row)+M}else if(r.row>0&&s<=d&&f.row>d){const M=it(ut,this,kd).call(this,y.row,b.row),I=Math.max(f.row-M,1);f.row=M+I}const{rowDir:v,colDir:R}=it(ut,this,H0).call(this,f);c=v,u=R;const T=it(ut,this,go).call(this,f);r.row===0&&r.col!==0?l.col=T.col:r.row!==0&&r.col===0?l.row=T.row:(l.row=T.row,l.col=T.col)}return this.runLocalHooks("afterTransformEnd",l,c,u),l}setOffsetSize(e){let{x:n,y:r}=e;$l(In,this,{x:n,y:r})}resetOffsetSize(){$l(In,this,{x:0,y:0})}}function H0(t){const{width:e,height:n}=it(ut,this,k0).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function k0(){return{width:Ie(In,this).x+Ie($e,this).countRenderableColumns(),height:Ie(In,this).y+Ie($e,this).countRenderableRows()}}function kd(t,e){const n=Ie($e,this).findFirstNonHiddenRenderableRow(t,e);return n===null?null:Ie(In,this).y+n}function Pd(t,e){const n=Ie($e,this).findFirstNonHiddenRenderableColumn(t,e);return n===null?null:Ie(In,this).x+n}function P0(t){const{row:e,col:n}=Ie($e,this).visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return Ie($e,this).createCellCoords(Ie(In,this).y+e,Ie(In,this).x+n)}function go(t){const e=t.clone();return e.col=t.col-Ie(In,this).x,e.row=t.row-Ie(In,this).y,Ie($e,this).renderableToVisualCoords(e)}et(Hd,br);const N0=0,D0=1,L0=2,Nd=3,d6=[Nd,L0],f6=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Dd=Symbol("root"),F0=Symbol("child");function $0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Dd;if(e!==Dd&&e!==F0)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===Dd;let i=N0;if(n){const o=t[0];t.length===0?i=D0:r&&o instanceof ys?i=Nd:r&&Array.isArray(o)?i=$0(o,F0):t.length>=2&&t.length<=4&&!t.some((a,l)=>!f6[l].includes(typeof a))&&(i=L0)}return i}function m6(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!d6.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===Nd;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],c=s?o.to.row:o[2],u=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof u=="string"&&(u=i(u))),Ft(c)&&(c=a),Ft(u)&&(u=l),!r){const f=a,b=l,w=c,y=u;a=Math.min(f,w),l=Math.min(b,y),c=Math.max(f,w),u=Math.max(b,y)}const d=e(a,l),g=e(c,u);return n(d,d,g)}}function po(t,e,n){g6(t,e),e.set(t,n)}function g6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xi(t,e,n){return(e=p6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p6(t){var e=w6(t,"string");return typeof e=="symbol"?e:e+""}function w6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function je(t,e){return t.get(W0(t,e))}function er(t,e,n){return t.set(W0(t,e),n),n}function W0(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Tt=new WeakMap,Oi=new WeakMap,Bl=new WeakMap,Ds=new WeakMap,Vl=new WeakMap,Ls=new WeakMap;class B0{constructor(e,n){var r=this;xi(this,"settings",void 0),xi(this,"tableProps",void 0),xi(this,"inProgress",!1),xi(this,"selectedRange",new u6((i,o,s)=>this.tableProps.createCellRange(i,o,s))),xi(this,"highlight",void 0),po(this,Tt,void 0),po(this,Oi,void 0),xi(this,"selectedByRowHeader",new Set),xi(this,"selectedByColumnHeader",new Set),po(this,Bl,!1),po(this,Ds,!1),po(this,Vl,"unknown"),po(this,Ls,-1),this.settings=e,this.tableProps=n,this.highlight=new a6({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[jp()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),er(Tt,this,new Hd(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),er(Oi,this,new Hd(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),je(Tt,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),je(Tt,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),je(Tt,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),je(Tt,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),je(Tt,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),je(Tt,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),je(Tt,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),je(Tt,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)}),je(Oi,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformFocus",...o)}),je(Oi,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){er(Vl,this,e)}markEndSource(){er(Vl,this,"unknown")}getSelectionSource(){return je(Vl,this)}setExpectedLayers(e){er(Ls,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,er(Ls,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Ft(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();er(Bl,this,!1),this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&Ft(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();if(this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single")s.setFrom(s.highlight),s.setTo(s.highlight);else{const l=s.getHorizontalDirection(),c=s.getVerticalDirection(),u=this.isMultiple();s.setTo(n),u&&(l!==s.getHorizontalDirection()||s.getWidth()===1&&!s.includes(s.highlight))&&s.from.assign({col:s.highlight.col}),u&&(c!==s.getVerticalDirection()||s.getHeight()===1&&!s.includes(s.highlight))&&s.from.assign({row:s.highlight.row})}r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=je(Ls,this)===-1||this.selectedRange.size()===je(Ls,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const r=this.tableProps.countRows(),i=this.tableProps.countCols();n<this.highlight.layerLevel&&(we(this.highlight.getAreas(),b=>void b.clear()),we(this.highlight.getLayeredAreas(),b=>void b.clear()),we(this.highlight.getRowHeaders(),b=>void b.clear()),we(this.highlight.getColumnHeaders(),b=>void b.clear()),we(this.highlight.getActiveRowHeaders(),b=>void b.clear()),we(this.highlight.getActiveColumnHeaders(),b=>void b.clear()),we(this.highlight.getActiveCornerHeaders(),b=>void b.clear()),we(this.highlight.getRowHighlights(),b=>void b.clear()),we(this.highlight.getColumnHighlights(),b=>void b.clear())),this.highlight.useLayerLevel(n);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),c=this.highlight.createActiveRowHeader(),u=this.highlight.createActiveColumnHeader(),d=this.highlight.createActiveCornerHeader(),g=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),c.clear(),u.clear(),d.clear(),g.clear(),f.clear(),this.highlight.isEnabledFor(nd,e.highlight)&&(this.isMultiple()||n>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),n===1)){const b=this.selectedRange.previous();this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(b.from).commit().syncWith(b),this.highlight.createLayeredArea().add(b.from).commit().syncWith(b),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(_w,e.highlight)){if(!e.isSingleHeader()){const y=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),v=this.tableProps.createCellCoords(e.to.row,-1),R=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),T=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(y).commit(),l.add(R).commit(),g.add(y).commit(),f.add(R).commit()):(a.add(y).add(v).commit(),l.add(R).add(T).commit(),g.add(y).add(v).commit(),f.add(R).add(T).commit())}const b=!je(Ds,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),w=!je(Ds,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||r===0&&this.isSelectedByColumnHeader());b&&c.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),w&&u.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),b&&w&&d.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const n=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(rd,n.highlight)&&r.add(n.highlight).commit().syncWith(n),this.inProgress||(er(Bl,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?je(Tt,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):je(Tt,this).resetOffsetSize(),this.setRangeStart(je(Tt,this).transformStart(e,n,r))}transformEnd(e,n){this.settings.navigableHeaders?je(Tt,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):je(Tt,this).resetOffsetSize(),this.setRangeEnd(je(Tt,this).transformEnd(e,n))}transformFocus(e,n){const r=this.selectedRange.current(),{row:i,col:o}=r.getOuterTopStartCorner(),s=this.tableProps.countRenderableColumnsInRange(0,o-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);r.highlight.isHeader()?je(Oi,this).setOffsetSize({x:o<0?Math.abs(o):-s,y:i<0?Math.abs(i):-a}):je(Oi,this).setOffsetSize({x:o<0?0:-s,y:i<0?0:-a});const l=je(Oi,this).transformStart(e,n);this.setRangeFocus(l.normalize())}shiftRows(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),c=this.isSelectedByColumnHeader(),u=c?-1:0,d=c?0:n;this.getSelectedRange().pop();const g=this.tableProps.createCellCoords(ze(i.row+d,u,a-1),i.col),f=this.tableProps.createCellCoords(ze(o.row+n,u,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(g,!0,this.tableProps.createCellCoords(ze(s.row+n,0,a-1),s.col)):this.setRangeStartOnly(g,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),c&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),c=this.isSelectedByColumnHeader(),u=l?-1:0,d=l?0:n;this.getSelectedRange().pop();const g=this.tableProps.createCellCoords(i.row,ze(i.col+d,u,a-1)),f=this.tableProps.createCellCoords(o.row,ze(o.col+n,u,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(g,!0,this.tableProps.createCellCoords(s.row,ze(s.col+n,0,a-1))):this.setRangeStartOnly(g,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),c&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=Tn(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&je(Bl,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),c=r?-l:0,u=n?-a:0;if(c===0&&u===0&&(o===0||s===0))return;let d=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:g,disableHeadersHighlight:f}=i;er(Ds,this,f),g&&Number.isInteger(g==null?void 0:g.row)&&Number.isInteger(g==null?void 0:g.col)&&(d=this.tableProps.createCellCoords(ze(g.row,c,o-1),ze(g.col,u,s-1)));const b=this.tableProps.createCellCoords(c,u),w=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(b,void 0,d),u<0&&this.selectedByRowHeader.add(this.getLayerLevel()),c<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(w),this.finish(),er(Ds,this,!1)}selectCells(e){var n=this;const r=$0(e);if(r===D0)return!1;if(r===N0)throw new Error(qt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=m6(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const c=i(l),u=c.isValid(s);return!(u&&!c.containsHeaders()||u&&c.containsHeaders()&&c.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),we(e,l=>{const{from:c,to:u}=i(l);this.setRangeStartOnly(c.clone(),!1),this.setRangeEnd(u.clone())}),this.finish()),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),c=l===0?0:-l,u=this.tableProps.createCellCoords(c,i),d=this.tableProps.createCellCoords(s-1,o),g=this.tableProps.createCellRange(u,u,d).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(g){let f=0,b=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(f=ze(r.row,c,s-1),b=ze(r.col,Math.min(i,o),Math.max(i,o))):(f=ze(r,c,s-1),b=i);const w=this.tableProps.createCellCoords(f,b),y=l===0?0:ze(w.row,c,-1),v=s-1,R=this.tableProps.createCellCoords(y,i),T=this.tableProps.createCellCoords(v,o);this.runLocalHooks("beforeSelectColumns",R,T,w),R.row=y,T.row=v,this.setRangeStartOnly(R,void 0,w),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.runLocalHooks("afterSelectColumns",R,T,w),this.finish()}return g}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),c=this.tableProps.createCellCoords(n,o-1),u=this.tableProps.createCellRange(l,l,c).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(u){let d=0,g=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(d=ze(r.row,Math.min(e,n),Math.max(e,n)),g=ze(r.col,a,o-1)):(d=e,g=ze(r,a,o-1));const f=this.tableProps.createCellCoords(d,g),b=s===0?0:ze(f.col,a,-1),w=o-1,y=this.tableProps.createCellCoords(e,b),v=this.tableProps.createCellCoords(n,w);this.runLocalHooks("beforeSelectRows",y,v,f),y.col=b,v.col=w,this.setRangeStartOnly(y,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(v),this.runLocalHooks("afterSelectRows",y,v,f),this.finish()}return u}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const r=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:i,to:o,highlight:s}=r;this.clear(),s.assign({row:ze(s.row,-1/0,e-1),col:ze(s.col,-1/0,n-1)}),i.assign({row:ze(i.row,-1/0,e-1),col:ze(i.col,-1/0,n-1)}),o.assign({row:ze(o.row,0,e-1),col:ze(o.col,0,n-1)}),this.selectedRange.ranges.push(r),this.highlight.getFocus().add(s).commit().syncWith(r),this.applyAndCommit(r)}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.highlight.getFocus(),r=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),c=this.highlight.createActiveRowHeader(),u=this.highlight.createActiveColumnHeader(),d=this.highlight.createActiveCornerHeader(),g=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),c.commit(),u.commit(),d.commit(),g.commit(),f.commit()}this.highlight.useLayerLevel(r)}}et(B0,br);const V0=/^(\r\n|\n\r|\r|\n)/,b6=/^[^\t\r\n]+/,z0=/^\t/;function v6(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(z0))t=t.replace(z0,""),n+=1,e[r][n]="";else if(t.match(V0))t=t.replace(V0,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(b6);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function Fs(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function Mi(t,e,n){return(e=y6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y6(t){var e=C6(t,"string");return typeof e=="symbol"?e:e+""}function C6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wo{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){Mi(this,"hot",void 0),Mi(this,"metaManager",void 0),Mi(this,"tableMeta",void 0),Mi(this,"dataSource",void 0),Mi(this,"duckSchema",void 0),Mi(this,"colToPropCache",void 0),Mi(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=yh(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(an(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return Bw(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Le(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&Me(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(Me(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?us(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const u=this.tableMeta.maxRows,d=this.getSchema().length,g=[];for(;a<n&&o+a<u;){let b=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?b=Dr(this.getSchema()):(b=[],dt(d-1,()=>b.push(null))):this.hot.dataType==="function"?b=this.tableMeta.dataSchema(l+a):(b={},w1(b,this.getSchema())),g.push(b),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,g);const f=this.hot.toVisualRow(s);return this.hot.countSourceRows()===g.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",f,a,r),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,r)===!1)return{delta:0};let u=a;l<this.hot.countCols()&&(u=this.hot.toPhysicalColumn(l));const d=this.hot.countSourceRows();let g=this.hot.countCols(),f=0,b=u;i==="end"&&(b=Math.min(b+1,a));const w=b;for(;f<n&&g<s;){if(typeof l!="number"||l>=g)if(d>0)for(let v=0;v<d;v+=1)typeof o[v]>"u"&&(o[v]=[]),o[v].push(null);else o.push([null]);else for(let v=0;v<d;v++)o[v].splice(b,0,null);f+=1,b+=1,g+=1}this.hot.columnIndexMapper.insertIndexes(l,f),f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(w,n));const y=this.hot.toVisualColumn(w);return this.hot.runHooks("afterCreateCol",y,f,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:f,startPhysicalIndex:w}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const u=Me(this.tableMeta.columns)||Me(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&u===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((u,d)=>d-u).forEach(u=>{this.metaManager.removeRow(u,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),this.hot.forceFullRender=!0,!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((d,g)=>g-d);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const c=s.length,u=this.dataSource;for(let d=0;d<c;d++)l&&o[0]!==o[d]-d&&(l=!1);if(l)for(let d=0,g=this.hot.countSourceRows();d<g;d++)u[d].splice(o[0],n),d===0&&this.metaManager.removeColumn(o[0],n);else for(let d=0,g=this.hot.countSourceRows();d<g;d++)for(let f=0;f<c;f++)u[d].splice(s[f],1),d===0&&this.metaManager.removeColumn(s[f],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),c=3;c<a;c++)l[c-3]=arguments[c];Ap(l,s);let u=0;for(;u<r;)l.push(null),u+=1;return cM(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),c=3;c<a;c++)l[c-3]=arguments[c];Ap(l,s);let u=0;for(;u<r;)l.push(null),u+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&Lr(i,n))a=i[n];else if(s&&typeof n=="string"&&n.indexOf(".")>-1){let l=i;if(!l)return null;const c=n.split(".");for(let u=0,d=c.length;u<d;u++)if(l=l[c[u]],typeof l>"u")return null;a=l}else typeof n=="function"&&(a=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const l=Tn(a);this.hot.runHooks("modifyData",r,this.propToCol(n),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const c=Tn(o);this.hot.runHooks("modifyData",i,this.propToCol(n),c,"set"),c.isTouched()&&(o=c.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&Lr(s,n))s[n]=o;else if(l&&typeof n=="string"&&n.indexOf(".")>-1){let c=s,u=0,d;const g=n.split(".");for(u=0,d=g.length-1;u<d;u++)typeof c[g[u]]>"u"&&(c[g[u]]={}),c=c[g[u]];c[g[u]]=o}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],o):s[n]=o}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,wo.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,c=this.tableMeta.maxCols;if(l===0||c===0)return[];const u=r===wo.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,d=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),g=Math.min(Math.max(c-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=d;o++){a=[];const f=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=g&&f!==null;s++)a.push(u.call(this,o,this.colToProp(s)));f!==null&&i.push(a)}return i}getText(e,n){return Fs(this.getRange(e,n,wo.DESTINATION_RENDERER))}getCopyableText(e,n){return Fs(this.getRange(e,n,wo.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:S6,getItem:R6,hasItem:j0,getNames:l7,getValues:c7}=io("cellTypes");function _6(t){if(!j0(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return R6(t)}function T6(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&N1(t,n),r&&nH(t,r),i&&sH(t,i),S6(t,e)}function E6(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!Lr(e,t)}function zl(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?_6(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Le(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!an(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Le(r,(o,s)=>{if(E6(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),to(t,i)}function x6(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}nA(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function jl(t){return Number.isInteger(t)&&t>=0}function Ul(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Yl(t){return t==null}const U0=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),di(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),di(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),b1(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function Y0(t,e,n){return(e=O6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O6(t){var e=M6(t,"string");return typeof e=="symbol"?e:e+""}function M6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function A6(){return class{}}class I6{constructor(e){Y0(this,"metaCtor",A6()),Y0(this,"meta",void 0),this.meta=this.metaCtor.prototype,to(this.meta,U0()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;to(this.meta,e),zl(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function H6(t,e,n){return(e=k6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function k6(t){var e=P6(t,"string");return typeof e=="symbol"?e:e+""}function P6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class N6{constructor(e){H6(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){to(this.meta,e),zl(this.meta,e,e)}}function Gl(t,e,n){return(e=D6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function D6(t){var e=L6(t,"string");return typeof e=="symbol"?e:e+""}function L6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kl{constructor(e){Gl(this,"valueFactory",void 0),Gl(this,"data",[]),Gl(this,"index",[]),Gl(this,"holes",new Set),this.valueFactory=e}obtain(e){Ul(()=>jl(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Ul(()=>jl(e)||Yl(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=Yl(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Ul(()=>jl(e)||Yl(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(Yl(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return sh(this.data,(e,n)=>!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function G0(t,e,n){return(e=F6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F6(t){var e=$6(t,"string");return typeof e=="symbol"?e:e+""}function $6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const W6=["data","width"];class B6{constructor(e){G0(this,"globalMeta",void 0),G0(this,"metas",new Kl(()=>this._createMeta())),this.globalMeta=e,this.metas=new Kl(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);to(r,n),zl(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return x6(this.globalMeta.getMetaConstructor(),W6).prototype}}function K0(t,e,n){return(e=V6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function V6(t){var e=z6(t,"string");return typeof e=="symbol"?e:e+""}function z6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class j6{constructor(e){K0(this,"columnMeta",void 0),K0(this,"metas",new Kl(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);to(i,r),zl(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)Me(n[r])&&e.push(...n[r].values());return e}getMetasAtRow(e){Ul(()=>jl(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Kl(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class Z0{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new I6(e),this.tableMeta=new N6(this.globalMeta),this.columnMeta=new B6(this.globalMeta),this.cellMeta=new j6(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){let{visualRow:i,visualColumn:o}=r;const s=this.cellMeta.getMeta(e,n);return s.visualRow=i,s.visualCol=o,s.row=e,s.col=n,this.runLocalHooks("afterGetCellMeta",s),s}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}et(Z0,br);function q0(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:c,firstRun:u}=r,d=Qi(a),g=i.getSettings();Array.isArray(g.dataSchema)?i.dataType="array":Ke(g.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${d}`,t,u,l);const f=new wo(i,t,c);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const b=f.getSchema();t=[];let w,y=0,v=0;for(y=0,v=g.startRows;y<v;y++)if((i.dataType==="object"||i.dataType==="function")&&g.dataSchema)w=Dr(b),t.push(w);else if(i.dataType==="array")w=Dr(b[0]),t.push(w);else{w=[];for(let R=0,T=g.startCols;R<T;R++)w.push(null);t.push(w)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),g.data=t,f.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=f.colToProp.bind(f),s.propToCol=f.propToCol.bind(f),s.countCachedColumns=f.countCachedColumns.bind(f),n(f),i.runHooks(`after${d}`,t,u,l),u||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&Fe(i.rootElement,[Wp(-1),Ga(i.countCols()+(i.view?i.countRowHeaders():0))])}function X0(t,e,n){return(e=U6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function U6(t){var e=Y6(t,"string");return typeof e=="symbol"?e:e+""}function Y6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class G6{constructor(e){X0(this,"metaManager",void 0),X0(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",n=>this.extendCellMeta(n)),Ve.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const c=Lr(e,"type")?e.type:null;let u=Ke(e.cells)?e.cells(r,i,l):null;if(c)if(u){var d;u.type=(d=u.type)!==null&&d!==void 0?d:c}else u={type:c};u&&this.metaManager.updateCellMeta(r,i,u),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function K6(t,e,n){Z6(t,e),e.set(t,n)}function Z6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ld(t,e,n){return(e=q6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q6(t){var e=X6(t,"string");return typeof e=="symbol"?e:e+""}function X6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Q6(t,e){return t.get(J6(t,e))}function J6(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Q0=new WeakMap;class eN{constructor(e){Ld(this,"metaManager",void 0),Ld(this,"usageTracker",new Set),Ld(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),K6(this,Q0,(n,r,i)=>{if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:r,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:n,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(n,l,o),s&&this.installPropWatcher(i,l,o)):r&&(this.installPropWatcher(n,l,Q6(Q0,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const J0="gridDefault",ev="editorManager.handlingEditor",tN={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},nN="hooksRefRegisterer",tv={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){we(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Le(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};gr(tv,"MIXIN_NAME",nN,{writable:!1,enumerable:!1});function Hn(t,e,n){return(e=rN(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rN(t){var e=iN(t,"string");return typeof e=="symbol"?e:e+""}function iN(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const oN="base",ot=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class Fd{static get EDITOR_TYPE(){return oN}constructor(e){Hn(this,"hot",void 0),Hn(this,"state",ot.VIRGIN),Hn(this,"_opened",!1),Hn(this,"_fullEditMode",!1),Hn(this,"_closeCallback",null),Hn(this,"TD",null),Hn(this,"row",null),Hn(this,"col",null),Hn(this,"prop",null),Hn(this,"originalValue",null),Hn(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:ot.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const l=this.hot.getSelectedLast();r=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),o=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i);Array.isArray(a)&&([r,i]=a),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==ot.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(r.view.scrollViewport(r._createCellCoords(i,o)),this.state=ot.EDITING,this.isInFullEditMode()){const s=typeof e=="string"?e:ah(this.originalValue);this.setValue(s)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,n,r){let i;if(r){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),r(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===ot.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===ot.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=ot.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=ot.FINISHED,this.discardEditor(s)}):(this.state=ot.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=ot.FINISHED,this.discardEditor()}discardEditor(e){this.state===ot.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=ot.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=ot.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===ot.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=Xt(n),a=lt(n),l=Xt(this.hot.rootElement),c=lt(this.hot.rootElement),u=r.topOverlay.holder,d=r.inlineStartOverlay.holder,g=u!==o?u.scrollTop:0,f=d!==o?d.scrollLeft:0,b=o.innerWidth-l.left-c,{wtTable:w}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,y=w.name,v=["master","inline_start"].includes(y)?g:0,R=["master","top","bottom"].includes(y)?f:0,T=s.top===l.top?0:1;let M=s.top-l.top-T-v,I=0;this.hot.isRtl()?I=o.innerWidth-s.left-a-b-1+R:I=s.left-l.left-1-R,["top","top_inline_start_corner"].includes(y)&&(M+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(y)&&(I+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const L=this.hot.hasColHeaders(),N=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),$=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),q=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(L&&N<=0||N===q)&&(M+=1),$<=0&&(I+=1);const ue=i.rowsRenderCalculator.startPosition,A=i.columnsRenderCalculator.startPosition,B=Math.abs(r.inlineStartOverlay.getScrollPosition()),C=r.topOverlay.getScrollPosition(),z=It(this.hot.rootDocument);let fe=n.offsetTop;if(["inline_start","master"].includes(y)&&(fe+=ue-C),["bottom","bottom_inline_start_corner"].includes(y)){const{wtViewport:Y,wtTable:ne}=r.bottomOverlay.clone;fe+=Y.getWorkspaceHeight()-ne.getHeight()-z}let K=n.offsetLeft;this.hot.isRtl()?(K>=0?K=w.getWidth()-n.offsetLeft:K=Math.abs(K),K+=A-B-a):["top","master","bottom"].includes(y)&&(K+=A-B);const ie=Pr(this.TD,this.hot.rootWindow),U=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",me=parseInt(ie[U],10)>0?0:1,h=parseInt(ie.borderTopWidth,10)>0?0:1,m=lt(n)+me,S=Qt(n)+h,E=PM(u)?z:0,O=NM(d)?z:0,k=this.hot.view.maximumVisibleElementWidth(K)-E+me,Z=Math.max(this.hot.view.maximumVisibleElementHeight(fe)-O+h,23);return{top:M,start:I,height:S,maxHeight:Z,width:m,maxWidth:k}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}et(Fd,tv);const sN={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const r=t._getEditorManager(),i=r.getActiveEditor();i.isInFullEditMode()&&i.state===ot.EDITING||(r.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},aN={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},lN={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},cN={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},uN={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:o}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const s=t.getSettings(),a=typeof s.enterMoves=="function"?s.enterMoves(e):s.enterMoves;n.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}o.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(e):r.openEditor(null,e,!0):r.moveSelectionAfterEnter(e),tl(e))}};function hN(){return[tN,sN,aN,lN,cN,uN]}const dN={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},fN={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(r!==null){const i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.min(i.row-o,t.countRows()-1);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},mN={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},gN={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},pN={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(n.col,r.col,e)}},wN={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=r.row,e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},bN={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&r.isCell()){const s=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=r.col,e.setRangeStart(a,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,s))}}},vN={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&r.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=r.col,e.setRangeStart(l,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},yN={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=r.col,e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},CN={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=r.col,e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},SN={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=r.row,e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},RN={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(n.row,r.row,e)}},_N={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},TN={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.max(e.row-t.countVisibleRows(),0),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(r!==null){const i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.max(i.row-o,0);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}};function EN(){return[dN,fN,mN,gN,pN,wN,bN,vN,yN,CN,SN,RN,_N,TN]}const xN={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},ON={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=t.countVisibleRows()+n;r===t.countRows()-1?i=1:r+i>t.countRows()&&(i=t.countRows()-r-1),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},MN={name:"moveCellSelectionInlineEnd",callback(t,e){const n=t.getSettings(),r=t.getSelectedRangeLast(),i=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.isMultiple()&&!r.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(-i.row,-i.col):t.selection.transformStart(-i.row,-i.col)}},AN={name:"moveCellSelectionInlineStart",callback(t,e){const n=t.getSettings(),r=t.getSelectedRangeLast(),i=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.isMultiple()&&!r.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(i.row,i.col):t.selection.transformStart(i.row,i.col)}},IN={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},HN={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},kN={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),t.selection.setRangeStart(t._createCellCoords(n,e))}},PN={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(o,s))}},NN={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},DN={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.setRangeStart(t._createCellCoords(i,o))}},LN={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(r,i))}},FN={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(r,i))}},$N={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(n,e))}},WN={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.setRangeStart(t._createCellCoords(s,a))}},BN={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},VN={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=-(t.countVisibleRows()+n);r===-n?i=-1:r+i<n&&(i=-(r+n)),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function zN(){return[xN,ON,MN,AN,IN,HN,kN,PN,NN,DN,LN,FN,$N,WN,BN,VN]}const jN={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},UN={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.view.getFirstFullyVisibleRow()-1,r=t.view.getFirstFullyVisibleColumn()-1,i=t.view.getLastFullyVisibleRow()+1,o=t.view.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const c={};if(e.col>=0){const u=Math.floor(t.countVisibleCols()/2);c.col=Math.max(e.col-u,0)}if(e.row>=0){const u=Math.floor(t.countVisibleRows()/2);c.row=Math.max(e.row-u,0)}t.scrollViewportTo({...c,verticalSnap:"top",horizontalSnap:"start"})}}},YN={name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},GN={name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},KN={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:c}=t.getCellMeta(a,l);c||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},ZN=[...hN(),...EN(),...zN(),jN,UN,YN,GN,KN];function nv(t){const e={};return ZN.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function qN(t){const e=t.getShortcutManager().addContext("editor"),n=nv(t),r={group:ev};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>n.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function XN(t){const e=t.getShortcutManager().addContext("grid"),n=nv(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return Me(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:J0};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:ev,runOnlyIf:()=>Me(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>t.getSelectedRangeLast().highlight.isHeader(),preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()&&t.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function QN(t){[XN,qN].forEach(e=>e(t))}function JN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=rv(t),i=rv(t);return r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function rv(t){const n=t.rootDocument.createElement("input");return n.type="text",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Fe(n,[mr(),uh()]),n}function e8(t){const e=t8(t);let n;const{activate:r,deactivate:i}=JN(t,{onFocusFromTop(){var d;const g=(d=e(n))!==null&&d!==void 0?d:$d(t);g&&(t.runHooks("modifyFocusOnTabNavigation","from_above",g),t.selectCell(g.row,g.col)),t.listen()},onFocusFromBottom(){var d;const g=(d=e(n))!==null&&d!==void 0?d:Wd(t);g&&(t.runHooks("modifyFocusOnTabNavigation","from_below",g),t.selectCell(g.row,g.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>r()),t.addHook("afterSelection",(d,g,f,b,w)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,w.value=!0),s){var y;n=(y=t.getSelectedRangeLast())===null||y===void 0?void 0:y.highlight}}),t.addHook("beforeRowWrap",(d,g,f)=>{o.wrapped=!0,o.flipped=f});function c(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const u={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:J0,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...u,callback:()=>{const{tabNavigation:d}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!d&&(s=!1),d||(l=!0)},position:"before"},{...u,callback:d=>{const{tabNavigation:g,autoWrapRow:f}=t.getSettings();if(a=!1,s=!0,!g||!t.selection.isSelected()||f&&o.wrapped&&o.flipped||!f&&o.wrapped)return f&&o.wrapped&&o.flipped&&(n=d.shiftKey?$d(t):Wd(t)),c(),!1;d.preventDefault()},position:"after"}])}function $d(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function Wd(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}function t8(t){return e=>{if(!e)return null;const n=$d(t),r=Wd(t);return e.col<n.col&&(e.col=n.col),e.col>r.col&&(e.col=r.col),e.row<n.row&&(e.row=n.row),e.row>r.row&&(e.row=r.row),e}}function n8(t){return e=>{let{col:n}=e;t.scrollViewportTo({col:n})}}function r8(){return()=>{}}function i8(t){return e=>{t.scrollViewportTo(e.toObject())}}function o8(t){return e=>{t.scrollViewportTo(e.toObject())}}function s8(t){return e=>{t.scrollViewportTo(e.toObject())}}function a8(t){return e=>{let{row:n}=e;t.scrollViewportTo({row:n})}}function l8(t){return e=>{const n=t.selection.getSelectionSource(),{row:r,col:i}=e;if(r<0&&i>=0)t.scrollViewportTo({col:i});else if(i<0&&r>=0)t.scrollViewportTo({row:r});else{if(n==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||r===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:r,col:i})}}}function c8(t){const{selection:e}=t;let n=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){n=!0},scrollTo(i){var o;if(n||r){n=!1;return}let s;e.isFocusSelectionChanged()?s=i8(t):e.isSelectedByCorner()?s=r8():e.isSelectedByRowHeader()?s=a8(t):e.isSelectedByColumnHeader()?s=n8(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=o8(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=l8(t):e.getSelectedRange().size()>1&&(s=s8(t)),(o=s)===null||o===void 0||o(i)}}}const iv=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Zl=t=>t.map(e=>{const n=e.toLowerCase();return iv.has(n)?iv.get(n):n}).sort().join("+"),u8=t=>t.split("+"),ov=new Map([[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),Bd=t=>{let{which:e,key:n}=t;if(ov.has(e))return ov.get(e);const r=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(r)?r:n.toLowerCase()},sv=Symbol("shortcut-context");function av(t){return an(t)&&t.__kindOf===sv}const h8=t=>{const e=ul({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:c,group:u,runOnlyIf:d=()=>!0,captureCtrl:g=!1,preventDefault:f=!0,stopPropagation:b=!1,relativeToGroup:w,position:y,forwardToContext:v}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Ft(u))throw new Error("You need to define the shortcut's group.");if(Ke(c)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(qt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const R={callback:c,group:u,runOnlyIf:d,captureCtrl:g,preventDefault:f,stopPropagation:b};Me(w)&&(R.relativeToGroup=w,R.position=y),av(v)&&(R.forwardToContext=v),l.forEach(T=>{const M=Zl(T);if(e.hasItem(M)){const L=e.getItem(M);let N=L.findIndex($=>$.group===w);N!==-1?y==="before"?N-=1:N+=1:N=L.length,L.splice(N,0,R)}else e.addItem(M,[R])})},r=function(l){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(u=>{Le(c,(d,g)=>{Object.prototype.hasOwnProperty.call(u,g)===!1&&(u[g]=c[g])}),n(u)})},i=l=>{const c=Zl(l);e.removeItem(c)};return{__kindOf:sv,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const c=Zl(l),u=e.getItem(c);return Me(u)?u.slice():[]},hasShortcut:l=>{const c=Zl(l);return e.hasItem(c)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(u=>{let[d,g]=u;const f=g.filter(b=>b.group!==l);f.length===0?i(u8(d)):(g.length=0,g.push(...f))})}}};function d8(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const f8=["meta","alt","shift","control"],$s=d8(),Ws=[];let ql=0;function m8(t,e,n,r,i){const o=f=>f8.includes(f),s=function(f){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const w=[];return f.altKey&&w.push("alt"),b&&(f.ctrlKey||f.metaKey)?w.push("control/meta"):(f.ctrlKey&&w.push("control"),f.metaKey&&w.push("meta")),f.shiftKey&&w.push("shift"),w},a=f=>{if(e(f)===!1)return;const b=n(f);if(f.keyCode===229||b===!1||mi(f))return;const w=Bd(f);let y=[];o(w)||(y=s(f));const v=[w].concat(y);!i(f,v)&&(R1()&&y.includes("meta")||!R1()&&y.includes("control"))&&i(f,[w].concat(s(f,!0))),r(f)},l=f=>{if(f.key){const b=Bd(f);o(b)&&$s.press(b)}},c=f=>{if(f.key){const b=Bd(f);o(b)&&$s.release(b)}},u=()=>{$s.releaseAll()};return{mount:()=>{let f=t;for(ql+=1;f;)ql===1&&(f.document.documentElement.addEventListener("keydown",l),Ws.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",c),Ws.push({event:"keyup",listener:c})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",u),f=os(f)},unmount:()=>{let f=t;for(ql-=1;f;){if(ql===0){for(let b=0;b<Ws.length;b++){const{event:w,listener:y}=Ws[b];f.document.documentElement.removeEventListener(w,y)}Ws.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",u),f=os(f)}},isPressed:f=>$s.isPressed(f),releasePressedKeys:()=>$s.releaseAll()}}const g8=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=ul({errorIdExists:b=>`The "${b}" context name is already registered.`});let s="grid";const a=b=>{const w=h8(b);return o.addItem(b,w),w},l=()=>s,c=b=>o.getItem(b),u=b=>{if(!o.hasItem(b))throw new Error(qt`You've tried to activate the "${b}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=b};let d=!1;const g=function(b,w){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const v=av(y)?y:c(y);let R=!1;if(!v.hasShortcut(w))return R;const T=v.getShortcuts(w);for(let M=0;M<T.length;M++){const{callback:I,runOnlyIf:L,preventDefault:N,stopPropagation:$,captureCtrl:W,forwardToContext:q}=T[M];if(L(b)===!0){if(d=W,R=I(b,w)===!1,d=!1,N&&b.preventDefault(),$&&(tl(b),b.stopPropagation()),R)break;q&&g(b,w,q)}}return R},f=m8(e,n,r,i,g);return f.mount(),{addContext:a,getActiveContextName:l,getContext:c,setActiveContextName:u,isCtrlPressed:()=>!d&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};let Vd=null;const zd=new Map;function lv(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const s=new pi(o);let a,l,c,u,d,g,f=!0;eP(i)&&Jk(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const b=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",w=["rtl","ltr"].includes(b)?b:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",w),this.isRtl=function(){return w==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},e.language=YP(e.language);const y=new Z0(o,e,[G6,eN]),v=y.getTableMeta(),R=y.getGlobalMeta(),T=ul();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),Ol(this)&&fM(e.licenseKey,t),this.guid=`ht_${Lp()}`,zd.set(this.guid,this),this.columnIndexMapper=new Cd,this.rowIndexMapper=new Cd,this.columnIndexMapper.addLocalHook("indexesSequenceChange",h=>{o.runHooks("afterColumnSequenceChange",h)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",h=>{o.runHooks("afterRowSequenceChange",h)}),l=new cP(o),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const M=h=>{const{row:m,col:S}=h;return o._createCellCoords(m>=0?o.rowIndexMapper.getRenderableFromVisualIndex(m):m,S>=0?o.columnIndexMapper.getRenderableFromVisualIndex(S):S)},I=h=>{const{row:m,col:S}=h;return o._createCellCoords(m>=0?o.rowIndexMapper.getVisualFromRenderableIndex(m):m,S>=0?o.columnIndexMapper.getVisualFromRenderableIndex(S):S)},L=(h,m)=>{const S=m>h?1:-1,E=Math.min(h,m),O=Math.max(h,m),k=o.rowIndexMapper.getNearestNotHiddenIndex(h,S);return k===null||S===1&&k>O||S===-1&&k<E?null:k>=0?o.rowIndexMapper.getRenderableFromVisualIndex(k):k},N=(h,m)=>{const S=m>h?1:-1,E=Math.min(h,m),O=Math.max(h,m),k=o.columnIndexMapper.getNearestNotHiddenIndex(h,S);return k===null||S===1&&k>O||S===-1&&k<E?null:k>=0?o.columnIndexMapper.getRenderableFromVisualIndex(k):k};let $=new B0(v,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:h=>a.propToCol(h),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(h,m)=>o._createCellCoords(h,m),createCellRange:(h,m,S)=>o._createCellRange(h,m,S),visualToRenderableCoords:M,renderableToVisualCoords:I,findFirstNonHiddenRenderableRow:L,findFirstNonHiddenRenderableColumn:N,isDisabledCellSelection:(h,m)=>h<0||m<0?o.getSettings().disableVisualSelection:o.getCellMeta(h,m).disableVisualSelection});this.selection=$;const W=h=>{let{hiddenIndexesChanged:m}=h;m&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",W),this.rowIndexMapper.addLocalHook("cacheUpdated",W),this.selection.addLocalHook("afterSetRangeEnd",(h,m)=>{const S=Tn(!1),E=this.selection.getSelectedRange(),{from:O,to:k}=E.current(),Z=E.size()-1;this.runHooks("afterSelection",O.row,O.col,k.row,k.col,S,Z),this.runHooks("afterSelectionByProp",O.row,o.colToProp(O.col),k.row,o.colToProp(k.col),S,Z),m&&(!S.isTouched()||S.isTouched()&&!S.value)&&g.scrollTo(h);const Y=$.isSelectedByRowHeader(),ne=$.isSelectedByColumnHeader();Y&&ne?Ee(this.rootElement,["ht__selection--rows","ht__selection--columns"]):Y?(Ge(this.rootElement,"ht__selection--columns"),Ee(this.rootElement,"ht__selection--rows")):ne?(Ge(this.rootElement,"ht__selection--rows"),Ee(this.rootElement,"ht__selection--columns")):Ge(this.rootElement,["ht__selection--rows","ht__selection--columns"]),$.getSelectionSource()!=="shift"&&u.closeEditor(null),o.view.render(),u.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",h=>{this.runHooks("beforeSelectionFocusSet",h.row,h.col)}),this.selection.addLocalHook("afterSetFocus",h=>{const m=Tn(!1);this.runHooks("afterSelectionFocusSet",h.row,h.col,m),(!m.isTouched()||m.isTouched()&&!m.value)&&g.scrollTo(h),u.closeEditor(),o.view.render(),u.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",h=>{const m=h.length-1,{from:S,to:E}=h[m];this.runHooks("afterSelectionEnd",S.row,S.col,E.row,E.col,m),this.runHooks("afterSelectionEndByProp",S.row,o.colToProp(S.col),E.row,o.colToProp(E.col),m)}),this.selection.addLocalHook("afterIsMultipleSelection",h=>{const m=this.runHooks("afterIsMultipleSelection",h.value);h.value&&(h.value=m)}),this.selection.addLocalHook("afterDeselect",()=>{u.closeEditor(),o.view.render(),Ge(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var h=arguments.length,m=new Array(h),S=0;S<h;S++)m[S]=arguments[S];return r.runHooks("beforeSetRangeStart",...m)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var h=arguments.length,m=new Array(h),S=0;S<h;S++)m[S]=arguments[S];return r.runHooks("beforeSetRangeStartOnly",...m)}).addLocalHook("beforeSetRangeEnd",function(){for(var h=arguments.length,m=new Array(h),S=0;S<h;S++)m[S]=arguments[S];return r.runHooks("beforeSetRangeEnd",...m)}).addLocalHook("beforeSelectColumns",function(){for(var h=arguments.length,m=new Array(h),S=0;S<h;S++)m[S]=arguments[S];return r.runHooks("beforeSelectColumns",...m)}).addLocalHook("afterSelectColumns",function(){for(var h=arguments.length,m=new Array(h),S=0;S<h;S++)m[S]=arguments[S];return r.runHooks("afterSelectColumns",...m)}).addLocalHook("beforeSelectRows",function(){for(var h=arguments.length,m=new Array(h),S=0;S<h;S++)m[S]=arguments[S];return r.runHooks("beforeSelectRows",...m)}).addLocalHook("afterSelectRows",function(){for(var h=arguments.length,m=new Array(h),S=0;S<h;S++)m[S]=arguments[S];return r.runHooks("afterSelectRows",...m)}).addLocalHook("beforeModifyTransformStart",function(){for(var h=arguments.length,m=new Array(h),S=0;S<h;S++)m[S]=arguments[S];return r.runHooks("modifyTransformStart",...m)}).addLocalHook("afterModifyTransformStart",function(){for(var h=arguments.length,m=new Array(h),S=0;S<h;S++)m[S]=arguments[S];return r.runHooks("afterModifyTransformStart",...m)}).addLocalHook("beforeModifyTransformFocus",function(){for(var h=arguments.length,m=new Array(h),S=0;S<h;S++)m[S]=arguments[S];return r.runHooks("modifyTransformFocus",...m)}).addLocalHook("afterModifyTransformFocus",function(){for(var h=arguments.length,m=new Array(h),S=0;S<h;S++)m[S]=arguments[S];return r.runHooks("afterModifyTransformFocus",...m)}).addLocalHook("beforeModifyTransformEnd",function(){for(var h=arguments.length,m=new Array(h),S=0;S<h;S++)m[S]=arguments[S];return r.runHooks("modifyTransformEnd",...m)}).addLocalHook("afterModifyTransformEnd",function(){for(var h=arguments.length,m=new Array(h),S=0;S<h;S++)m[S]=arguments[S];return r.runHooks("afterModifyTransformEnd",...m)}).addLocalHook("beforeRowWrap",function(){for(var h=arguments.length,m=new Array(h),S=0;S<h;S++)m[S]=arguments[S];return r.runHooks("beforeRowWrap",...m)}).addLocalHook("beforeColumnWrap",function(){for(var h=arguments.length,m=new Array(h),S=0;S<h;S++)m[S]=arguments[S];return r.runHooks("beforeColumnWrap",...m)}).addLocalHook("insertRowRequire",h=>this.alter("insert_row_above",h,1,"auto")).addLocalHook("insertColRequire",h=>this.alter("insert_col_start",h,1,"auto")),c={alter(h,m){var S,E;let O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,k=arguments.length>3?arguments[3]:void 0,Z=arguments.length>4?arguments[4]:void 0;const Y=ne=>{if(ne.length===0)return[];const oe=[...ne];return oe.sort((ye,Ce)=>{let[p]=ye,[V]=Ce;return p===V?0:p>V?1:-1}),ts(oe,(ye,Ce)=>{let[p,V]=Ce;const F=ye[ye.length-1],[x,_]=F,H=x+_;if(p<=H){const G=Math.max(V-(H-p),0);F[1]+=G}else ye.push([p,V]);return ye},[oe[0]])};switch(h){case"insert_row_below":case"insert_row_above":const ne=o.countSourceRows();if(v.maxRows===ne)return;const oe=h==="insert_row_below"?"below":"above";m=(S=m)!==null&&S!==void 0?S:oe==="below"?ne:0;const{delta:X,startPhysicalIndex:ye}=a.createRow(m,O,{source:k,mode:oe});$.shiftRows(o.toVisualRow(ye),X);break;case"insert_col_start":case"insert_col_end":const Ce=h==="insert_col_end"?"end":"start";m=(E=m)!==null&&E!==void 0?E:Ce==="end"?o.countSourceCols():0;const{delta:p,startPhysicalIndex:V}=a.createCol(m,O,{source:k,mode:Ce});if(p){if(Array.isArray(v.colHeaders)){const _=[o.toVisualColumn(V),0];_.length+=p,Array.prototype.splice.apply(v.colHeaders,_)}$.shiftColumns(o.toVisualColumn(V),p)}break;case"remove_row":const F=_=>{let H=0;we(_,G=>{let[j,D]=G;const Q=di(j)?o.countRows()-1:Math.max(j-H,0);if(Number.isInteger(j)&&(j=Math.max(j-H,0)),!a.removeRow(j,D,k))return;if($.isSelected()){const{row:ve}=o.getSelectedRangeLast().highlight;ve>=j&&ve<=j+D-1&&u.closeEditor(!0)}const J=o.countRows();J===0?$.deselect():k==="ContextMenu.removeRow"?$.refresh():$.shiftRows(j,-D);const ce=v.fixedRowsTop;ce>=Q+1&&(v.fixedRowsTop-=Math.min(D,ce-Q));const Re=v.fixedRowsBottom;Re&&Q>=J-Re&&(v.fixedRowsBottom-=Math.min(D,Re)),H+=D})};Array.isArray(m)?F(Y(m)):F([[m,O]]);break;case"remove_col":const x=_=>{let H=0;we(_,G=>{let[j,D]=G;const Q=di(j)?o.countCols()-1:Math.max(j-H,0);let re=o.toPhysicalColumn(Q);if(Number.isInteger(j)&&(j=Math.max(j-H,0)),!a.removeCol(j,D,k))return;if($.isSelected()){const{col:ve}=o.getSelectedRangeLast().highlight;ve>=j&&ve<=j+D-1&&u.closeEditor(!0)}o.countCols()===0?$.deselect():k==="ContextMenu.removeColumn"?$.refresh():$.shiftColumns(j,-D);const Re=v.fixedColumnsStart;Re>=Q+1&&(v.fixedColumnsStart-=Math.min(D,Re-Q)),Array.isArray(v.colHeaders)&&(typeof re>"u"&&(re=-1),v.colHeaders.splice(re,D)),H+=D})};Array.isArray(m)?x(Y(m)):x([[m,O]]);break;default:throw new Error(`There is no such action "${h}"`)}o.view.render(),Z||c.adjustRowsAndCols()},adjustRowsAndCols(){const h=v.minRows,m=v.minSpareRows,S=v.minCols,E=v.minSpareCols;if(h){const O=o.countRows();O<h&&a.createRow(O,h-O,{source:"auto"})}if(m){const O=o.countEmptyRows(!0);if(O<m){const k=m-O,Z=Math.min(k,v.maxRows-o.countSourceRows());a.createRow(o.countRows(),Z,{source:"auto"})}}{let O;(S||E)&&(O=o.countEmptyCols(!0));let k=o.countCols();if(S&&!v.columns&&k<S){const Z=S-k;O+=Z,a.createCol(k,Z,{source:"auto"})}if(E&&!v.columns&&o.dataType==="array"&&O<E){k=o.countCols();const Z=E-O,Y=Math.min(Z,v.maxCols-k);a.createCol(k,Y,{source:"auto"})}}o.view&&o.view.adjustElementsSize()},populateFromArray(h,m,S,E,O){let k,Z,Y,ne;const oe=[],X={},ye=[],Ce=h.row,p=h.col;if(Z=m.length,Z===0)return!1;let V=0,F=0;switch(an(S)&&(V=S.col-p+1,F=S.row-Ce+1),O){case"shift_down":const x=oh(m),_=x.length,H=Math.max(_,V),G=o.getData().slice(Ce),j=oh(G).slice(p,p+H);for(Y=0;Y<H;Y+=1)if(Y<_){for(k=0,Z=x[Y].length;k<F-Z;k+=1)x[Y].push(x[Y][k%Z]);Y<j.length?ye.push(x[Y].concat(j[Y])):ye.push(x[Y].concat(new Array(G.length).fill(null)))}else ye.push(x[Y%_].concat(j[Y]));o.populateFromArray(Ce,p,oh(ye));break;case"shift_right":const D=m.length,Q=Math.max(D,F),re=o.getData().slice(Ce).map(st=>st.slice(p));for(k=0;k<Q;k+=1)if(k<D){for(Y=0,ne=m[k].length;Y<V-ne;Y+=1)m[k].push(m[k][Y%ne]);if(k<re.length)for(let st=0;st<re[k].length;st+=1)m[k].push(re[k][st]);else m[k].push(...new Array(re[0].length).fill(null))}else m.push(m[k%Z].slice(0,Q).concat(re[k]));o.populateFromArray(Ce,p,m);break;case"overwrite":default:X.row=h.row,X.col=h.col;let J=0,ce=0,Re=!0,ve;const gt=function(Pe){let nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Et=m[Pe%m.length];return nt!==null?Et[nt%Et.length]:Et},gn=m.length,vt=S?S.row-h.row+1:0;for(S?Z=vt:Z=Math.max(gn,vt),k=0;k<Z&&!(S&&X.row>S.row&&vt>gn||!v.allowInsertRow&&X.row>o.countRows()-1||X.row>=v.maxRows);k++){const st=k-J,Pe=gt(st).length,nt=S?S.col-h.col+1:0;if(S?ne=nt:ne=Math.max(Pe,nt),X.col=h.col,ve=o.getCellMeta(X.row,X.col),(E==="CopyPaste.paste"||E==="Autofill.fill")&&ve.skipRowOnPaste){J+=1,X.row+=1,Z+=1;continue}for(ce=0,Y=0;Y<ne&&!(S&&X.col>S.col&&nt>Pe||!v.allowInsertColumn&&X.col>o.countCols()-1||X.col>=v.maxCols);Y++){if(ve=o.getCellMeta(X.row,X.col),(E==="CopyPaste.paste"||E==="Autofill.fill")&&ve.skipColumnOnPaste){ce+=1,X.col+=1,ne+=1;continue}if(ve.readOnly&&E!=="UndoRedo.undo"){X.col+=1;continue}const Et=Y-ce;let qe=gt(st,Et),yt=o.getDataAtCell(X.row,X.col);if(qe!==null&&typeof qe=="object")if(Array.isArray(qe)&&yt===null&&(yt=[]),yt===null||typeof yt!="object")Re=!1;else{const Mo=us(Array.isArray(yt)?yt:yt[0]||yt),pn=us(Array.isArray(qe)?qe:qe[0]||qe);b1(Mo,pn)||Array.isArray(Mo)&&Array.isArray(pn)?qe=Dr(qe):Re=!1}else yt!==null&&typeof yt=="object"&&(Re=!1);Re&&oe.push([X.row,X.col,qe]),Re=!0,X.col+=1}X.row+=1}o.setDataAtCell(oe,null,null,E||"populateFromArray");break}}};function q(h){const m=nb(h);Md(m)?(o.runHooks("beforeLanguageChange",m),R.language=m,o.runHooks("afterLanguageChange",m)):rb(h)}function ue(h,m){const S=h==="className"?o.rootElement:o.table;if(f)Ee(S,m);else{let E=[],O=[];R[h]&&(E=Array.isArray(R[h])?R[h]:Hp(R[h])),m&&(O=Array.isArray(m)?m:Hp(m));const k=Ip(E,O),Z=Ip(O,E);k.length&&Ge(S,k),Z.length&&Ee(S,Z)}R[h]=m}this.init=function(){l.setData(v.data),o.runHooks("beforeInit"),(no()||dA())&&Ee(o.rootElement,"mobile"),this.updateSettings(v,!0),this.view=new iP(this),u=kh.getInstance(o,v,$),g=c8(o),d=new sI(o),Ol(this)&&e8(o),o.runHooks("init"),this.forceFullRender=!0,this.view.render(),f&&o.rootElement.offsetParent===null&&DM(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof f=="object"&&(o.runHooks("afterChange",f[0],f[1]),f=!1),o.runHooks("afterInit")};function A(){let h=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,h=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&h===!1&&(h=!0,this.onQueueEmpty(this.valid))}}}function B(h){const m=h.replace(",",".");return isNaN(parseFloat(m))===!1?parseFloat(m):h}function C(h,m,S){if(!h.length){S();return}const E=o.getActiveEditor(),O=new A;let k=!0;O.onQueueEmpty=()=>{E&&k&&E.cancelChanges(),S()};for(let Z=h.length-1;Z>=0;Z--){const[Y,ne,,oe]=h[Z],X=a.propToCol(ne);let ye;Number.isInteger(X)?ye=o.getCellMeta(Y,X):ye={...Object.getPrototypeOf(v),...v},ye.type==="numeric"&&typeof oe=="string"&&VI(oe)&&(h[Z][3]=B(oe)),o.getCellValidator(ye)&&(O.addValidatorToQueue(),o.validateCell(h[Z][3],ye,function(Ce,p){return function(V){if(typeof V!="boolean")throw new Error("Validation error: result is not boolean");V===!1&&p.allowInvalid===!1&&(k=!1,h.splice(Ce,1),p.valid=!0),O.removeValidatorFormQueue()}}(Z,ye),m))}O.checkIfQueueIsEmpty()}function z(h,m){for(let E=h.length-1;E>=0;E--){let O=!1;if(h[E]===null){h.splice(E,1);continue}if(!((h[E][2]===null||h[E][2]===void 0)&&(h[E][3]===null||h[E][3]===void 0))){if(v.allowInsertRow)for(;h[E][0]>o.countRows()-1;){const{delta:k}=a.createRow(void 0,void 0,{source:m});if(k===0){O=!0;break}}if(o.dataType==="array"&&(!v.columns||v.columns.length===0)&&v.allowInsertColumn)for(;a.propToCol(h[E][1])>o.countCols()-1;){const{delta:k}=a.createCol(void 0,void 0,{source:m});if(k===0){O=!0;break}}O||a.set(h[E][0],h[E][1],h[E][3])}}const S=h.length>0;if(o.forceFullRender=!0,S){c.adjustRowsAndCols(),o.runHooks("beforeChangeRender",h,m),u.closeEditor(),o.view.render(),u.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",h,m||"edit");const E=o.getActiveEditor();E&&Me(E.refreshValue)&&E.refreshValue()}else o.view.render()}this._createCellCoords=function(h,m){return o.view._wt.createCellCoords(h,m)},this._createCellRange=function(h,m,S){return o.view._wt.createCellRange(h,m,S)},this.validateCell=function(h,m,S,E){let O=o.getCellValidator(m);function k(Z){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||m.hidden===!0){S(Z);return}const ne=m.visualCol,oe=m.visualRow,X=o.getCell(oe,ne,!0);if(X&&X.nodeName!=="TH"){const ye=o.rowIndexMapper.getRenderableFromVisualIndex(oe),Ce=o.columnIndexMapper.getRenderableFromVisualIndex(ne);o.view._wt.getSetting("cellRenderer",ye,Ce,X)}S(Z)}uM(O)&&(O=function(Z){return function(Y,ne){ne(Z.test(Y))}}(O)),Ke(O)?(h=o.runHooks("beforeValidate",h,m.visualRow,m.prop,E),o._registerImmediate(()=>{O.call(m,h,Z=>{o&&(Z=o.runHooks("afterValidate",Z,h,m.visualRow,m.prop,E),m.valid=Z,k(Z),o.runHooks("postAfterValidate",Z,h,m.visualRow,m.prop,E))})})):o._registerImmediate(()=>{m.valid=!0,k(m.valid,!1)})};function fe(h,m,S){return Array.isArray(h)?h:[[h,m,S]]}function K(h,m){const S=o.getActiveEditor(),E=o.runHooks("beforeChange",h,m||"edit"),O=h.filter(k=>k!==null);return E===!1||O.length===0?(S&&S.cancelChanges(),[]):O}this.setDataAtCell=function(h,m,S,E){const O=fe(h,m,S),k=[];let Z=E,Y,ne,oe;for(Y=0,ne=O.length;Y<ne;Y++){if(typeof O[Y]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof O[Y][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");O[Y][1]>=this.countCols()?oe=O[Y][1]:oe=a.colToProp(O[Y][1]),k.push([O[Y][0],oe,l.getAtCell(this.toPhysicalRow(O[Y][0]),O[Y][1]),O[Y][2]])}!Z&&typeof h=="object"&&(Z=m);const X=K(k,E);o.runHooks("afterSetDataAtCell",X,Z),C(X,Z,()=>{z(X,Z)})},this.setDataAtRowProp=function(h,m,S,E){const O=fe(h,m,S),k=[];let Z=E,Y,ne;for(Y=0,ne=O.length;Y<ne;Y++)k.push([O[Y][0],O[Y][1],l.getAtCell(this.toPhysicalRow(O[Y][0]),O[Y][1]),O[Y][2]]);!Z&&typeof h=="object"&&(Z=m);const oe=K(k,E);o.runHooks("afterSetDataAtRowProp",oe,Z),C(oe,Z,()=>{z(oe,Z)})},this.listen=function(){o&&!o.isListening()&&(zd.forEach(h=>{o!==h&&h.unlisten()}),Vd=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Vd=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return Vd===o.guid},this.destroyEditor=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;u.closeEditor(h),o.view.render(),m&&$.isSelected()&&u.prepareEditor()},this.populateFromArray=function(h,m,S,E,O,k,Z){if(!(typeof S=="object"&&typeof S[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const Y=typeof E=="number"?o._createCellCoords(E,O):null;return c.populateFromArray(o._createCellCoords(h,m),S,Y,k,Z)},this.spliceCol=function(h,m,S){for(var E=arguments.length,O=new Array(E>3?E-3:0),k=3;k<E;k++)O[k-3]=arguments[k];return a.spliceCol(h,m,S,...O)},this.spliceRow=function(h,m,S){for(var E=arguments.length,O=new Array(E>3?E-3:0),k=3;k<E;k++)O[k-3]=arguments[k];return a.spliceRow(h,m,S,...O)},this.getSelected=function(){if($.isSelected())return hi($.getSelectedRange(),h=>{let{from:m,to:S}=h;return[m.row,m.col,S.row,S.col]})},this.getSelectedLast=function(){const h=this.getSelected();let m;return h&&h.length>0&&(m=h[h.length-1]),m},this.getSelectedRange=function(){if($.isSelected())return Array.from($.getSelectedRange())},this.getSelectedRangeLast=function(){const h=this.getSelectedRange();let m;return h&&h.length>0&&(m=h[h.length-1]),m},this.emptySelectedCells=function(h){if(!$.isSelected()||this.countRows()===0||this.countCols()===0)return;const m=[];we($.getSelectedRange(),S=>{if(S.isSingleHeader())return;const E=S.getTopStartCorner(),O=S.getBottomEndCorner();dt(E.row,O.row,k=>{dt(E.col,O.col,Z=>{this.getCellMeta(k,Z).readOnly||m.push([k,Z,null])})})}),m.length>0&&this.setDataAtCell(m,h)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const h=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(h,0),!this.isRenderSuspended()&&h===this.renderSuspendedCounter&&(this.renderCall?this.render():o.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(h){this.suspendRender();const m=h();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||h)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(h){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const S=h();return this.resumeExecution(m),S},this.batch=function(h){this.suspendRender(),this.suspendExecution();const m=h();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(!o.view)return;const{width:h,height:m}=o.view.getLastSize(),{width:S,height:E}=o.rootElement.getBoundingClientRect(),O=S!==h||E!==m;o.runHooks("beforeRefreshDimensions",{width:h,height:m},{width:S,height:E},O)!==!1&&((O||o.view._wt.wtOverlays.scrollableElement===o.rootWindow)&&(o.view.setLastSize(S,E),o.render()),o.runHooks("afterRefreshDimensions",{width:h,height:m},{width:S,height:E},O))},this.updateData=function(h,m){q0(h,S=>{a=S},S=>{a=S,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols(),$.refresh()},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"updateData",source:m,metaManager:y,firstRun:f})},this.loadData=function(h,m){q0(h,S=>{a=S},()=>{y.clearCellsCache(),o.initIndexMappers(),c.adjustRowsAndCols(),$.refresh(),f&&(f=[null,"loadData"])},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"loadData",source:m,metaManager:y,firstRun:f})},this.getInitialColumnCount=function(){const h=v.columns;let m=0;if(Array.isArray(h))m=h.length;else if(Ke(h))if(o.dataType==="array"){const S=this.countSourceCols();for(let E=0;E<S;E+=1)h(E)&&(m+=1)}else(o.dataType==="object"||o.dataType==="function")&&(m=a.colToPropCache.length);else if(Me(v.dataSchema)){const S=a.getSchema();m=Array.isArray(S)?S.length:yh(S)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(h,m,S,E){return Ft(h)?a.getAll():a.getRange(o._createCellCoords(h,m),o._createCellCoords(S,E),a.DESTINATION_RENDERER)},this.getCopyableText=function(h,m,S,E){return a.getCopyableText(o._createCellCoords(h,m),o._createCellCoords(S,E))},this.getCopyableData=function(h,m){return a.getCopyable(h,a.colToProp(m))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(h){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const S=(f?o.loadData:o.updateData).bind(this);let E=!1,O,k;if(Me(h.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Me(h.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Me(h.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(O in h)O==="data"||(O==="language"?q(h.language):O==="className"?ue("className",h.className):O==="tableClassName"&&o.table?(ue("tableClassName",h.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames()):Ve.getSingleton().isRegistered(O)||Ve.getSingleton().isDeprecated(O)?(Ke(h[O])||Array.isArray(h[O]))&&(h[O].initialHook=!0,o.addHook(O,h[O])):!m&&Lr(h,O)&&(R[O]=h[O]));h.data===void 0&&v.data===void 0?S(null,"updateSettings"):h.data!==void 0?S(h.data,"updateSettings"):h.columns!==void 0&&(a.createMap(),o.initIndexMappers());const Z=o.countCols(),Y=v.columns;if(Y&&Ke(Y)&&(E=!0),(h.cell!==void 0||h.cells!==void 0||h.columns!==void 0)&&y.clearCache(),Z>0)for(O=0,k=0;O<Z;O++){if(Y){const X=E?Y(O):Y[k];X&&y.updateColumnMeta(k,X)}k+=1}Me(h.cell)&&Le(h.cell,X=>{o.setCellMetaObject(X.row,X.col,X)}),o.runHooks("afterCellMetaReset");let ne=o.rootElement.style.height;ne!==""&&(ne=parseInt(o.rootElement.style.height,10));let oe=h.height;if(Ke(oe)&&(oe=oe()),m&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),oe===null){const X=o.rootElement.getAttribute("data-initialstyle");X&&(X.indexOf("height")>-1||X.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",X):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else oe!==void 0&&(o.rootElement.style.height=isNaN(oe)?`${oe}`:`${oe}px`,o.rootElement.style.overflow="hidden");if(typeof h.width<"u"){let X=h.width;Ke(X)&&(X=X()),o.rootElement.style.width=isNaN(X)?`${X}`:`${X}px`}m||(o.view&&(o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames()),o.runHooks("afterUpdateSettings",h)),c.adjustRowsAndCols(),o.view&&!f&&(o.forceFullRender=!0,o.view.render(),o.view._wt.wtOverlays.adjustElementsSize()),!m&&o.view&&(ne===""||oe===""||oe===void 0)&&ne!==oe&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const h=o.getSelectedLast();if(v.getValue){if(Ke(v.getValue))return v.getValue.call(o);if(h)return o.getData()[h[0][0]][v.getValue]}else if(h)return o.getDataAtCell(h[0],h[1])},this.getSettings=function(){return v},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(h,m,S,E,O){c.alter(h,m,S,E,O)},this.getCell=function(h,m){let S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,E=m,O=h;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;E=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(h>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(h)))return null;O=this.rowIndexMapper.getRenderableFromVisualIndex(h)}return O===null||E===null||O===void 0||E===void 0?null:o.view.getCellAtCoords(o._createCellCoords(O,E),S)},this.getCoords=function(h){const m=this.view._wt.wtTable.getCoords(h);if(m===null)return null;const{row:S,col:E}=m;let O=S,k=E;return S>=0&&(O=this.rowIndexMapper.getVisualFromRenderableIndex(S)),E>=0&&(k=this.columnIndexMapper.getVisualFromRenderableIndex(E)),o._createCellCoords(O,k)},this.colToProp=function(h){return a.colToProp(h)},this.propToCol=function(h){return a.propToCol(h)},this.toVisualRow=h=>this.rowIndexMapper.getVisualFromPhysicalIndex(h),this.toVisualColumn=h=>this.columnIndexMapper.getVisualFromPhysicalIndex(h),this.toPhysicalRow=h=>this.rowIndexMapper.getPhysicalFromVisualIndex(h),this.toPhysicalColumn=h=>this.columnIndexMapper.getPhysicalFromVisualIndex(h),this.getDataAtCell=function(h,m){return a.get(h,a.colToProp(m))},this.getDataAtRowProp=function(h,m){return a.get(h,m)},this.getDataAtCol=function(h){const m=[],S=a.getRange(o._createCellCoords(0,h),o._createCellCoords(v.data.length-1,h),a.DESTINATION_RENDERER);for(let E=0;E<S.length;E+=1)for(let O=0;O<S[E].length;O+=1)m.push(S[E][O]);return m},this.getDataAtProp=function(h){const m=[],S=a.getRange(o._createCellCoords(0,a.propToCol(h)),o._createCellCoords(v.data.length-1,a.propToCol(h)),a.DESTINATION_RENDERER);for(let E=0;E<S.length;E+=1)for(let O=0;O<S[E].length;O+=1)m.push(S[E][O]);return m},this.getSourceData=function(h,m,S,E){let O;return h===void 0?O=l.getData():O=l.getByRange(o._createCellCoords(h,m),o._createCellCoords(S,E)),O},this.getSourceDataArray=function(h,m,S,E){let O;return h===void 0?O=l.getData(!0):O=l.getByRange(o._createCellCoords(h,m),o._createCellCoords(S,E),!0),O},this.getSourceDataAtCol=function(h){return l.getAtColumn(h)},this.setSourceDataAtCell=function(h,m,S,E){const O=fe(h,m,S),k=this.hasHook("afterSetSourceDataAtCell"),Z=[];k&&we(O,ne=>{let[oe,X,ye]=ne;Z.push([oe,X,l.getAtCell(oe,X),ye])}),we(O,ne=>{let[oe,X,ye]=ne;l.setAtCell(oe,X,ye)}),k&&this.runHooks("afterSetSourceDataAtCell",Z,E),this.render();const Y=o.getActiveEditor();Y&&Me(Y.refreshValue)&&Y.refreshValue()},this.getSourceDataAtRow=function(h){return l.getAtRow(h)},this.getSourceDataAtCell=function(h,m){return l.getAtCell(h,m)},this.getDataAtRow=function(h){return a.getRange(o._createCellCoords(h,0),o._createCellCoords(h,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(h,m,S,E){const O=h===void 0?[0,0,this.countRows(),this.countCols()]:[h,m,S,E],[k,Z]=O;let[,,Y,ne]=O,oe=null,X=null;Y===void 0&&(Y=k),ne===void 0&&(ne=Z);let ye="mixed";return dt(Math.max(Math.min(k,Y),0),Math.max(k,Y),Ce=>{let p=!0;return dt(Math.max(Math.min(Z,ne),0),Math.max(Z,ne),V=>(X=this.getCellMeta(Ce,V).type,oe?p=oe===X:oe=X,p)),ye=p?X:"mixed",p}),ye},this.removeCellMeta=function(h,m,S){const[E,O]=[this.toPhysicalRow(h),this.toPhysicalColumn(m)];let k=y.getCellMetaKeyValue(E,O,S);o.runHooks("beforeRemoveCellMeta",h,m,S,k)!==!1&&(y.removeCellMeta(E,O,S),o.runHooks("afterRemoveCellMeta",h,m,S,k)),k=null},this.spliceCellsMeta=function(h){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var S=arguments.length,E=new Array(S>2?S-2:0),O=2;O<S;O++)E[O-2]=arguments[O];if(E.length>0&&!Array.isArray(E[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");m>0&&y.removeRow(this.toPhysicalRow(h),m),E.length>0&&we(E.reverse(),k=>{y.createRow(this.toPhysicalRow(h)),we(k,(Z,Y)=>this.setCellMetaObject(h,Y,Z))}),o.render()},this.setCellMetaObject=function(h,m,S){typeof S=="object"&&Le(S,(E,O)=>{this.setCellMeta(h,m,O,E)})},this.setCellMeta=function(h,m,S,E){if(o.runHooks("beforeSetCellMeta",h,m,S,E)===!1)return;let k=h,Z=m;h<this.countRows()&&(k=this.toPhysicalRow(h)),m<this.countCols()&&(Z=this.toPhysicalColumn(m)),y.setCellMeta(k,Z,S,E),o.runHooks("afterSetCellMeta",h,m,S,E)},this.getCellsMeta=function(){return y.getCellsMeta()},this.getCellMeta=function(h,m){let S=this.toPhysicalRow(h),E=this.toPhysicalColumn(m);return S===null&&(S=h),E===null&&(E=m),y.getCellMeta(S,E,{visualRow:h,visualColumn:m})},this.getColumnMeta=function(h){return y.getColumnMeta(this.toPhysicalColumn(h))},this.getCellMetaAtRow=function(h){return y.getCellsMetaAtRow(h)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||v.columns)},this.getCellRenderer=function(h,m){const S=typeof h=="number"?o.getCellMeta(h,m).renderer:h.renderer;return typeof S=="string"?Q1(S):Ft(S)?Q1("text"):S},this.getCellEditor=function(h,m){const S=typeof h=="number"?o.getCellMeta(h,m).editor:h.editor;return typeof S=="string"?P1(S):Ft(S)?P1("text"):S},this.getCellValidator=function(h,m){const S=typeof h=="number"?o.getCellMeta(h,m).validator:h.validator;return typeof S=="string"?oH(S):S},this.validateCells=function(h){this._validateCells(h)},this.validateRows=function(h,m){if(!Array.isArray(h))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,h)},this.validateColumns=function(h,m){if(!Array.isArray(h))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,h)},this._validateCells=function(h,m,S){const E=new A;h&&(E.onQueueEmpty=h);let O=o.countRows()-1;for(;O>=0;){if(m!==void 0&&m.indexOf(O)===-1){O-=1;continue}let k=o.countCols()-1;for(;k>=0;){if(S!==void 0&&S.indexOf(k)===-1){k-=1;continue}E.addValidatorToQueue(),o.validateCell(o.getDataAtCell(O,k),o.getCellMeta(O,k),Z=>{if(typeof Z!="boolean")throw new Error("Validation error: result is not boolean");Z===!1&&(E.valid=!1),E.removeValidatorFormQueue()},"validateCells"),k-=1}O-=1}E.checkIfQueueIsEmpty()},this.getRowHeader=function(h){let m=v.rowHeaders,S=h;return S!==void 0&&(S=o.runHooks("modifyRowHeader",S)),S===void 0?(m=[],dt(o.countRows()-1,E=>{m.push(o.getRowHeader(E))})):Array.isArray(m)&&m[S]!==void 0?m=m[S]:Ke(m)?m=m(S):m&&typeof m!="string"&&typeof m!="number"&&(m=S+1),m},this.hasRowHeaders=function(){return!!v.rowHeaders},this.hasColHeaders=function(){if(v.colHeaders!==void 0&&v.colHeaders!==null)return!!v.colHeaders;for(let h=0,m=o.countCols();h<m;h++)if(o.getColHeader(h))return!0;return!1},this.getColHeader=function(h){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const S=o.runHooks("modifyColHeader",h);if(S===void 0){const Y=[],ne=o.countCols();for(let oe=0;oe<ne;oe++)Y.push(o.getColHeader(oe));return Y}let E=v.colHeaders;const O=function(Y){const ne=[],oe=o.countCols();let X=0;for(;X<oe;X++)Ke(v.columns)&&v.columns(X)&&ne.push(X);return ne[Y]},k=o.toPhysicalColumn(S),Z=O(k);return v.colHeaders===!1?E=null:v.columns&&Ke(v.columns)&&v.columns(Z)&&v.columns(Z).title?E=v.columns(Z).title:v.columns&&v.columns[k]&&v.columns[k].title?E=v.columns[k].title:Array.isArray(v.colHeaders)&&v.colHeaders[k]!==void 0?E=v.colHeaders[k]:Ke(v.colHeaders)?E=v.colHeaders(k):v.colHeaders&&typeof v.colHeaders!="string"&&typeof v.colHeaders!="number"&&(E=sP(S)),E=o.runHooks("modifyColumnHeaderValue",E,h,m),E},this._getColWidthFromSettings=function(h){let m;if(h>=0&&(m=o.getCellMeta(0,h).width),(m===void 0||m===v.width)&&(m=v.colWidths),m!=null){switch(typeof m){case"object":m=m[h];break;case"function":m=m(h);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getColWidth=function(h){let m=o._getColWidthFromSettings(h);return m=o.runHooks("modifyColWidth",m,h),m===void 0&&(m=dl),m},this._getRowHeightFromSettings=function(h){let m=v.rowHeights;if(m!=null){switch(typeof m){case"object":m=m[h];break;case"function":m=m(h);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getRowHeight=function(h){let m=o._getRowHeightFromSettings(h);return m=o.runHooks("modifyRowHeight",m,h),m},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const h=v.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(h,m)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return Y1(o.countRows()-1,S=>{if(o.isEmptyRow(S))m+=1;else if(h===!0)return!1}),m},this.countEmptyCols=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return Y1(o.countCols()-1,S=>{if(o.isEmptyCol(S))m+=1;else if(h===!0)return!1}),m},this.isEmptyRow=function(h){return v.isEmptyRow.call(o,h)},this.isEmptyCol=function(h){return v.isEmptyCol.call(o,h)},this.selectCell=function(h,m,S,E){let O=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,k=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Ft(h)||Ft(m)?!1:this.selectCells([[h,m,S,E]],O,k)},this.selectCells=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&g.suspend();const E=$.selectCells(h);return E&&S&&o.listen(),g.resume(),E},this.selectColumns=function(h){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h,S=arguments.length>2?arguments[2]:void 0;return $.selectColumns(h,m,S)},this.selectRows=function(h){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h,S=arguments.length>2?arguments[2]:void 0;return $.selectRows(h,m,S)},this.deselectCell=function(){$.deselect()},this.selectAll=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h,S=arguments.length>2?arguments[2]:void 0;g.skipNextScrollCycle(),$.selectAll(h,m,S)};const ie=(h,m)=>h.getNearestNotHiddenIndex(m,1,!0);this.scrollViewportTo=function(h){var m;if(typeof h=="number"){var S;h={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(S=arguments[4])!==null&&S!==void 0?S:!0}}const{row:E,col:O,verticalSnap:k,horizontalSnap:Z,considerHiddenIndexes:Y}=(m=h)!==null&&m!==void 0?m:{};let ne,oe,X,ye;k!==void 0&&(ne=k==="top",oe=!ne),Z!==void 0&&(X=Z==="start",ye=!X);let Ce=E,p=O;if(Y===void 0||Y){const x=Number.isInteger(E)&&E>=0,_=Number.isInteger(O)&&O>=0,H=x?ie(this.rowIndexMapper,E):void 0,G=_?ie(this.columnIndexMapper,O):void 0;if(H===null||G===null)return!1;Ce=x?o.rowIndexMapper.getRenderableFromVisualIndex(H):E,p=_?o.columnIndexMapper.getRenderableFromVisualIndex(G):O}const V=Number.isInteger(Ce),F=Number.isInteger(p);return V&&Ce>=0&&F&&p>=0?o.view.scrollViewport(o._createCellCoords(Ce,p),ne,ye,oe,X):V&&Ce>=0&&(F&&p<0||!F)?o.view.scrollViewportVertically(Ce,ne,oe):F&&p>=0&&(V&&Ce<0||!V)?o.view.scrollViewportHorizontally(p,ye,X):!1},this.scrollToFocusedCell=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",h);const{highlight:m}=this.getSelectedRangeLast();this.scrollViewportTo(m.toObject())?this.view.render():(this.removeHook("afterScroll",h),this._registerImmediate(()=>h()))},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),y.clearCache(),zd.delete(this.guid),Ol(o)){const h=this.rootDocument.querySelector(".hot-display-license-info");h&&h.parentNode.removeChild(h)}Ji(o.rootElement),s.destroy(),u&&u.destroy(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),T.getItems().forEach(h=>{let[,m]=h;m.destroy()}),T.clear(),o.runHooks("afterDestroy")},!0),Ve.getSingleton().destroy(o),Le(o,(h,m,S)=>{Ke(h)?S[m]=U(m):m!=="guid"&&(S[m]=null)}),o.isDestroyed=!0,a&&a.destroy(),a=null,c=null,$=null,u=null,o=null};function U(h){return()=>{throw new Error(`The "${h}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return u.getActiveEditor()},this.getPlugin=function(h){const m=Qi(h);return m==="UndoRedo"?this.undoRedo:T.getItem(m)},this.getPluginName=function(h){return h===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:T.getId(h)},this.getInstance=function(){return o},this.addHook=function(h,m,S){Ve.getSingleton().add(h,m,o,S)},this.hasHook=function(h){return Ve.getSingleton().has(h,o)||Ve.getSingleton().has(h)},this.addHookOnce=function(h,m,S){Ve.getSingleton().once(h,m,o,S)},this.removeHook=function(h,m){Ve.getSingleton().remove(h,m,o)},this.runHooks=function(h,m,S,E,O,k,Z){return Ve.getSingleton().run(o,h,m,S,E,O,k,Z)},this.getTranslatedPhrase=function(h,m){return O0(v.language,h,m)},this.toHTML=()=>j1(this),this.toTableElement=()=>{const h=this.rootDocument.createElement("div");return h.insertAdjacentHTML("afterbegin",j1(this)),h.firstElementChild},this.timeouts=[],this._registerTimeout=function(h){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,S=h;typeof S=="function"&&(S=setTimeout(S,m)),this.timeouts.push(S)},this._clearTimeouts=function(){we(this.timeouts,h=>{clearTimeout(h)})},this.immediates=[],this._registerImmediate=function(h){this.immediates.push(setImmediate(h))},this._clearImmediates=function(){we(this.immediates,h=>{clearImmediate(h)})},this._getEditorManager=function(){return u},this.isRtl=function(){return o.rootWindow.getComputedStyle(o.rootElement).direction==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1};const me=g8({handleEvent(){return o.isListening()},beforeKeyDown:h=>this.runHooks("beforeKeyDown",h),afterKeyDown:h=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",h)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",h=>{h.ctrlKey===!1&&h.metaKey===!1&&me.releasePressedKeys()}),this.getShortcutManager=function(){return me},this.getFocusManager=function(){return d},q1().forEach(h=>{const m=zh(h);T.addItem(h,new m(this))}),QN(o),me.setActiveContextName("grid"),Ve.getSingleton().run(o,"construct")}function cv(t,e,n){t.addEventListener(e,n,!1)}function uv(t,e,n){t.removeEventListener(e,n,!1)}function hv(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function p8(t){const e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n=t.body,r=t.createTextNode(""),i=t.createElement("span");let o;function s(){r.textContent=o.value,i.style.position="absolute",i.style.fontSize=hv(o).fontSize,i.style.fontFamily=hv(o).fontFamily,i.style.whiteSpace="pre",n.appendChild(i);const u=i.clientWidth+2;n.removeChild(i);const d=o.style;d.height=`${e.minHeight}px`,e.minWidth>u?d.width=`${e.minWidth}px`:u>e.maxWidth?d.width=`${e.maxWidth}px`:d.width=`${u}px`;const g=o.scrollHeight?o.scrollHeight-1:0;e.minHeight>g?d.height=`${e.minHeight}px`:e.maxHeight<g?(d.height=`${e.maxHeight}px`,d.overflowY="visible"):d.height=`${g}px`}function a(){t.defaultView.setTimeout(s,0)}function l(u){if(u&&u.minHeight)if(u.minHeight==="inherit")e.minHeight=o.clientHeight;else{const d=parseInt(u.minHeight,10);isNaN(d)||(e.minHeight=d)}if(u&&u.maxHeight)if(u.maxHeight==="inherit")e.maxHeight=o.clientHeight;else{const d=parseInt(u.maxHeight,10);isNaN(d)||(e.maxHeight=d)}if(u&&u.minWidth)if(u.minWidth==="inherit")e.minWidth=o.clientWidth;else{const d=parseInt(u.minWidth,10);isNaN(d)||(e.minWidth=d)}if(u&&u.maxWidth)if(u.maxWidth==="inherit")e.maxWidth=o.clientWidth;else{const d=parseInt(u.maxWidth,10);isNaN(d)||(e.maxWidth=d)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(r))}function c(u,d){let g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;o=u,l(d),o.nodeName==="TEXTAREA"&&(o.style.resize="none",o.style.height=`${e.minHeight}px`,o.style.minWidth=`${e.minWidth}px`,o.style.maxWidth=`${e.maxWidth}px`,o.style.overflowY="hidden"),g&&(cv(o,"input",s),cv(o,"keydown",a)),s()}return{init:c,resize:s,unObserve(){uv(o,"input",s),uv(o,"keydown",a)}}}function dv(t,e){const n=HM(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}Jp(e,i)}function Ai(t,e,n){return(e=w8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w8(t){var e=b8(t,"string");return typeof e=="symbol"?e:e+""}function b8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const v8="ht_editor_visible",Xl="ht_editor_hidden",fv="textEditor",y8="text";class C8 extends Fd{static get EDITOR_TYPE(){return y8}constructor(e){super(e),Ai(this,"eventManager",new pi(this)),Ai(this,"autoResize",p8(this.hot.rootDocument)),Ai(this,"TEXTAREA",void 0),Ai(this,"textareaStyle",void 0),Ai(this,"TEXTAREA_PARENT",void 0),Ai(this,"textareaParentStyle",void 0),Ai(this,"layerClass",void 0),this.eventManager=new pi(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),TM(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==ot.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===ot.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),Jp(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Fe(this.TEXTAREA,[["data-hot-input",""],Ya(-1)]),this.hot.getSettings().ariaTags&&Fe(this.TEXTAREA,[uh()]),Ee(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),Ee(this.TEXTAREA_PARENT,"handsontableInputHolder"),Ye(this.TEXTAREA_PARENT,this.layerClass)&&Ge(this.TEXTAREA_PARENT,this.layerClass),Ee(this.TEXTAREA_PARENT,Xl),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){hA()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Ge(this.TEXTAREA_PARENT,this.layerClass),Ee(this.TEXTAREA_PARENT,Xl)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;dt(e.length-1,r=>{const i=e[r];if(Ye(i,"handsontableEditor"))return n=!0,!1}),Ye(this.TEXTAREA_PARENT,Xl)&&Ge(this.TEXTAREA_PARENT,Xl),n?(this.layerClass=v8,Ee(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Ee(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==ot.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=Pr(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const c=Pr(this.TEXTAREA),u=parseInt(c.paddingLeft,10)+parseInt(c.paddingRight,10),d=parseInt(c.paddingTop,10)+parseInt(c.paddingBottom,10),g=i-u,f=s-d,b=o-u,w=a-d;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(g,b),minHeight:Math.min(f,w),maxWidth:b,maxHeight:w},!0)}bindEvents(){S1()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===ot.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===ot.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>Me(this.hot.getSelected()),group:fv},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;dv(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;dv(a,this.TEXTAREA)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(fv)}}const S8="base";function mv(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],c=[],u=[],d=[];s.className&&Ee(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&d.push(Vp())):a&&u.push(Vp()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&d.push(zp())):(c.push(s.invalidCellClassName),a&&u.push(zp()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),Ge(e,c),Ee(e,l),ss(e,u),Fe(e,d)}mv.RENDERER_TYPE=S8;const R8="text";function gv(t,e,n,r,i,o,s){mv.apply(this,[t,e,n,r,i,o,s]);let a=o;if(!a&&s.placeholder&&(a=s.placeholder),a=ah(a),s.trimWhitespace&&(a=a.trim()),s.rendererTemplate){Ji(e);const l=t.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=t.getSourceDataAtRow(n),e.appendChild(l)}else as(e,a)}gv.RENDERER_TYPE=R8,T6({CELL_TYPE:"text",editor:C8,renderer:gv}),kn.editors={BaseEditor:Fd};function kn(t,e){const n=new lv(t,e||{},md);return n.init(),n}kn.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new lv(t,e,md)},kn.DefaultSettings=U0(),kn.hooks=Ve.getSingleton(),kn.CellCoords=bi,kn.CellRange=ys,kn.packageName="handsontable",kn.buildDate="30/07/2024 11:21:58",kn.version="14.5.0",kn.languages={dictionaryKeys:$P,getLanguageDictionary:x0,getLanguagesDictionaries:jP,registerLanguageDictionary:E0,getTranslatedPhrase:O0};function _8(t,e){pv(t,e),e.add(t)}function T8(t,e,n){pv(t,e),e.set(t,n)}function pv(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bo(t,e,n){return(e=E8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E8(t){var e=x8(t,"string");return typeof e=="symbol"?e:e+""}function x8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vo(t,e){return t.get(wv(t,e))}function wv(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const bv=new Map([["plugin",XI],["cell-type",j0],["editor",k1],["renderer",X1],["validator",J1]]),O8="base",jd=[];let tr=null;var Ii=new WeakMap,vv=new WeakSet;class Ql{static get PLUGIN_KEY(){return O8}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){_8(this,vv),bo(this,"eventManager",new pi(this)),bo(this,"pluginName",null),bo(this,"pluginsInitializedCallbacks",[]),bo(this,"isPluginsReady",!1),bo(this,"enabled",!1),bo(this,"initialized",!1),T8(this,Ii,{}),gr(this,"hot",e,{writable:!1}),tr=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!bv.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);bv.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");jd.push(o)}}if(tr||(tr=q1()),tr.indexOf("UndoRedo")>=0&&tr.splice(tr.indexOf("UndoRedo"),1),tr.indexOf(this.pluginName)>=0&&tr.splice(tr.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),tr.length===0){if(jd.length>0){const i=[`${jd.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,n,r){vo(Ii,this)[e]=vo(Ii,this)[e]||[];const i=vo(Ii,this)[e];this.hot.addHook(e,n,r),i.push(n),vo(Ii,this)[e]=i}removeHooks(e){we(vo(Ii,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=vo(Ii,this);Le(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){we(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=wv(vv,this,M8).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Le(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function M8(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function Hi(t,e,n){return(e=A8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A8(t){var e=I8(t,"string");return typeof e=="symbol"?e:e+""}function I8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class H8{constructor(e){Hi(this,"hot",null),Hi(this,"container",null),Hi(this,"injected",!1),Hi(this,"rows",[]),Hi(this,"columns",[]),Hi(this,"samples",null),Hi(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),we(this.rows,n=>{e(n.row,Qt(n.table)-1)})}getWidths(e){this.injected||this.injectTable(),we(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{we(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{we(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),c=this.hot.getCellRenderer(l),u=n.createElement("td");u.setAttribute("ghost-table",1),c(this.hot,u,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(u)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{we(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),we(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{we(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),c=n.createElement("td"),u=n.createElement("tr");c.setAttribute("ghost-table",1),l(this.hot,c,s,e,this.hot.colToProp(e),o.value,a),u.appendChild(c),r.appendChild(u)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.getColWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),c=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(c),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),Ee(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:c}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return Ee(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}}function Jl(t,e,n){return(e=k8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function k8(t){var e=P8(t,"string");return typeof e=="symbol"?e:e+""}function P8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ud{static get SAMPLE_COUNT(){return 3}constructor(e){Jl(this,"samples",null),Jl(this,"dataFactory",null),Jl(this,"customSampleCount",null),Jl(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Ud.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return dt(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return dt(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:c,bundleSeed:u}=l,d=typeof u=="string"&&u.length>0;let g;d?g=u:an(c)?g=`${Object.keys(c).length}`:Array.isArray(c)?g=`${c.length}`:g=`${ah(c).length}`,i.has(g)||i.set(g,{needed:this.getSampleCount(),strings:[]});const f=i.get(g);f.needed&&(!(s.indexOf(c)>-1)||this.allowDuplicates||d)&&(f.strings.push({value:c,[o]:a}),s.push(c),f.needed-=1)}),i}}function N8(t,e){Cv(t,e),e.add(t)}function yv(t,e,n){Cv(t,e),e.set(t,n)}function Cv(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bs(t,e,n){return(e=D8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function D8(t){var e=L8(t,"string");return typeof e=="symbol"?e:e+""}function L8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ki(t,e){return t.get(nr(t,e))}function Yd(t,e,n){return t.set(nr(t,e),n),n}function nr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}Ve.getSingleton().register("modifyAutoColumnSizeSeed");const Vs="autoColumnSize",F8=10,$8="autoColumnSize";var yo=new WeakMap,Co=new WeakMap,Tr=new WeakSet;class zs extends Ql{static get PLUGIN_KEY(){return Vs}static get PLUGIN_PRIORITY(){return F8}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),N8(this,Tr),Bs(this,"ghostTable",new H8(this.hot)),Bs(this,"samplesGenerator",new Ud((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(n,r);let a="";s.spanned||(a=this.hot.getDataAtCell(n,r));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),Bs(this,"inProgress",!1),Bs(this,"measuredColumns",0),Bs(this,"columnWidthsMap",new Hl),yv(this,yo,[]),yv(this,Co,[]),this.hot.columnIndexMapper.registerMap($8,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>nr(Tr,this,Sv).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[Vs]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Vs];n&&n.useHeaders!==null&&n.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",n.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return nr(Tr,e,V8).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return nr(Tr,e,z8).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return nr(Tr,e,U8).call(e,...i)}),this.addHook("beforeRender",()=>nr(Tr,this,B8).call(this)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("init",()=>nr(Tr,this,j8).call(this)),super.enablePlugin()}updatePlugin(){Yd(Co,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>nr(Tr,this,Sv).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const r=this.hot.renderCall;this.calculateColumnsWidth({from:e,to:n},void 0,r)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;dt(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&this.samplesGenerator.generateColumnSamples(s,o).forEach((c,u)=>this.ghostTable.addColumn(u,c))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((s,a)=>{const l=this.hot.toPhysicalColumn(s);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){y1(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:r,to:Math.min(r+zs.CALCULATION_STEP,i)},e,n),r=r+zs.CALCULATION_STEP+1,r<i?o=v1(s):(y1(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,n),r=a+1),r<i?s():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[Vs],n=e&&Lr(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&Lr(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Vs];let n=zs.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return an(e)&&(n=e.syncLimit,gM(n)?n=zI(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,dl))),i}getFirstVisibleColumn(){var e;return(e=this.hot.view.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.view.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((r,i,o)=>{const s=ki(yo,this).length;return(s-1<o||ki(yo,this)[o]!==i)&&r.push(this.hot.toVisualColumn(o)),s-1<o?ki(yo,this).push(i):ki(yo,this)[o]=i,r},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function W8(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const r=this.hot.toPhysicalColumn(n);r!==null&&(this.hot._getColWidthFromSettings(r)||this.samplesGenerator.generateColumnSamples(n,e).forEach((o,s)=>this.ghostTable.addColumn(s,o)))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((n,r)=>{const i=this.hot.toPhysicalColumn(n);this.columnWidthsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function B8(){this.calculateVisibleColumnsWidth(),this.inProgress||(nr(Tr,this,W8).call(this,ki(Co,this)),Yd(Co,this,[]))}function V8(t,e){e||this.recalculateAllColumnsWidth()}function z8(t){const e=t.reduce((n,r)=>{let[,i]=r;const o=this.hot.propToCol(i);return Number.isInteger(o)&&n.indexOf(o)===-1&&n.push(o),n},[]);ki(Co,this).push(...e)}function Sv(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function j8(){Yd(yo,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function U8(t){const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);ki(Co,this).push(...e)}function Y8(t){return{key:"copy",name(){return this.getTranslatedPhrase(Sd)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function G8(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?ze(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Td,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function K8(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?ze(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(_d,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Z8(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?ze(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Rd,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function q8(t){return{key:"cut",name(){return this.getTranslatedPhrase(Ed)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class X8{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class Q8{constructor(){this.clipboardData=new X8}preventDefault(){}}function J8(t,e){Rv(t,e),e.add(t)}function So(t,e,n){Rv(t,e),e.set(t,n)}function Rv(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kt(t,e){return t.get(_o(t,e))}function Ro(t,e,n){return t.set(_o(t,e),n),n}function _o(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var jr=new WeakMap,Gd=new WeakMap,js=new WeakMap,Kd=new WeakMap,Zd=new WeakMap,Us=new WeakMap,Ys=new WeakSet;class eD{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;J8(this,Ys),So(this,jr,void 0),So(this,Gd,void 0),So(this,js,void 0),So(this,Kd,void 0),So(this,Zd,void 0),So(this,Us,void 0),Ro(Gd,this,n),Ro(js,this,r),Ro(Kd,this,i),Ro(Zd,this,o),Ro(Us,this,s)}setSelectedRange(e){Ro(jr,this,e)}getCellsRange(){if(kt(Gd,this).call(this)===0||kt(js,this).call(this)===0)return null;const{row:e,col:n}=kt(jr,this).getTopStartCorner(),{row:r,col:i}=kt(jr,this).getBottomEndCorner(),o=_o(Ys,this,tD).call(this,e,r),s=_o(Ys,this,qd).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(kt(js,this).call(this)===0||kt(Us,this).call(this)===0)return null;const{col:e}=kt(jr,this).getTopStartCorner(),{col:n}=kt(jr,this).getBottomEndCorner(),r=_o(Ys,this,qd).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(kt(js,this).call(this)===0||kt(Us,this).call(this)===0)return null;const{col:e}=kt(jr,this).getTopStartCorner(),{col:n}=kt(jr,this).getBottomEndCorner(),r=_o(Ys,this,qd).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-kt(Us,this).call(this),startCol:e,endRow:-1,endCol:r}}}function qd(t,e){return Math.min(e,Math.max(t+kt(Zd,this).call(this)-1,t))}function tD(t,e){return Math.min(e,Math.max(t+kt(Kd,this).call(this)-1,t))}function _v(t){const e=[],n=[];return we(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);dt(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);dt(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function nD(t,e){Tv(t,e),e.add(t)}function Ur(t,e,n){Tv(t,e),e.set(t,n)}function Tv(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gs(t,e,n){return(e=rD(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rD(t){var e=iD(t,"string");return typeof e=="symbol"?e:e+""}function iD(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jt(t,e){return t.get(Ut(t,e))}function Pn(t,e,n){return t.set(Ut(t,e),n),n}function Ut(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}Ve.getSingleton().register("afterCopyLimit"),Ve.getSingleton().register("modifyCopyableRange"),Ve.getSingleton().register("beforeCut"),Ve.getSingleton().register("afterCut"),Ve.getSingleton().register("beforePaste"),Ve.getSingleton().register("afterPaste"),Ve.getSingleton().register("beforeCopy"),Ve.getSingleton().register("afterCopy");const ec="copyPaste",oD=80,sD=["fragmentSelection"],Ev=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var Xd=new WeakMap,Qd=new WeakMap,Jd=new WeakMap,To=new WeakMap,tc=new WeakMap,nc=new WeakMap,Eo=new WeakMap,rc=new WeakMap,Jt=new WeakSet;class aD extends Ql{constructor(){super(...arguments),nD(this,Jt),Gs(this,"columnsLimit",1/0),Gs(this,"rowsLimit",1/0),Gs(this,"pasteMode","overwrite"),Gs(this,"uiContainer",this.hot.rootDocument.body),Ur(this,Xd,!1),Ur(this,Qd,!1),Ur(this,Jd,!1),Ur(this,To,"cells-only"),Ur(this,tc,!1),Ur(this,nc,!1),Ur(this,Eo,new eD({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Ur(this,rc,!1),Gs(this,"copyableRanges",[])}static get PLUGIN_KEY(){return ec}static get SETTING_KEYS(){return[ec,...sD]}static get PLUGIN_PRIORITY(){return oD}isEnabled(){return!!this.hot.getSettings()[ec]}enablePlugin(){var e=this;if(this.enabled)return;const{[ec]:n}=this.hot.getSettings();if(typeof n=="object"){var r,i;this.pasteMode=(r=n.pasteMode)!==null&&r!==void 0?r:this.pasteMode,this.rowsLimit=isNaN(n.rowsLimit)?this.rowsLimit:n.rowsLimit,this.columnsLimit=isNaN(n.columnsLimit)?this.columnsLimit:n.columnsLimit,Pn(Xd,this,!!n.copyColumnHeaders),Pn(Qd,this,!!n.copyColumnGroupHeaders),Pn(Jd,this,!!n.copyColumnHeadersOnly),this.uiContainer=(i=n.uiContainer)!==null&&i!==void 0?i:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",o=>Ut(Jt,this,uD).call(this,o)),this.addHook("afterSelection",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Ut(Jt,e,hD).call(e,...s)}),this.addHook("afterSelectionEnd",()=>Ut(Jt,this,dD).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),C1()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Ut(Jt,e,fD).call(e,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Ut(Jt,e,mD).call(e,...s)}),this.addHook("afterSelection",()=>Ut(Jt,this,gD).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Pn(To,this,e),Pn(tc,this,!0),Ut(Jt,this,xv).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Pn(nc,this,!0),Ut(Jt,this,xv).call(this,"cut")}getRangedCopyableData(e){return Fs(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=_v(e);return we(r,o=>{const s=[];we(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new Q8;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}jt(Eo,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);jt(To,this)==="column-headers-only"?n.set("headers",jt(Eo,this).getMostBottomColumnHeadersRange()):(jt(To,this)==="with-column-headers"?n.set("headers",jt(Eo,this).getMostBottomColumnHeadersRange()):jt(To,this)==="with-column-group-headers"&&n.set("headers",jt(Eo,this).getAllColumnHeadersRange()),n.set("cells",jt(Eo,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:c}=n.getBottomEndCorner();let u=s,d=a,g=s,f=a;for(;o.length<r||u<=l;){const{skipRowOnPaste:b,visualRow:w}=this.hot.getCellMeta(u,a);if(u=w+1,b===!0)continue;g=w,d=a;const y=[],v=o.length%r;for(;y.length<i||d<=c;){const{skipColumnOnPaste:R,visualCol:T}=this.hot.getCellMeta(s,d);if(d=T+1,R===!0)continue;f=T;const M=y.length%i;y.push(e[v][M])}o.push(y)}return Pn(rc,this,!0),this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,g,f]}onCopy(e){if(!this.hot.isListening()&&!jt(tc,this)||this.isEditorOpened()||!this.hot.getSettings().outsideClickDeselects&&e.target!==this.hot.rootDocument.body)return;this.setCopyableText(),Pn(tc,this,!1);const n=this.getRangedData(this.copyableRanges),r=Ut(Jt,this,lD).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",n,this.copyableRanges,r)){const o=Fs(n);if(e&&e.clipboardData){const s=U1(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",o),e.clipboardData.setData("text/html",[Ev,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.runHooks("afterCopy",n,this.copyableRanges,r)}Pn(To,this,"cells-only"),e.preventDefault()}onCut(e){if(!this.hot.isListening()&&!jt(nc,this)||this.isEditorOpened()||!this.hot.getSettings().outsideClickDeselects&&e.target!==this.hot.rootDocument.body)return;this.setCopyableText(),Pn(nc,this,!1);const n=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",n,this.copyableRanges)){const i=Fs(n);if(e&&e.clipboardData){const o=U1(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",i),e.clipboardData.setData("text/html",[Ev,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",i);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",n,this.copyableRanges)}e.preventDefault()}onPaste(e){if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||!this.hot.getSettings().outsideClickDeselects&&e.target!==this.hot.rootDocument.body)return;e.preventDefault();let n;if(e&&typeof e.clipboardData<"u"){const a=Fp(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});a&&/(<table)|(<TABLE)/g.test(a)?n=BI(a,this.hot.rootDocument).data:n=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(n=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof n=="string"&&(n=v6(n)),n===void 0||n&&n.length===0||this.hot.runHooks("beforePaste",n,this.copyableRanges)===!1)return;const[r,i,o,s]=this.populateValues(n);this.hot.selectCell(r,i,Math.min(this.hot.countRows()-1,o),Math.min(this.hot.countCols()-1,s)),this.hot.runHooks("afterPaste",n,this.copyableRanges)}destroy(){super.destroy()}}function xv(t){if(C1()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&LM(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function lD(t){const{rows:e}=_v(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function cD(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&t1(r)}}}function Ov(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&n1(r)}}}function uD(t){t.items.push({name:"---------"},Y8(this)),jt(Xd,this)&&t.items.push(Z8(this)),jt(Qd,this)&&t.items.push(K8(this)),jt(Jd,this)&&t.items.push(G8(this)),t.items.push(q8(this))}function hD(t,e,n,r,i){jt(rc,this)&&(i.value=!0),Pn(rc,this,!1)}function dD(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function fD(){Ut(Jt,this,Ov).call(this)}function mD(){Ut(Jt,this,cD).call(this)}function gD(){Ut(Jt,this,Ov).call(this)}function pD(t,e){wD(t,e),e.add(t)}function wD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ef(t,e,n){return(e=bD(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bD(t){var e=vD(t,"string");return typeof e=="symbol"?e:e+""}function vD(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mv(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Av="dragToScroll",yD=100;var tf=new WeakSet;class CD extends Ql{constructor(){super(...arguments),pD(this,tf),ef(this,"boundaries",null),ef(this,"callback",null),ef(this,"listening",!1)}static get PLUGIN_KEY(){return Av}static get PLUGIN_PRIORITY(){return yD}isEnabled(){return!!this.hot.getSettings()[Av]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>Mv(tf,this,Iv).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>Mv(tf,this,Iv).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=os(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function Iv(t){if(nl(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,r)=>{var i,o;const s=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(s+Math.sign(n)*50,a+Math.sign(r)*20)}),this.listen()}function ic(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}function oc(t,e,n){return(e=SD(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SD(t){var e=RD(t,"string");return typeof e=="symbol"?e:e+""}function RD(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const nf=0,Hv=1,kv=2,xo="px";class Pv{constructor(e){oc(this,"hot",void 0),oc(this,"_element",null),oc(this,"state",nf),oc(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=kv}build(){this.state===nf&&(this._element=this.hot.rootDocument.createElement("div"),this.state=Hv)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=nf}isAppended(){return this.state===kv}isBuilt(){return this.state>=Hv}setPosition(e,n){Wr(e)&&(this._element.style.top=e+xo),Wr(n)&&(this._element.style[this.inlineProperty]=n+xo)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Wr(e)&&(this._element.style.width=e+xo),Wr(n)&&(this._element.style.height=n+xo)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Wr(e)&&(this._element.style.marginTop=e+xo),Wr(n)&&(this._element.style[`margin${Qi(this.inlineProperty)}`]=n+xo)}getOffset(){const e=this._element.style,n=`margin${Qi(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}}const _D="ht__manualColumnMove--backlight";class TD extends Pv{build(){super.build(),Ee(this._element,_D)}}const ED="ht__manualColumnMove--guideline";class xD extends Pv{build(){super.build(),Ee(this._element,ED)}}function OD(t,e){Nv(t,e),e.add(t)}function Nn(t,e,n){Nv(t,e),e.set(t,n)}function Nv(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yt(t,e,n){return t.set(Yr(t,e),n),n}function he(t,e){return t.get(Yr(t,e))}function Yr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}Ve.getSingleton().register("beforeColumnMove"),Ve.getSingleton().register("afterColumnMove");const rf="manualColumnMove",MD=120,Dv="ht__manualColumnMove",sc="show-ui",of="on-moving--columns",sf="after-selection--columns";var Pt=new WeakMap,Gr=new WeakMap,Er=new WeakMap,ac=new WeakMap,Kr=new WeakMap,Nt=new WeakMap,lc=new WeakMap,mn=new WeakMap,Oo=new WeakMap,cc=new WeakMap,Ks=new WeakMap,Pi=new WeakSet;class AD extends Ql{constructor(){super(...arguments),OD(this,Pi),Nn(this,Pt,new TD(this.hot)),Nn(this,Gr,new xD(this.hot)),Nn(this,Er,[]),Nn(this,ac,0),Nn(this,Kr,!1),Nn(this,Nt,{}),Nn(this,lc,void 0),Nn(this,mn,void 0),Nn(this,Oo,void 0),Nn(this,cc,void 0),Nn(this,Ks,void 0)}static get PLUGIN_KEY(){return rf}static get PLUGIN_PRIORITY(){return MD}isEnabled(){return!!this.hot.getSettings()[rf]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yr(Pi,e,ID).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yr(Pi,e,kD).call(e,...r)}),this.addHook("afterScrollVertically",()=>Yr(Pi,this,ND).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yr(Pi,e,DD).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),Ee(this.hot.rootElement,Dv),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Ge(this.hot.rootElement,Dv),this.unregisterEvents(),he(Pt,this).destroy(),he(Gr,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=he(lc,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(Yt(lc,this,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return Yt(lc,this,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=ts(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[rf];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return dt(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(he(mn,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,he(mn,this)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=he(Pt,this).getOffset().start,c=he(Pt,this).getSize().width;let u=0,d=0;if(this.hot.isRtl()){const b=this.hot.rootWindow,w=lt(this.hot.rootElement),y=b.innerWidth-he(Oo,this)-w;d=b.innerWidth-he(Nt,this).eventPageX-y-(r.scrollX===void 0?i:0)}else d=he(Nt,this).eventPageX-(he(Oo,this)-(r.scrollX===void 0?i:0));if(he(cc,this)&&(u=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(he(mn,this))&&(o+=i),o+=u,he(mn,this)<0)he(Ks,this)>0?he(Nt,this).col=0:he(Nt,this).col=e>0?e-1:e;else if(he(Nt,this).TD.offsetWidth/2+o<=d){const b=he(mn,this)>=he(ac,this)?he(ac,this)-1:he(mn,this);he(Nt,this).col=b+1,o+=he(Nt,this).TD.offsetWidth}else he(Nt,this).col=he(mn,this);let g=d,f=o;d+c+l>=s?g=s-c-l:d+l<a+u&&(g=a+u+Math.abs(l)),o>=s-1?f=s-1:f===0?f=1:r.scrollX!==void 0&&he(mn,this)<he(Ks,this)&&(f-=he(Oo,this)<=r.scrollX?he(Oo,this):0),he(Pt,this).setPosition(null,g),he(Gr,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Yr(Pi,this,HD).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Yr(Pi,this,PD).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){he(Pt,this).build(),he(Gr,this).build()}destroy(){he(Pt,this).destroy(),he(Gr,this).destroy(),super.destroy()}}function ID(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=Ye(t.target,"sortAction");if(!s||!o||he(Kr,this)||t.button!==0||a){Yt(Kr,this,!1),he(Er,this).length=0,Ge(this.hot.rootElement,[of,sc]);return}const l=he(Gr,this).isBuilt()&&!he(Gr,this).isAppended(),c=he(Pt,this).isBuilt()&&!he(Pt,this).isAppended();l&&c&&(he(Gr,this).appendTo(i.hider),he(Pt,this).appendTo(i.hider));const{from:u,to:d}=s,g=Math.min(u.col,d.col),f=Math.max(u.col,d.col);if(e.row<0&&e.col>=g&&e.col<=f){r.column=!0,Yt(Kr,this,!0);const b=n.firstChild?wA(t,n.firstChild).x:t.offsetX;he(Nt,this).eventPageX=t.pageX,Yt(mn,this,e.col),he(Nt,this).TD=n,he(Nt,this).col=e.col,Yt(Er,this,this.prepareColumnsToMoving(g,f)),Yt(cc,this,!!this.hot.getSettings().rowHeaders),Yt(ac,this,this.hot.countCols()),Yt(Ks,this,this.hot.getSettings().fixedColumnsStart),Yt(Oo,this,Xt(this.hot.rootElement).left);const w=he(cc,this)?-1:0,y=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,v=e.col<he(Ks,this),R=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),T=Math.abs(b-(this.hot.isRtl()?n.offsetWidth:0)),M=this.getColumnsWidth(g,e.col-1)+T,I=this.getColumnsWidth(w,g-1)+(v?R:0)+M;he(Pt,this).setPosition(y,I),he(Pt,this).setSize(this.getColumnsWidth(g,f),i.hider.offsetHeight-y),he(Pt,this).setOffset(null,-M),Ee(this.hot.rootElement,of)}else Ge(this.hot.rootElement,sf),Yt(Kr,this,!1),he(Er,this).length=0}function HD(t){he(Kr,this)&&(he(Nt,this).eventPageX=t.pageX,this.refreshPositions())}function kD(t,e,n,r){!this.hot.getSelectedRangeLast()||!he(Kr,this)||(he(Er,this).indexOf(e.col)>-1?Ge(this.hot.rootElement,sc):Ee(this.hot.rootElement,sc),r.row=!0,r.column=!0,r.cell=!0,Yt(mn,this,e.col),he(Nt,this).TD=n)}function PD(){const t=he(Nt,this).col,e=he(Er,this).length;if(Yt(mn,this,void 0),Yt(Kr,this,!1),Ge(this.hot.rootElement,[of,sc,sf]),this.hot.selection.isSelectedByColumnHeader()&&Ee(this.hot.rootElement,sf),e<1||t===void 0)return;const n=he(Er,this)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(he(Er,this),t);if(he(Er,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function ND(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;he(Pt,this).setPosition(r),he(Pt,this).setSize(null,t.hider.offsetHeight-r)}function DD(){this.moveBySettingsOrLoad()}const LD=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" slot="app-icon">
  <path d="M453-280h60v-240h-60v240Zm26.982-314q14.018 0 23.518-9.2T513-626q0-14.45-9.482-24.225-9.483-9.775-23.5-9.775-14.018 0-23.518 9.775T447-626q0 13.6 9.482 22.8 9.483 9.2 23.5 9.2Zm.284 514q-82.734 0-155.5-31.5t-127.266-86q-54.5-54.5-86-127.341Q80-397.681 80-480.5q0-82.819 31.5-155.659Q143-709 197.5-763t127.341-85.5Q397.681-880 480.5-880q82.819 0 155.659 31.5Q709-817 763-763t85.5 127Q880-563 880-480.266q0 82.734-31.5 155.5T763-197.684q-54 54.316-127 86Q563-80 480.266-80Zm.234-60Q622-140 721-239.5t99-241Q820-622 721.188-721 622.375-820 480-820q-141 0-240.5 98.812Q140-622.375 140-480q0 141 99.5 240.5t241 99.5Zm-.5-340Z" />
</svg>
`;var Lv={exports:{}};/*!

  JSZip v3.10.1 - A JavaScript class for generating and reading zip files
  <http://stuartk.com/jszip>

  (c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
  Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

  JSZip uses the library pako released under the MIT license :
  https://github.com/nodeca/pako/blob/main/LICENSE
  */(function(t,e){(function(n){t.exports=n()})(function(){return function n(r,i,o){function s(c,u){if(!i[c]){if(!r[c]){var d=typeof ic=="function"&&ic;if(!u&&d)return d(c,!0);if(a)return a(c,!0);var g=new Error("Cannot find module '"+c+"'");throw g.code="MODULE_NOT_FOUND",g}var f=i[c]={exports:{}};r[c][0].call(f.exports,function(b){var w=r[c][1][b];return s(w||b)},f,f.exports,n,r,i,o)}return i[c].exports}for(var a=typeof ic=="function"&&ic,l=0;l<o.length;l++)s(o[l]);return s}({1:[function(n,r,i){var o=n("./utils"),s=n("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(l){for(var c,u,d,g,f,b,w,y=[],v=0,R=l.length,T=R,M=o.getTypeOf(l)!=="string";v<l.length;)T=R-v,d=M?(c=l[v++],u=v<R?l[v++]:0,v<R?l[v++]:0):(c=l.charCodeAt(v++),u=v<R?l.charCodeAt(v++):0,v<R?l.charCodeAt(v++):0),g=c>>2,f=(3&c)<<4|u>>4,b=1<T?(15&u)<<2|d>>6:64,w=2<T?63&d:64,y.push(a.charAt(g)+a.charAt(f)+a.charAt(b)+a.charAt(w));return y.join("")},i.decode=function(l){var c,u,d,g,f,b,w=0,y=0,v="data:";if(l.substr(0,v.length)===v)throw new Error("Invalid base64 input, it looks like a data url.");var R,T=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===a.charAt(64)&&T--,l.charAt(l.length-2)===a.charAt(64)&&T--,T%1!=0)throw new Error("Invalid base64 input, bad content length.");for(R=s.uint8array?new Uint8Array(0|T):new Array(0|T);w<l.length;)c=a.indexOf(l.charAt(w++))<<2|(g=a.indexOf(l.charAt(w++)))>>4,u=(15&g)<<4|(f=a.indexOf(l.charAt(w++)))>>2,d=(3&f)<<6|(b=a.indexOf(l.charAt(w++))),R[y++]=c,f!==64&&(R[y++]=u),b!==64&&(R[y++]=d);return R}},{"./support":30,"./utils":32}],2:[function(n,r,i){var o=n("./external"),s=n("./stream/DataWorker"),a=n("./stream/Crc32Probe"),l=n("./stream/DataLengthProbe");function c(u,d,g,f,b){this.compressedSize=u,this.uncompressedSize=d,this.crc32=g,this.compression=f,this.compressedContent=b}c.prototype={getContentWorker:function(){var u=new s(o.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),d=this;return u.on("end",function(){if(this.streamInfo.data_length!==d.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new s(o.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(u,d,g){return u.pipe(new a).pipe(new l("uncompressedSize")).pipe(d.compressWorker(g)).pipe(new l("compressedSize")).withStreamInfo("compression",d)},r.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,r,i){var o=n("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new o("STORE compression")},uncompressWorker:function(){return new o("STORE decompression")}},i.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,r,i){var o=n("./utils"),s=function(){for(var a,l=[],c=0;c<256;c++){a=c;for(var u=0;u<8;u++)a=1&a?3988292384^a>>>1:a>>>1;l[c]=a}return l}();r.exports=function(a,l){return a!==void 0&&a.length?o.getTypeOf(a)!=="string"?function(c,u,d,g){var f=s,b=g+d;c^=-1;for(var w=g;w<b;w++)c=c>>>8^f[255&(c^u[w])];return-1^c}(0|l,a,a.length,0):function(c,u,d,g){var f=s,b=g+d;c^=-1;for(var w=g;w<b;w++)c=c>>>8^f[255&(c^u.charCodeAt(w))];return-1^c}(0|l,a,a.length,0):0}},{"./utils":32}],5:[function(n,r,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(n,r,i){var o=null;o=typeof Promise<"u"?Promise:n("lie"),r.exports={Promise:o}},{lie:37}],7:[function(n,r,i){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",s=n("pako"),a=n("./utils"),l=n("./stream/GenericWorker"),c=o?"uint8array":"array";function u(d,g){l.call(this,"FlateWorker/"+d),this._pako=null,this._pakoAction=d,this._pakoOptions=g,this.meta={}}i.magic="\b\0",a.inherits(u,l),u.prototype.processChunk=function(d){this.meta=d.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(c,d.data),!1)},u.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var d=this;this._pako.onData=function(g){d.push({data:g,meta:d.meta})}},i.compressWorker=function(d){return new u("Deflate",d)},i.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,r,i){function o(f,b){var w,y="";for(w=0;w<b;w++)y+=String.fromCharCode(255&f),f>>>=8;return y}function s(f,b,w,y,v,R){var T,M,I=f.file,L=f.compression,N=R!==c.utf8encode,$=a.transformTo("string",R(I.name)),W=a.transformTo("string",c.utf8encode(I.name)),q=I.comment,ue=a.transformTo("string",R(q)),A=a.transformTo("string",c.utf8encode(q)),B=W.length!==I.name.length,C=A.length!==q.length,z="",fe="",K="",ie=I.dir,U=I.date,me={crc32:0,compressedSize:0,uncompressedSize:0};b&&!w||(me.crc32=f.crc32,me.compressedSize=f.compressedSize,me.uncompressedSize=f.uncompressedSize);var h=0;b&&(h|=8),N||!B&&!C||(h|=2048);var m=0,S=0;ie&&(m|=16),v==="UNIX"?(S=798,m|=function(O,k){var Z=O;return O||(Z=k?16893:33204),(65535&Z)<<16}(I.unixPermissions,ie)):(S=20,m|=function(O){return 63&(O||0)}(I.dosPermissions)),T=U.getUTCHours(),T<<=6,T|=U.getUTCMinutes(),T<<=5,T|=U.getUTCSeconds()/2,M=U.getUTCFullYear()-1980,M<<=4,M|=U.getUTCMonth()+1,M<<=5,M|=U.getUTCDate(),B&&(fe=o(1,1)+o(u($),4)+W,z+="up"+o(fe.length,2)+fe),C&&(K=o(1,1)+o(u(ue),4)+A,z+="uc"+o(K.length,2)+K);var E="";return E+=`
\0`,E+=o(h,2),E+=L.magic,E+=o(T,2),E+=o(M,2),E+=o(me.crc32,4),E+=o(me.compressedSize,4),E+=o(me.uncompressedSize,4),E+=o($.length,2),E+=o(z.length,2),{fileRecord:d.LOCAL_FILE_HEADER+E+$+z,dirRecord:d.CENTRAL_FILE_HEADER+o(S,2)+E+o(ue.length,2)+"\0\0\0\0"+o(m,4)+o(y,4)+$+z+ue}}var a=n("../utils"),l=n("../stream/GenericWorker"),c=n("../utf8"),u=n("../crc32"),d=n("../signature");function g(f,b,w,y){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=b,this.zipPlatform=w,this.encodeFileName=y,this.streamFiles=f,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(g,l),g.prototype.push=function(f){var b=f.meta.percent||0,w=this.entriesCount,y=this._sources.length;this.accumulate?this.contentBuffer.push(f):(this.bytesWritten+=f.data.length,l.prototype.push.call(this,{data:f.data,meta:{currentFile:this.currentFile,percent:w?(b+100*(w-y-1))/w:100}}))},g.prototype.openedSource=function(f){this.currentSourceOffset=this.bytesWritten,this.currentFile=f.file.name;var b=this.streamFiles&&!f.file.dir;if(b){var w=s(f,b,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:w.fileRecord,meta:{percent:0}})}else this.accumulate=!0},g.prototype.closedSource=function(f){this.accumulate=!1;var b=this.streamFiles&&!f.file.dir,w=s(f,b,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(w.dirRecord),b)this.push({data:function(y){return d.DATA_DESCRIPTOR+o(y.crc32,4)+o(y.compressedSize,4)+o(y.uncompressedSize,4)}(f),meta:{percent:100}});else for(this.push({data:w.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},g.prototype.flush=function(){for(var f=this.bytesWritten,b=0;b<this.dirRecords.length;b++)this.push({data:this.dirRecords[b],meta:{percent:100}});var w=this.bytesWritten-f,y=function(v,R,T,M,I){var L=a.transformTo("string",I(M));return d.CENTRAL_DIRECTORY_END+"\0\0\0\0"+o(v,2)+o(v,2)+o(R,4)+o(T,4)+o(L.length,2)+L}(this.dirRecords.length,w,f,this.zipComment,this.encodeFileName);this.push({data:y,meta:{percent:100}})},g.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},g.prototype.registerPrevious=function(f){this._sources.push(f);var b=this;return f.on("data",function(w){b.processChunk(w)}),f.on("end",function(){b.closedSource(b.previous.streamInfo),b._sources.length?b.prepareNextSource():b.end()}),f.on("error",function(w){b.error(w)}),this},g.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},g.prototype.error=function(f){var b=this._sources;if(!l.prototype.error.call(this,f))return!1;for(var w=0;w<b.length;w++)try{b[w].error(f)}catch{}return!0},g.prototype.lock=function(){l.prototype.lock.call(this);for(var f=this._sources,b=0;b<f.length;b++)f[b].lock()},r.exports=g},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,r,i){var o=n("../compressions"),s=n("./ZipFileWorker");i.generateWorker=function(a,l,c){var u=new s(l.streamFiles,c,l.platform,l.encodeFileName),d=0;try{a.forEach(function(g,f){d++;var b=function(R,T){var M=R||T,I=o[M];if(!I)throw new Error(M+" is not a valid compression method !");return I}(f.options.compression,l.compression),w=f.options.compressionOptions||l.compressionOptions||{},y=f.dir,v=f.date;f._compressWorker(b,w).withStreamInfo("file",{name:g,dir:y,date:v,comment:f.comment||"",unixPermissions:f.unixPermissions,dosPermissions:f.dosPermissions}).pipe(u)}),u.entriesCount=d}catch(g){u.error(g)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,r,i){function o(){if(!(this instanceof o))return new o;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var s=new o;for(var a in this)typeof this[a]!="function"&&(s[a]=this[a]);return s}}(o.prototype=n("./object")).loadAsync=n("./load"),o.support=n("./support"),o.defaults=n("./defaults"),o.version="3.10.1",o.loadAsync=function(s,a){return new o().loadAsync(s,a)},o.external=n("./external"),r.exports=o},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,r,i){var o=n("./utils"),s=n("./external"),a=n("./utf8"),l=n("./zipEntries"),c=n("./stream/Crc32Probe"),u=n("./nodejsUtils");function d(g){return new s.Promise(function(f,b){var w=g.decompressed.getContentWorker().pipe(new c);w.on("error",function(y){b(y)}).on("end",function(){w.streamInfo.crc32!==g.decompressed.crc32?b(new Error("Corrupted zip : CRC32 mismatch")):f()}).resume()})}r.exports=function(g,f){var b=this;return f=o.extend(f||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),u.isNode&&u.isStream(g)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):o.prepareContent("the loaded zip file",g,!0,f.optimizedBinaryString,f.base64).then(function(w){var y=new l(f);return y.load(w),y}).then(function(w){var y=[s.Promise.resolve(w)],v=w.files;if(f.checkCRC32)for(var R=0;R<v.length;R++)y.push(d(v[R]));return s.Promise.all(y)}).then(function(w){for(var y=w.shift(),v=y.files,R=0;R<v.length;R++){var T=v[R],M=T.fileNameStr,I=o.resolve(T.fileNameStr);b.file(I,T.decompressed,{binary:!0,optimizedBinaryString:!0,date:T.date,dir:T.dir,comment:T.fileCommentStr.length?T.fileCommentStr:null,unixPermissions:T.unixPermissions,dosPermissions:T.dosPermissions,createFolders:f.createFolders}),T.dir||(b.file(I).unsafeOriginalName=M)}return y.zipComment.length&&(b.comment=y.zipComment),b})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,r,i){var o=n("../utils"),s=n("../stream/GenericWorker");function a(l,c){s.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(c)}o.inherits(a,s),a.prototype._bindStream=function(l){var c=this;(this._stream=l).pause(),l.on("data",function(u){c.push({data:u,meta:{percent:0}})}).on("error",function(u){c.isPaused?this.generatedError=u:c.error(u)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},a.prototype.pause=function(){return!!s.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,r,i){var o=n("readable-stream").Readable;function s(a,l,c){o.call(this,l),this._helper=a;var u=this;a.on("data",function(d,g){u.push(d)||u._helper.pause(),c&&c(g)}).on("error",function(d){u.emit("error",d)}).on("end",function(){u.push(null)})}n("../utils").inherits(s,o),s.prototype._read=function(){this._helper.resume()},r.exports=s},{"../utils":32,"readable-stream":16}],14:[function(n,r,i){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(o,s){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(o,s);if(typeof o=="number")throw new Error('The "data" argument must not be a number');return new Buffer(o,s)},allocBuffer:function(o){if(Buffer.alloc)return Buffer.alloc(o);var s=new Buffer(o);return s.fill(0),s},isBuffer:function(o){return Buffer.isBuffer(o)},isStream:function(o){return o&&typeof o.on=="function"&&typeof o.pause=="function"&&typeof o.resume=="function"}}},{}],15:[function(n,r,i){function o(I,L,N){var $,W=a.getTypeOf(L),q=a.extend(N||{},u);q.date=q.date||new Date,q.compression!==null&&(q.compression=q.compression.toUpperCase()),typeof q.unixPermissions=="string"&&(q.unixPermissions=parseInt(q.unixPermissions,8)),q.unixPermissions&&16384&q.unixPermissions&&(q.dir=!0),q.dosPermissions&&16&q.dosPermissions&&(q.dir=!0),q.dir&&(I=v(I)),q.createFolders&&($=y(I))&&R.call(this,$,!0);var ue=W==="string"&&q.binary===!1&&q.base64===!1;N&&N.binary!==void 0||(q.binary=!ue),(L instanceof d&&L.uncompressedSize===0||q.dir||!L||L.length===0)&&(q.base64=!1,q.binary=!0,L="",q.compression="STORE",W="string");var A=null;A=L instanceof d||L instanceof l?L:b.isNode&&b.isStream(L)?new w(I,L):a.prepareContent(I,L,q.binary,q.optimizedBinaryString,q.base64);var B=new g(I,A,q);this.files[I]=B}var s=n("./utf8"),a=n("./utils"),l=n("./stream/GenericWorker"),c=n("./stream/StreamHelper"),u=n("./defaults"),d=n("./compressedObject"),g=n("./zipObject"),f=n("./generate"),b=n("./nodejsUtils"),w=n("./nodejs/NodejsStreamInputAdapter"),y=function(I){I.slice(-1)==="/"&&(I=I.substring(0,I.length-1));var L=I.lastIndexOf("/");return 0<L?I.substring(0,L):""},v=function(I){return I.slice(-1)!=="/"&&(I+="/"),I},R=function(I,L){return L=L!==void 0?L:u.createFolders,I=v(I),this.files[I]||o.call(this,I,null,{dir:!0,createFolders:L}),this.files[I]};function T(I){return Object.prototype.toString.call(I)==="[object RegExp]"}var M={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(I){var L,N,$;for(L in this.files)$=this.files[L],(N=L.slice(this.root.length,L.length))&&L.slice(0,this.root.length)===this.root&&I(N,$)},filter:function(I){var L=[];return this.forEach(function(N,$){I(N,$)&&L.push($)}),L},file:function(I,L,N){if(arguments.length!==1)return I=this.root+I,o.call(this,I,L,N),this;if(T(I)){var $=I;return this.filter(function(q,ue){return!ue.dir&&$.test(q)})}var W=this.files[this.root+I];return W&&!W.dir?W:null},folder:function(I){if(!I)return this;if(T(I))return this.filter(function(W,q){return q.dir&&I.test(W)});var L=this.root+I,N=R.call(this,L),$=this.clone();return $.root=N.name,$},remove:function(I){I=this.root+I;var L=this.files[I];if(L||(I.slice(-1)!=="/"&&(I+="/"),L=this.files[I]),L&&!L.dir)delete this.files[I];else for(var N=this.filter(function(W,q){return q.name.slice(0,I.length)===I}),$=0;$<N.length;$++)delete this.files[N[$].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(I){var L,N={};try{if((N=a.extend(I||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode})).type=N.type.toLowerCase(),N.compression=N.compression.toUpperCase(),N.type==="binarystring"&&(N.type="string"),!N.type)throw new Error("No output type specified.");a.checkSupport(N.type),N.platform!=="darwin"&&N.platform!=="freebsd"&&N.platform!=="linux"&&N.platform!=="sunos"||(N.platform="UNIX"),N.platform==="win32"&&(N.platform="DOS");var $=N.comment||this.comment||"";L=f.generateWorker(this,N,$)}catch(W){(L=new l("error")).error(W)}return new c(L,N.type||"string",N.mimeType)},generateAsync:function(I,L){return this.generateInternalStream(I).accumulate(L)},generateNodeStream:function(I,L){return(I=I||{}).type||(I.type="nodebuffer"),this.generateInternalStream(I).toNodejsStream(L)}};r.exports=M},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,r,i){r.exports=n("stream")},{stream:void 0}],17:[function(n,r,i){var o=n("./DataReader");function s(a){o.call(this,a);for(var l=0;l<this.data.length;l++)a[l]=255&a[l]}n("../utils").inherits(s,o),s.prototype.byteAt=function(a){return this.data[this.zero+a]},s.prototype.lastIndexOfSignature=function(a){for(var l=a.charCodeAt(0),c=a.charCodeAt(1),u=a.charCodeAt(2),d=a.charCodeAt(3),g=this.length-4;0<=g;--g)if(this.data[g]===l&&this.data[g+1]===c&&this.data[g+2]===u&&this.data[g+3]===d)return g-this.zero;return-1},s.prototype.readAndCheckSignature=function(a){var l=a.charCodeAt(0),c=a.charCodeAt(1),u=a.charCodeAt(2),d=a.charCodeAt(3),g=this.readData(4);return l===g[0]&&c===g[1]&&u===g[2]&&d===g[3]},s.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},r.exports=s},{"../utils":32,"./DataReader":18}],18:[function(n,r,i){var o=n("../utils");function s(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}s.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var l,c=0;for(this.checkOffset(a),l=this.index+a-1;l>=this.index;l--)c=(c<<8)+this.byteAt(l);return this.index+=a,c},readString:function(a){return o.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},r.exports=s},{"../utils":32}],19:[function(n,r,i){var o=n("./Uint8ArrayReader");function s(a){o.call(this,a)}n("../utils").inherits(s,o),s.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},r.exports=s},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,r,i){var o=n("./DataReader");function s(a){o.call(this,a)}n("../utils").inherits(s,o),s.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},s.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},s.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},s.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},r.exports=s},{"../utils":32,"./DataReader":18}],21:[function(n,r,i){var o=n("./ArrayReader");function s(a){o.call(this,a)}n("../utils").inherits(s,o),s.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},r.exports=s},{"../utils":32,"./ArrayReader":17}],22:[function(n,r,i){var o=n("../utils"),s=n("../support"),a=n("./ArrayReader"),l=n("./StringReader"),c=n("./NodeBufferReader"),u=n("./Uint8ArrayReader");r.exports=function(d){var g=o.getTypeOf(d);return o.checkSupport(g),g!=="string"||s.uint8array?g==="nodebuffer"?new c(d):s.uint8array?new u(o.transformTo("uint8array",d)):new a(o.transformTo("array",d)):new l(d)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,r,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,r,i){var o=n("./GenericWorker"),s=n("../utils");function a(l){o.call(this,"ConvertWorker to "+l),this.destType=l}s.inherits(a,o),a.prototype.processChunk=function(l){this.push({data:s.transformTo(this.destType,l.data),meta:l.meta})},r.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(n,r,i){var o=n("./GenericWorker"),s=n("../crc32");function a(){o.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(a,o),a.prototype.processChunk=function(l){this.streamInfo.crc32=s(l.data,this.streamInfo.crc32||0),this.push(l)},r.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,r,i){var o=n("../utils"),s=n("./GenericWorker");function a(l){s.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}o.inherits(a,s),a.prototype.processChunk=function(l){if(l){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+l.data.length}s.prototype.processChunk.call(this,l)},r.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(n,r,i){var o=n("../utils"),s=n("./GenericWorker");function a(l){s.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(u){c.dataIsReady=!0,c.data=u,c.max=u&&u.length||0,c.type=o.getTypeOf(u),c.isPaused||c._tickAndRepeat()},function(u){c.error(u)})}o.inherits(a,s),a.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,o.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(o.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,c);break;case"uint8array":l=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":l=this.data.slice(this.index,c)}return this.index=c,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(n,r,i){function o(s){this.name=s||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}o.prototype={push:function(s){this.emit("data",s)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(s){this.emit("error",s)}return!0},error:function(s){return!this.isFinished&&(this.isPaused?this.generatedError=s:(this.isFinished=!0,this.emit("error",s),this.previous&&this.previous.error(s),this.cleanUp()),!0)},on:function(s,a){return this._listeners[s].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(s,a){if(this._listeners[s])for(var l=0;l<this._listeners[s].length;l++)this._listeners[s][l].call(this,a)},pipe:function(s){return s.registerPrevious(this)},registerPrevious:function(s){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=s.streamInfo,this.mergeStreamInfo(),this.previous=s;var a=this;return s.on("data",function(l){a.processChunk(l)}),s.on("end",function(){a.end()}),s.on("error",function(l){a.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var s=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),s=!0),this.previous&&this.previous.resume(),!s},flush:function(){},processChunk:function(s){this.push(s)},withStreamInfo:function(s,a){return this.extraStreamInfo[s]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var s in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,s)&&(this.streamInfo[s]=this.extraStreamInfo[s])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var s="Worker "+this.name;return this.previous?this.previous+" -> "+s:s}},r.exports=o},{}],29:[function(n,r,i){var o=n("../utils"),s=n("./ConvertWorker"),a=n("./GenericWorker"),l=n("../base64"),c=n("../support"),u=n("../external"),d=null;if(c.nodestream)try{d=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function g(b,w){return new u.Promise(function(y,v){var R=[],T=b._internalType,M=b._outputType,I=b._mimeType;b.on("data",function(L,N){R.push(L),w&&w(N)}).on("error",function(L){R=[],v(L)}).on("end",function(){try{var L=function(N,$,W){switch(N){case"blob":return o.newBlob(o.transformTo("arraybuffer",$),W);case"base64":return l.encode($);default:return o.transformTo(N,$)}}(M,function(N,$){var W,q=0,ue=null,A=0;for(W=0;W<$.length;W++)A+=$[W].length;switch(N){case"string":return $.join("");case"array":return Array.prototype.concat.apply([],$);case"uint8array":for(ue=new Uint8Array(A),W=0;W<$.length;W++)ue.set($[W],q),q+=$[W].length;return ue;case"nodebuffer":return Buffer.concat($);default:throw new Error("concat : unsupported type '"+N+"'")}}(T,R),I);y(L)}catch(N){v(N)}R=[]}).resume()})}function f(b,w,y){var v=w;switch(w){case"blob":case"arraybuffer":v="uint8array";break;case"base64":v="string"}try{this._internalType=v,this._outputType=w,this._mimeType=y,o.checkSupport(v),this._worker=b.pipe(new s(v)),b.lock()}catch(R){this._worker=new a("error"),this._worker.error(R)}}f.prototype={accumulate:function(b){return g(this,b)},on:function(b,w){var y=this;return b==="data"?this._worker.on(b,function(v){w.call(y,v.data,v.meta)}):this._worker.on(b,function(){o.delay(w,arguments,y)}),this},resume:function(){return o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(b){if(o.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new d(this,{objectMode:this._outputType!=="nodebuffer"},b)}},r.exports=f},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,r,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var o=new ArrayBuffer(0);try{i.blob=new Blob([o],{type:"application/zip"}).size===0}catch{try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);s.append(o),i.blob=s.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!n("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(n,r,i){for(var o=n("./utils"),s=n("./support"),a=n("./nodejsUtils"),l=n("./stream/GenericWorker"),c=new Array(256),u=0;u<256;u++)c[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;c[254]=c[254]=1;function d(){l.call(this,"utf-8 decode"),this.leftOver=null}function g(){l.call(this,"utf-8 encode")}i.utf8encode=function(f){return s.nodebuffer?a.newBufferFrom(f,"utf-8"):function(b){var w,y,v,R,T,M=b.length,I=0;for(R=0;R<M;R++)(64512&(y=b.charCodeAt(R)))==55296&&R+1<M&&(64512&(v=b.charCodeAt(R+1)))==56320&&(y=65536+(y-55296<<10)+(v-56320),R++),I+=y<128?1:y<2048?2:y<65536?3:4;for(w=s.uint8array?new Uint8Array(I):new Array(I),R=T=0;T<I;R++)(64512&(y=b.charCodeAt(R)))==55296&&R+1<M&&(64512&(v=b.charCodeAt(R+1)))==56320&&(y=65536+(y-55296<<10)+(v-56320),R++),y<128?w[T++]=y:(y<2048?w[T++]=192|y>>>6:(y<65536?w[T++]=224|y>>>12:(w[T++]=240|y>>>18,w[T++]=128|y>>>12&63),w[T++]=128|y>>>6&63),w[T++]=128|63&y);return w}(f)},i.utf8decode=function(f){return s.nodebuffer?o.transformTo("nodebuffer",f).toString("utf-8"):function(b){var w,y,v,R,T=b.length,M=new Array(2*T);for(w=y=0;w<T;)if((v=b[w++])<128)M[y++]=v;else if(4<(R=c[v]))M[y++]=65533,w+=R-1;else{for(v&=R===2?31:R===3?15:7;1<R&&w<T;)v=v<<6|63&b[w++],R--;1<R?M[y++]=65533:v<65536?M[y++]=v:(v-=65536,M[y++]=55296|v>>10&1023,M[y++]=56320|1023&v)}return M.length!==y&&(M.subarray?M=M.subarray(0,y):M.length=y),o.applyFromCharCode(M)}(f=o.transformTo(s.uint8array?"uint8array":"array",f))},o.inherits(d,l),d.prototype.processChunk=function(f){var b=o.transformTo(s.uint8array?"uint8array":"array",f.data);if(this.leftOver&&this.leftOver.length){if(s.uint8array){var w=b;(b=new Uint8Array(w.length+this.leftOver.length)).set(this.leftOver,0),b.set(w,this.leftOver.length)}else b=this.leftOver.concat(b);this.leftOver=null}var y=function(R,T){var M;for((T=T||R.length)>R.length&&(T=R.length),M=T-1;0<=M&&(192&R[M])==128;)M--;return M<0||M===0?T:M+c[R[M]]>T?M:T}(b),v=b;y!==b.length&&(s.uint8array?(v=b.subarray(0,y),this.leftOver=b.subarray(y,b.length)):(v=b.slice(0,y),this.leftOver=b.slice(y,b.length))),this.push({data:i.utf8decode(v),meta:f.meta})},d.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=d,o.inherits(g,l),g.prototype.processChunk=function(f){this.push({data:i.utf8encode(f.data),meta:f.meta})},i.Utf8EncodeWorker=g},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,r,i){var o=n("./support"),s=n("./base64"),a=n("./nodejsUtils"),l=n("./external");function c(w){return w}function u(w,y){for(var v=0;v<w.length;++v)y[v]=255&w.charCodeAt(v);return y}n("setimmediate"),i.newBlob=function(w,y){i.checkSupport("blob");try{return new Blob([w],{type:y})}catch{try{var v=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return v.append(w),v.getBlob(y)}catch{throw new Error("Bug : can't construct the Blob.")}}};var d={stringifyByChunk:function(w,y,v){var R=[],T=0,M=w.length;if(M<=v)return String.fromCharCode.apply(null,w);for(;T<M;)y==="array"||y==="nodebuffer"?R.push(String.fromCharCode.apply(null,w.slice(T,Math.min(T+v,M)))):R.push(String.fromCharCode.apply(null,w.subarray(T,Math.min(T+v,M)))),T+=v;return R.join("")},stringifyByChar:function(w){for(var y="",v=0;v<w.length;v++)y+=String.fromCharCode(w[v]);return y},applyCanBeUsed:{uint8array:function(){try{return o.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return o.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}}()}};function g(w){var y=65536,v=i.getTypeOf(w),R=!0;if(v==="uint8array"?R=d.applyCanBeUsed.uint8array:v==="nodebuffer"&&(R=d.applyCanBeUsed.nodebuffer),R)for(;1<y;)try{return d.stringifyByChunk(w,v,y)}catch{y=Math.floor(y/2)}return d.stringifyByChar(w)}function f(w,y){for(var v=0;v<w.length;v++)y[v]=w[v];return y}i.applyFromCharCode=g;var b={};b.string={string:c,array:function(w){return u(w,new Array(w.length))},arraybuffer:function(w){return b.string.uint8array(w).buffer},uint8array:function(w){return u(w,new Uint8Array(w.length))},nodebuffer:function(w){return u(w,a.allocBuffer(w.length))}},b.array={string:g,array:c,arraybuffer:function(w){return new Uint8Array(w).buffer},uint8array:function(w){return new Uint8Array(w)},nodebuffer:function(w){return a.newBufferFrom(w)}},b.arraybuffer={string:function(w){return g(new Uint8Array(w))},array:function(w){return f(new Uint8Array(w),new Array(w.byteLength))},arraybuffer:c,uint8array:function(w){return new Uint8Array(w)},nodebuffer:function(w){return a.newBufferFrom(new Uint8Array(w))}},b.uint8array={string:g,array:function(w){return f(w,new Array(w.length))},arraybuffer:function(w){return w.buffer},uint8array:c,nodebuffer:function(w){return a.newBufferFrom(w)}},b.nodebuffer={string:g,array:function(w){return f(w,new Array(w.length))},arraybuffer:function(w){return b.nodebuffer.uint8array(w).buffer},uint8array:function(w){return f(w,new Uint8Array(w.length))},nodebuffer:c},i.transformTo=function(w,y){if(y=y||"",!w)return y;i.checkSupport(w);var v=i.getTypeOf(y);return b[v][w](y)},i.resolve=function(w){for(var y=w.split("/"),v=[],R=0;R<y.length;R++){var T=y[R];T==="."||T===""&&R!==0&&R!==y.length-1||(T===".."?v.pop():v.push(T))}return v.join("/")},i.getTypeOf=function(w){return typeof w=="string"?"string":Object.prototype.toString.call(w)==="[object Array]"?"array":o.nodebuffer&&a.isBuffer(w)?"nodebuffer":o.uint8array&&w instanceof Uint8Array?"uint8array":o.arraybuffer&&w instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(w){if(!o[w.toLowerCase()])throw new Error(w+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(w){var y,v,R="";for(v=0;v<(w||"").length;v++)R+="\\x"+((y=w.charCodeAt(v))<16?"0":"")+y.toString(16).toUpperCase();return R},i.delay=function(w,y,v){setImmediate(function(){w.apply(v||null,y||[])})},i.inherits=function(w,y){function v(){}v.prototype=y.prototype,w.prototype=new v},i.extend=function(){var w,y,v={};for(w=0;w<arguments.length;w++)for(y in arguments[w])Object.prototype.hasOwnProperty.call(arguments[w],y)&&v[y]===void 0&&(v[y]=arguments[w][y]);return v},i.prepareContent=function(w,y,v,R,T){return l.Promise.resolve(y).then(function(M){return o.blob&&(M instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(M))!==-1)&&typeof FileReader<"u"?new l.Promise(function(I,L){var N=new FileReader;N.onload=function($){I($.target.result)},N.onerror=function($){L($.target.error)},N.readAsArrayBuffer(M)}):M}).then(function(M){var I=i.getTypeOf(M);return I?(I==="arraybuffer"?M=i.transformTo("uint8array",M):I==="string"&&(T?M=s.decode(M):v&&R!==!0&&(M=function(L){return u(L,o.uint8array?new Uint8Array(L.length):new Array(L.length))}(M))),M):l.Promise.reject(new Error("Can't read the data of '"+w+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,r,i){var o=n("./reader/readerFor"),s=n("./utils"),a=n("./signature"),l=n("./zipEntry"),c=n("./support");function u(d){this.files=[],this.loadOptions=d}u.prototype={checkSignature:function(d){if(!this.reader.readAndCheckSignature(d)){this.reader.index-=4;var g=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(g)+", expected "+s.pretty(d)+")")}},isSignature:function(d,g){var f=this.reader.index;this.reader.setIndex(d);var b=this.reader.readString(4)===g;return this.reader.setIndex(f),b},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var d=this.reader.readData(this.zipCommentLength),g=c.uint8array?"uint8array":"array",f=s.transformTo(g,d);this.zipComment=this.loadOptions.decodeFileName(f)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var d,g,f,b=this.zip64EndOfCentralSize-44;0<b;)d=this.reader.readInt(2),g=this.reader.readInt(4),f=this.reader.readData(g),this.zip64ExtensibleData[d]={id:d,length:g,value:f}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var d,g;for(d=0;d<this.files.length;d++)g=this.files[d],this.reader.setIndex(g.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),g.readLocalPart(this.reader),g.handleUTF8(),g.processAttributes()},readCentralDir:function(){var d;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(d=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(d);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var d=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(d<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(d);var g=d;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,(d=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(d),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var f=this.centralDirOffset+this.centralDirSize;this.zip64&&(f+=20,f+=12+this.zip64EndOfCentralSize);var b=g-f;if(0<b)this.isSignature(g,a.CENTRAL_FILE_HEADER)||(this.reader.zero=b);else if(b<0)throw new Error("Corrupted zip: missing "+Math.abs(b)+" bytes.")},prepareReader:function(d){this.reader=o(d)},load:function(d){this.prepareReader(d),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,r,i){var o=n("./reader/readerFor"),s=n("./utils"),a=n("./compressedObject"),l=n("./crc32"),c=n("./utf8"),u=n("./compressions"),d=n("./support");function g(f,b){this.options=f,this.loadOptions=b}g.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(f){var b,w;if(f.skip(22),this.fileNameLength=f.readInt(2),w=f.readInt(2),this.fileName=f.readData(this.fileNameLength),f.skip(w),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((b=function(y){for(var v in u)if(Object.prototype.hasOwnProperty.call(u,v)&&u[v].magic===y)return u[v];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,b,f.readData(this.compressedSize))},readCentralPart:function(f){this.versionMadeBy=f.readInt(2),f.skip(2),this.bitFlag=f.readInt(2),this.compressionMethod=f.readString(2),this.date=f.readDate(),this.crc32=f.readInt(4),this.compressedSize=f.readInt(4),this.uncompressedSize=f.readInt(4);var b=f.readInt(2);if(this.extraFieldsLength=f.readInt(2),this.fileCommentLength=f.readInt(2),this.diskNumberStart=f.readInt(2),this.internalFileAttributes=f.readInt(2),this.externalFileAttributes=f.readInt(4),this.localHeaderOffset=f.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");f.skip(b),this.readExtraFields(f),this.parseZIP64ExtraField(f),this.fileComment=f.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var f=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),f==0&&(this.dosPermissions=63&this.externalFileAttributes),f==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var f=o(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=f.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=f.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=f.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=f.readInt(4))}},readExtraFields:function(f){var b,w,y,v=f.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});f.index+4<v;)b=f.readInt(2),w=f.readInt(2),y=f.readData(w),this.extraFields[b]={id:b,length:w,value:y};f.setIndex(v)},handleUTF8:function(){var f=d.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var b=this.findExtraFieldUnicodePath();if(b!==null)this.fileNameStr=b;else{var w=s.transformTo(f,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(w)}var y=this.findExtraFieldUnicodeComment();if(y!==null)this.fileCommentStr=y;else{var v=s.transformTo(f,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(v)}}},findExtraFieldUnicodePath:function(){var f=this.extraFields[28789];if(f){var b=o(f.value);return b.readInt(1)!==1||l(this.fileName)!==b.readInt(4)?null:c.utf8decode(b.readData(f.length-5))}return null},findExtraFieldUnicodeComment:function(){var f=this.extraFields[25461];if(f){var b=o(f.value);return b.readInt(1)!==1||l(this.fileComment)!==b.readInt(4)?null:c.utf8decode(b.readData(f.length-5))}return null}},r.exports=g},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,r,i){function o(b,w,y){this.name=b,this.dir=y.dir,this.date=y.date,this.comment=y.comment,this.unixPermissions=y.unixPermissions,this.dosPermissions=y.dosPermissions,this._data=w,this._dataBinary=y.binary,this.options={compression:y.compression,compressionOptions:y.compressionOptions}}var s=n("./stream/StreamHelper"),a=n("./stream/DataWorker"),l=n("./utf8"),c=n("./compressedObject"),u=n("./stream/GenericWorker");o.prototype={internalStream:function(b){var w=null,y="string";try{if(!b)throw new Error("No output type specified.");var v=(y=b.toLowerCase())==="string"||y==="text";y!=="binarystring"&&y!=="text"||(y="string"),w=this._decompressWorker();var R=!this._dataBinary;R&&!v&&(w=w.pipe(new l.Utf8EncodeWorker)),!R&&v&&(w=w.pipe(new l.Utf8DecodeWorker))}catch(T){(w=new u("error")).error(T)}return new s(w,y,"")},async:function(b,w){return this.internalStream(b).accumulate(w)},nodeStream:function(b,w){return this.internalStream(b||"nodebuffer").toNodejsStream(w)},_compressWorker:function(b,w){if(this._data instanceof c&&this._data.compression.magic===b.magic)return this._data.getCompressedWorker();var y=this._decompressWorker();return this._dataBinary||(y=y.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(y,b,w)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof u?this._data:new a(this._data)}};for(var d=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],g=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},f=0;f<d.length;f++)o.prototype[d[f]]=g;r.exports=o},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,r,i){(function(o){var s,a,l=o.MutationObserver||o.WebKitMutationObserver;if(l){var c=0,u=new l(b),d=o.document.createTextNode("");u.observe(d,{characterData:!0}),s=function(){d.data=c=++c%2}}else if(o.setImmediate||o.MessageChannel===void 0)s="document"in o&&"onreadystatechange"in o.document.createElement("script")?function(){var w=o.document.createElement("script");w.onreadystatechange=function(){b(),w.onreadystatechange=null,w.parentNode.removeChild(w),w=null},o.document.documentElement.appendChild(w)}:function(){setTimeout(b,0)};else{var g=new o.MessageChannel;g.port1.onmessage=b,s=function(){g.port2.postMessage(0)}}var f=[];function b(){var w,y;a=!0;for(var v=f.length;v;){for(y=f,f=[],w=-1;++w<v;)y[w]();v=f.length}a=!1}r.exports=function(w){f.push(w)!==1||a||s()}}).call(this,typeof Mr<"u"?Mr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,r,i){var o=n("immediate");function s(){}var a={},l=["REJECTED"],c=["FULFILLED"],u=["PENDING"];function d(v){if(typeof v!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,v!==s&&w(this,v)}function g(v,R,T){this.promise=v,typeof R=="function"&&(this.onFulfilled=R,this.callFulfilled=this.otherCallFulfilled),typeof T=="function"&&(this.onRejected=T,this.callRejected=this.otherCallRejected)}function f(v,R,T){o(function(){var M;try{M=R(T)}catch(I){return a.reject(v,I)}M===v?a.reject(v,new TypeError("Cannot resolve promise with itself")):a.resolve(v,M)})}function b(v){var R=v&&v.then;if(v&&(typeof v=="object"||typeof v=="function")&&typeof R=="function")return function(){R.apply(v,arguments)}}function w(v,R){var T=!1;function M(N){T||(T=!0,a.reject(v,N))}function I(N){T||(T=!0,a.resolve(v,N))}var L=y(function(){R(I,M)});L.status==="error"&&M(L.value)}function y(v,R){var T={};try{T.value=v(R),T.status="success"}catch(M){T.status="error",T.value=M}return T}(r.exports=d).prototype.finally=function(v){if(typeof v!="function")return this;var R=this.constructor;return this.then(function(T){return R.resolve(v()).then(function(){return T})},function(T){return R.resolve(v()).then(function(){throw T})})},d.prototype.catch=function(v){return this.then(null,v)},d.prototype.then=function(v,R){if(typeof v!="function"&&this.state===c||typeof R!="function"&&this.state===l)return this;var T=new this.constructor(s);return this.state!==u?f(T,this.state===c?v:R,this.outcome):this.queue.push(new g(T,v,R)),T},g.prototype.callFulfilled=function(v){a.resolve(this.promise,v)},g.prototype.otherCallFulfilled=function(v){f(this.promise,this.onFulfilled,v)},g.prototype.callRejected=function(v){a.reject(this.promise,v)},g.prototype.otherCallRejected=function(v){f(this.promise,this.onRejected,v)},a.resolve=function(v,R){var T=y(b,R);if(T.status==="error")return a.reject(v,T.value);var M=T.value;if(M)w(v,M);else{v.state=c,v.outcome=R;for(var I=-1,L=v.queue.length;++I<L;)v.queue[I].callFulfilled(R)}return v},a.reject=function(v,R){v.state=l,v.outcome=R;for(var T=-1,M=v.queue.length;++T<M;)v.queue[T].callRejected(R);return v},d.resolve=function(v){return v instanceof this?v:a.resolve(new this(s),v)},d.reject=function(v){var R=new this(s);return a.reject(R,v)},d.all=function(v){var R=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var T=v.length,M=!1;if(!T)return this.resolve([]);for(var I=new Array(T),L=0,N=-1,$=new this(s);++N<T;)W(v[N],N);return $;function W(q,ue){R.resolve(q).then(function(A){I[ue]=A,++L!==T||M||(M=!0,a.resolve($,I))},function(A){M||(M=!0,a.reject($,A))})}},d.race=function(v){var R=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var T=v.length,M=!1;if(!T)return this.resolve([]);for(var I=-1,L=new this(s);++I<T;)N=v[I],R.resolve(N).then(function($){M||(M=!0,a.resolve(L,$))},function($){M||(M=!0,a.reject(L,$))});var N;return L}},{immediate:36}],38:[function(n,r,i){var o={};(0,n("./lib/utils/common").assign)(o,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),r.exports=o},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,r,i){var o=n("./zlib/deflate"),s=n("./utils/common"),a=n("./utils/strings"),l=n("./zlib/messages"),c=n("./zlib/zstream"),u=Object.prototype.toString,d=0,g=-1,f=0,b=8;function w(v){if(!(this instanceof w))return new w(v);this.options=s.assign({level:g,method:b,chunkSize:16384,windowBits:15,memLevel:8,strategy:f,to:""},v||{});var R=this.options;R.raw&&0<R.windowBits?R.windowBits=-R.windowBits:R.gzip&&0<R.windowBits&&R.windowBits<16&&(R.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var T=o.deflateInit2(this.strm,R.level,R.method,R.windowBits,R.memLevel,R.strategy);if(T!==d)throw new Error(l[T]);if(R.header&&o.deflateSetHeader(this.strm,R.header),R.dictionary){var M;if(M=typeof R.dictionary=="string"?a.string2buf(R.dictionary):u.call(R.dictionary)==="[object ArrayBuffer]"?new Uint8Array(R.dictionary):R.dictionary,(T=o.deflateSetDictionary(this.strm,M))!==d)throw new Error(l[T]);this._dict_set=!0}}function y(v,R){var T=new w(R);if(T.push(v,!0),T.err)throw T.msg||l[T.err];return T.result}w.prototype.push=function(v,R){var T,M,I=this.strm,L=this.options.chunkSize;if(this.ended)return!1;M=R===~~R?R:R===!0?4:0,typeof v=="string"?I.input=a.string2buf(v):u.call(v)==="[object ArrayBuffer]"?I.input=new Uint8Array(v):I.input=v,I.next_in=0,I.avail_in=I.input.length;do{if(I.avail_out===0&&(I.output=new s.Buf8(L),I.next_out=0,I.avail_out=L),(T=o.deflate(I,M))!==1&&T!==d)return this.onEnd(T),!(this.ended=!0);I.avail_out!==0&&(I.avail_in!==0||M!==4&&M!==2)||(this.options.to==="string"?this.onData(a.buf2binstring(s.shrinkBuf(I.output,I.next_out))):this.onData(s.shrinkBuf(I.output,I.next_out)))}while((0<I.avail_in||I.avail_out===0)&&T!==1);return M===4?(T=o.deflateEnd(this.strm),this.onEnd(T),this.ended=!0,T===d):M!==2||(this.onEnd(d),!(I.avail_out=0))},w.prototype.onData=function(v){this.chunks.push(v)},w.prototype.onEnd=function(v){v===d&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},i.Deflate=w,i.deflate=y,i.deflateRaw=function(v,R){return(R=R||{}).raw=!0,y(v,R)},i.gzip=function(v,R){return(R=R||{}).gzip=!0,y(v,R)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,r,i){var o=n("./zlib/inflate"),s=n("./utils/common"),a=n("./utils/strings"),l=n("./zlib/constants"),c=n("./zlib/messages"),u=n("./zlib/zstream"),d=n("./zlib/gzheader"),g=Object.prototype.toString;function f(w){if(!(this instanceof f))return new f(w);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},w||{});var y=this.options;y.raw&&0<=y.windowBits&&y.windowBits<16&&(y.windowBits=-y.windowBits,y.windowBits===0&&(y.windowBits=-15)),!(0<=y.windowBits&&y.windowBits<16)||w&&w.windowBits||(y.windowBits+=32),15<y.windowBits&&y.windowBits<48&&!(15&y.windowBits)&&(y.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var v=o.inflateInit2(this.strm,y.windowBits);if(v!==l.Z_OK)throw new Error(c[v]);this.header=new d,o.inflateGetHeader(this.strm,this.header)}function b(w,y){var v=new f(y);if(v.push(w,!0),v.err)throw v.msg||c[v.err];return v.result}f.prototype.push=function(w,y){var v,R,T,M,I,L,N=this.strm,$=this.options.chunkSize,W=this.options.dictionary,q=!1;if(this.ended)return!1;R=y===~~y?y:y===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof w=="string"?N.input=a.binstring2buf(w):g.call(w)==="[object ArrayBuffer]"?N.input=new Uint8Array(w):N.input=w,N.next_in=0,N.avail_in=N.input.length;do{if(N.avail_out===0&&(N.output=new s.Buf8($),N.next_out=0,N.avail_out=$),(v=o.inflate(N,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&W&&(L=typeof W=="string"?a.string2buf(W):g.call(W)==="[object ArrayBuffer]"?new Uint8Array(W):W,v=o.inflateSetDictionary(this.strm,L)),v===l.Z_BUF_ERROR&&q===!0&&(v=l.Z_OK,q=!1),v!==l.Z_STREAM_END&&v!==l.Z_OK)return this.onEnd(v),!(this.ended=!0);N.next_out&&(N.avail_out!==0&&v!==l.Z_STREAM_END&&(N.avail_in!==0||R!==l.Z_FINISH&&R!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(T=a.utf8border(N.output,N.next_out),M=N.next_out-T,I=a.buf2string(N.output,T),N.next_out=M,N.avail_out=$-M,M&&s.arraySet(N.output,N.output,T,M,0),this.onData(I)):this.onData(s.shrinkBuf(N.output,N.next_out)))),N.avail_in===0&&N.avail_out===0&&(q=!0)}while((0<N.avail_in||N.avail_out===0)&&v!==l.Z_STREAM_END);return v===l.Z_STREAM_END&&(R=l.Z_FINISH),R===l.Z_FINISH?(v=o.inflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===l.Z_OK):R!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(N.avail_out=0))},f.prototype.onData=function(w){this.chunks.push(w)},f.prototype.onEnd=function(w){w===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=w,this.msg=this.strm.msg},i.Inflate=f,i.inflate=b,i.inflateRaw=function(w,y){return(y=y||{}).raw=!0,b(w,y)},i.ungzip=b},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,r,i){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(l){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var u=c.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var d in u)u.hasOwnProperty(d)&&(l[d]=u[d])}}return l},i.shrinkBuf=function(l,c){return l.length===c?l:l.subarray?l.subarray(0,c):(l.length=c,l)};var s={arraySet:function(l,c,u,d,g){if(c.subarray&&l.subarray)l.set(c.subarray(u,u+d),g);else for(var f=0;f<d;f++)l[g+f]=c[u+f]},flattenChunks:function(l){var c,u,d,g,f,b;for(c=d=0,u=l.length;c<u;c++)d+=l[c].length;for(b=new Uint8Array(d),c=g=0,u=l.length;c<u;c++)f=l[c],b.set(f,g),g+=f.length;return b}},a={arraySet:function(l,c,u,d,g){for(var f=0;f<d;f++)l[g+f]=c[u+f]},flattenChunks:function(l){return[].concat.apply([],l)}};i.setTyped=function(l){l?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,s)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,a))},i.setTyped(o)},{}],42:[function(n,r,i){var o=n("./common"),s=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var l=new o.Buf8(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function u(d,g){if(g<65537&&(d.subarray&&a||!d.subarray&&s))return String.fromCharCode.apply(null,o.shrinkBuf(d,g));for(var f="",b=0;b<g;b++)f+=String.fromCharCode(d[b]);return f}l[254]=l[254]=1,i.string2buf=function(d){var g,f,b,w,y,v=d.length,R=0;for(w=0;w<v;w++)(64512&(f=d.charCodeAt(w)))==55296&&w+1<v&&(64512&(b=d.charCodeAt(w+1)))==56320&&(f=65536+(f-55296<<10)+(b-56320),w++),R+=f<128?1:f<2048?2:f<65536?3:4;for(g=new o.Buf8(R),w=y=0;y<R;w++)(64512&(f=d.charCodeAt(w)))==55296&&w+1<v&&(64512&(b=d.charCodeAt(w+1)))==56320&&(f=65536+(f-55296<<10)+(b-56320),w++),f<128?g[y++]=f:(f<2048?g[y++]=192|f>>>6:(f<65536?g[y++]=224|f>>>12:(g[y++]=240|f>>>18,g[y++]=128|f>>>12&63),g[y++]=128|f>>>6&63),g[y++]=128|63&f);return g},i.buf2binstring=function(d){return u(d,d.length)},i.binstring2buf=function(d){for(var g=new o.Buf8(d.length),f=0,b=g.length;f<b;f++)g[f]=d.charCodeAt(f);return g},i.buf2string=function(d,g){var f,b,w,y,v=g||d.length,R=new Array(2*v);for(f=b=0;f<v;)if((w=d[f++])<128)R[b++]=w;else if(4<(y=l[w]))R[b++]=65533,f+=y-1;else{for(w&=y===2?31:y===3?15:7;1<y&&f<v;)w=w<<6|63&d[f++],y--;1<y?R[b++]=65533:w<65536?R[b++]=w:(w-=65536,R[b++]=55296|w>>10&1023,R[b++]=56320|1023&w)}return u(R,b)},i.utf8border=function(d,g){var f;for((g=g||d.length)>d.length&&(g=d.length),f=g-1;0<=f&&(192&d[f])==128;)f--;return f<0||f===0?g:f+l[d[f]]>g?f:g}},{"./common":41}],43:[function(n,r,i){r.exports=function(o,s,a,l){for(var c=65535&o|0,u=o>>>16&65535|0,d=0;a!==0;){for(a-=d=2e3<a?2e3:a;u=u+(c=c+s[l++]|0)|0,--d;);c%=65521,u%=65521}return c|u<<16|0}},{}],44:[function(n,r,i){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,r,i){var o=function(){for(var s,a=[],l=0;l<256;l++){s=l;for(var c=0;c<8;c++)s=1&s?3988292384^s>>>1:s>>>1;a[l]=s}return a}();r.exports=function(s,a,l,c){var u=o,d=c+l;s^=-1;for(var g=c;g<d;g++)s=s>>>8^u[255&(s^a[g])];return-1^s}},{}],46:[function(n,r,i){var o,s=n("../utils/common"),a=n("./trees"),l=n("./adler32"),c=n("./crc32"),u=n("./messages"),d=0,g=4,f=0,b=-2,w=-1,y=4,v=2,R=8,T=9,M=286,I=30,L=19,N=2*M+1,$=15,W=3,q=258,ue=q+W+1,A=42,B=113,C=1,z=2,fe=3,K=4;function ie(p,V){return p.msg=u[V],V}function U(p){return(p<<1)-(4<p?9:0)}function me(p){for(var V=p.length;0<=--V;)p[V]=0}function h(p){var V=p.state,F=V.pending;F>p.avail_out&&(F=p.avail_out),F!==0&&(s.arraySet(p.output,V.pending_buf,V.pending_out,F,p.next_out),p.next_out+=F,V.pending_out+=F,p.total_out+=F,p.avail_out-=F,V.pending-=F,V.pending===0&&(V.pending_out=0))}function m(p,V){a._tr_flush_block(p,0<=p.block_start?p.block_start:-1,p.strstart-p.block_start,V),p.block_start=p.strstart,h(p.strm)}function S(p,V){p.pending_buf[p.pending++]=V}function E(p,V){p.pending_buf[p.pending++]=V>>>8&255,p.pending_buf[p.pending++]=255&V}function O(p,V){var F,x,_=p.max_chain_length,H=p.strstart,G=p.prev_length,j=p.nice_match,D=p.strstart>p.w_size-ue?p.strstart-(p.w_size-ue):0,Q=p.window,re=p.w_mask,J=p.prev,ce=p.strstart+q,Re=Q[H+G-1],ve=Q[H+G];p.prev_length>=p.good_match&&(_>>=2),j>p.lookahead&&(j=p.lookahead);do if(Q[(F=V)+G]===ve&&Q[F+G-1]===Re&&Q[F]===Q[H]&&Q[++F]===Q[H+1]){H+=2,F++;do;while(Q[++H]===Q[++F]&&Q[++H]===Q[++F]&&Q[++H]===Q[++F]&&Q[++H]===Q[++F]&&Q[++H]===Q[++F]&&Q[++H]===Q[++F]&&Q[++H]===Q[++F]&&Q[++H]===Q[++F]&&H<ce);if(x=q-(ce-H),H=ce-q,G<x){if(p.match_start=V,j<=(G=x))break;Re=Q[H+G-1],ve=Q[H+G]}}while((V=J[V&re])>D&&--_!=0);return G<=p.lookahead?G:p.lookahead}function k(p){var V,F,x,_,H,G,j,D,Q,re,J=p.w_size;do{if(_=p.window_size-p.lookahead-p.strstart,p.strstart>=J+(J-ue)){for(s.arraySet(p.window,p.window,J,J,0),p.match_start-=J,p.strstart-=J,p.block_start-=J,V=F=p.hash_size;x=p.head[--V],p.head[V]=J<=x?x-J:0,--F;);for(V=F=J;x=p.prev[--V],p.prev[V]=J<=x?x-J:0,--F;);_+=J}if(p.strm.avail_in===0)break;if(G=p.strm,j=p.window,D=p.strstart+p.lookahead,Q=_,re=void 0,re=G.avail_in,Q<re&&(re=Q),F=re===0?0:(G.avail_in-=re,s.arraySet(j,G.input,G.next_in,re,D),G.state.wrap===1?G.adler=l(G.adler,j,re,D):G.state.wrap===2&&(G.adler=c(G.adler,j,re,D)),G.next_in+=re,G.total_in+=re,re),p.lookahead+=F,p.lookahead+p.insert>=W)for(H=p.strstart-p.insert,p.ins_h=p.window[H],p.ins_h=(p.ins_h<<p.hash_shift^p.window[H+1])&p.hash_mask;p.insert&&(p.ins_h=(p.ins_h<<p.hash_shift^p.window[H+W-1])&p.hash_mask,p.prev[H&p.w_mask]=p.head[p.ins_h],p.head[p.ins_h]=H,H++,p.insert--,!(p.lookahead+p.insert<W)););}while(p.lookahead<ue&&p.strm.avail_in!==0)}function Z(p,V){for(var F,x;;){if(p.lookahead<ue){if(k(p),p.lookahead<ue&&V===d)return C;if(p.lookahead===0)break}if(F=0,p.lookahead>=W&&(p.ins_h=(p.ins_h<<p.hash_shift^p.window[p.strstart+W-1])&p.hash_mask,F=p.prev[p.strstart&p.w_mask]=p.head[p.ins_h],p.head[p.ins_h]=p.strstart),F!==0&&p.strstart-F<=p.w_size-ue&&(p.match_length=O(p,F)),p.match_length>=W)if(x=a._tr_tally(p,p.strstart-p.match_start,p.match_length-W),p.lookahead-=p.match_length,p.match_length<=p.max_lazy_match&&p.lookahead>=W){for(p.match_length--;p.strstart++,p.ins_h=(p.ins_h<<p.hash_shift^p.window[p.strstart+W-1])&p.hash_mask,F=p.prev[p.strstart&p.w_mask]=p.head[p.ins_h],p.head[p.ins_h]=p.strstart,--p.match_length!=0;);p.strstart++}else p.strstart+=p.match_length,p.match_length=0,p.ins_h=p.window[p.strstart],p.ins_h=(p.ins_h<<p.hash_shift^p.window[p.strstart+1])&p.hash_mask;else x=a._tr_tally(p,0,p.window[p.strstart]),p.lookahead--,p.strstart++;if(x&&(m(p,!1),p.strm.avail_out===0))return C}return p.insert=p.strstart<W-1?p.strstart:W-1,V===g?(m(p,!0),p.strm.avail_out===0?fe:K):p.last_lit&&(m(p,!1),p.strm.avail_out===0)?C:z}function Y(p,V){for(var F,x,_;;){if(p.lookahead<ue){if(k(p),p.lookahead<ue&&V===d)return C;if(p.lookahead===0)break}if(F=0,p.lookahead>=W&&(p.ins_h=(p.ins_h<<p.hash_shift^p.window[p.strstart+W-1])&p.hash_mask,F=p.prev[p.strstart&p.w_mask]=p.head[p.ins_h],p.head[p.ins_h]=p.strstart),p.prev_length=p.match_length,p.prev_match=p.match_start,p.match_length=W-1,F!==0&&p.prev_length<p.max_lazy_match&&p.strstart-F<=p.w_size-ue&&(p.match_length=O(p,F),p.match_length<=5&&(p.strategy===1||p.match_length===W&&4096<p.strstart-p.match_start)&&(p.match_length=W-1)),p.prev_length>=W&&p.match_length<=p.prev_length){for(_=p.strstart+p.lookahead-W,x=a._tr_tally(p,p.strstart-1-p.prev_match,p.prev_length-W),p.lookahead-=p.prev_length-1,p.prev_length-=2;++p.strstart<=_&&(p.ins_h=(p.ins_h<<p.hash_shift^p.window[p.strstart+W-1])&p.hash_mask,F=p.prev[p.strstart&p.w_mask]=p.head[p.ins_h],p.head[p.ins_h]=p.strstart),--p.prev_length!=0;);if(p.match_available=0,p.match_length=W-1,p.strstart++,x&&(m(p,!1),p.strm.avail_out===0))return C}else if(p.match_available){if((x=a._tr_tally(p,0,p.window[p.strstart-1]))&&m(p,!1),p.strstart++,p.lookahead--,p.strm.avail_out===0)return C}else p.match_available=1,p.strstart++,p.lookahead--}return p.match_available&&(x=a._tr_tally(p,0,p.window[p.strstart-1]),p.match_available=0),p.insert=p.strstart<W-1?p.strstart:W-1,V===g?(m(p,!0),p.strm.avail_out===0?fe:K):p.last_lit&&(m(p,!1),p.strm.avail_out===0)?C:z}function ne(p,V,F,x,_){this.good_length=p,this.max_lazy=V,this.nice_length=F,this.max_chain=x,this.func=_}function oe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=R,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(2*N),this.dyn_dtree=new s.Buf16(2*(2*I+1)),this.bl_tree=new s.Buf16(2*(2*L+1)),me(this.dyn_ltree),me(this.dyn_dtree),me(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16($+1),this.heap=new s.Buf16(2*M+1),me(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(2*M+1),me(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function X(p){var V;return p&&p.state?(p.total_in=p.total_out=0,p.data_type=v,(V=p.state).pending=0,V.pending_out=0,V.wrap<0&&(V.wrap=-V.wrap),V.status=V.wrap?A:B,p.adler=V.wrap===2?0:1,V.last_flush=d,a._tr_init(V),f):ie(p,b)}function ye(p){var V=X(p);return V===f&&function(F){F.window_size=2*F.w_size,me(F.head),F.max_lazy_match=o[F.level].max_lazy,F.good_match=o[F.level].good_length,F.nice_match=o[F.level].nice_length,F.max_chain_length=o[F.level].max_chain,F.strstart=0,F.block_start=0,F.lookahead=0,F.insert=0,F.match_length=F.prev_length=W-1,F.match_available=0,F.ins_h=0}(p.state),V}function Ce(p,V,F,x,_,H){if(!p)return b;var G=1;if(V===w&&(V=6),x<0?(G=0,x=-x):15<x&&(G=2,x-=16),_<1||T<_||F!==R||x<8||15<x||V<0||9<V||H<0||y<H)return ie(p,b);x===8&&(x=9);var j=new oe;return(p.state=j).strm=p,j.wrap=G,j.gzhead=null,j.w_bits=x,j.w_size=1<<j.w_bits,j.w_mask=j.w_size-1,j.hash_bits=_+7,j.hash_size=1<<j.hash_bits,j.hash_mask=j.hash_size-1,j.hash_shift=~~((j.hash_bits+W-1)/W),j.window=new s.Buf8(2*j.w_size),j.head=new s.Buf16(j.hash_size),j.prev=new s.Buf16(j.w_size),j.lit_bufsize=1<<_+6,j.pending_buf_size=4*j.lit_bufsize,j.pending_buf=new s.Buf8(j.pending_buf_size),j.d_buf=1*j.lit_bufsize,j.l_buf=3*j.lit_bufsize,j.level=V,j.strategy=H,j.method=F,ye(p)}o=[new ne(0,0,0,0,function(p,V){var F=65535;for(F>p.pending_buf_size-5&&(F=p.pending_buf_size-5);;){if(p.lookahead<=1){if(k(p),p.lookahead===0&&V===d)return C;if(p.lookahead===0)break}p.strstart+=p.lookahead,p.lookahead=0;var x=p.block_start+F;if((p.strstart===0||p.strstart>=x)&&(p.lookahead=p.strstart-x,p.strstart=x,m(p,!1),p.strm.avail_out===0)||p.strstart-p.block_start>=p.w_size-ue&&(m(p,!1),p.strm.avail_out===0))return C}return p.insert=0,V===g?(m(p,!0),p.strm.avail_out===0?fe:K):(p.strstart>p.block_start&&(m(p,!1),p.strm.avail_out),C)}),new ne(4,4,8,4,Z),new ne(4,5,16,8,Z),new ne(4,6,32,32,Z),new ne(4,4,16,16,Y),new ne(8,16,32,32,Y),new ne(8,16,128,128,Y),new ne(8,32,128,256,Y),new ne(32,128,258,1024,Y),new ne(32,258,258,4096,Y)],i.deflateInit=function(p,V){return Ce(p,V,R,15,8,0)},i.deflateInit2=Ce,i.deflateReset=ye,i.deflateResetKeep=X,i.deflateSetHeader=function(p,V){return p&&p.state?p.state.wrap!==2?b:(p.state.gzhead=V,f):b},i.deflate=function(p,V){var F,x,_,H;if(!p||!p.state||5<V||V<0)return p?ie(p,b):b;if(x=p.state,!p.output||!p.input&&p.avail_in!==0||x.status===666&&V!==g)return ie(p,p.avail_out===0?-5:b);if(x.strm=p,F=x.last_flush,x.last_flush=V,x.status===A)if(x.wrap===2)p.adler=0,S(x,31),S(x,139),S(x,8),x.gzhead?(S(x,(x.gzhead.text?1:0)+(x.gzhead.hcrc?2:0)+(x.gzhead.extra?4:0)+(x.gzhead.name?8:0)+(x.gzhead.comment?16:0)),S(x,255&x.gzhead.time),S(x,x.gzhead.time>>8&255),S(x,x.gzhead.time>>16&255),S(x,x.gzhead.time>>24&255),S(x,x.level===9?2:2<=x.strategy||x.level<2?4:0),S(x,255&x.gzhead.os),x.gzhead.extra&&x.gzhead.extra.length&&(S(x,255&x.gzhead.extra.length),S(x,x.gzhead.extra.length>>8&255)),x.gzhead.hcrc&&(p.adler=c(p.adler,x.pending_buf,x.pending,0)),x.gzindex=0,x.status=69):(S(x,0),S(x,0),S(x,0),S(x,0),S(x,0),S(x,x.level===9?2:2<=x.strategy||x.level<2?4:0),S(x,3),x.status=B);else{var G=R+(x.w_bits-8<<4)<<8;G|=(2<=x.strategy||x.level<2?0:x.level<6?1:x.level===6?2:3)<<6,x.strstart!==0&&(G|=32),G+=31-G%31,x.status=B,E(x,G),x.strstart!==0&&(E(x,p.adler>>>16),E(x,65535&p.adler)),p.adler=1}if(x.status===69)if(x.gzhead.extra){for(_=x.pending;x.gzindex<(65535&x.gzhead.extra.length)&&(x.pending!==x.pending_buf_size||(x.gzhead.hcrc&&x.pending>_&&(p.adler=c(p.adler,x.pending_buf,x.pending-_,_)),h(p),_=x.pending,x.pending!==x.pending_buf_size));)S(x,255&x.gzhead.extra[x.gzindex]),x.gzindex++;x.gzhead.hcrc&&x.pending>_&&(p.adler=c(p.adler,x.pending_buf,x.pending-_,_)),x.gzindex===x.gzhead.extra.length&&(x.gzindex=0,x.status=73)}else x.status=73;if(x.status===73)if(x.gzhead.name){_=x.pending;do{if(x.pending===x.pending_buf_size&&(x.gzhead.hcrc&&x.pending>_&&(p.adler=c(p.adler,x.pending_buf,x.pending-_,_)),h(p),_=x.pending,x.pending===x.pending_buf_size)){H=1;break}H=x.gzindex<x.gzhead.name.length?255&x.gzhead.name.charCodeAt(x.gzindex++):0,S(x,H)}while(H!==0);x.gzhead.hcrc&&x.pending>_&&(p.adler=c(p.adler,x.pending_buf,x.pending-_,_)),H===0&&(x.gzindex=0,x.status=91)}else x.status=91;if(x.status===91)if(x.gzhead.comment){_=x.pending;do{if(x.pending===x.pending_buf_size&&(x.gzhead.hcrc&&x.pending>_&&(p.adler=c(p.adler,x.pending_buf,x.pending-_,_)),h(p),_=x.pending,x.pending===x.pending_buf_size)){H=1;break}H=x.gzindex<x.gzhead.comment.length?255&x.gzhead.comment.charCodeAt(x.gzindex++):0,S(x,H)}while(H!==0);x.gzhead.hcrc&&x.pending>_&&(p.adler=c(p.adler,x.pending_buf,x.pending-_,_)),H===0&&(x.status=103)}else x.status=103;if(x.status===103&&(x.gzhead.hcrc?(x.pending+2>x.pending_buf_size&&h(p),x.pending+2<=x.pending_buf_size&&(S(x,255&p.adler),S(x,p.adler>>8&255),p.adler=0,x.status=B)):x.status=B),x.pending!==0){if(h(p),p.avail_out===0)return x.last_flush=-1,f}else if(p.avail_in===0&&U(V)<=U(F)&&V!==g)return ie(p,-5);if(x.status===666&&p.avail_in!==0)return ie(p,-5);if(p.avail_in!==0||x.lookahead!==0||V!==d&&x.status!==666){var j=x.strategy===2?function(D,Q){for(var re;;){if(D.lookahead===0&&(k(D),D.lookahead===0)){if(Q===d)return C;break}if(D.match_length=0,re=a._tr_tally(D,0,D.window[D.strstart]),D.lookahead--,D.strstart++,re&&(m(D,!1),D.strm.avail_out===0))return C}return D.insert=0,Q===g?(m(D,!0),D.strm.avail_out===0?fe:K):D.last_lit&&(m(D,!1),D.strm.avail_out===0)?C:z}(x,V):x.strategy===3?function(D,Q){for(var re,J,ce,Re,ve=D.window;;){if(D.lookahead<=q){if(k(D),D.lookahead<=q&&Q===d)return C;if(D.lookahead===0)break}if(D.match_length=0,D.lookahead>=W&&0<D.strstart&&(J=ve[ce=D.strstart-1])===ve[++ce]&&J===ve[++ce]&&J===ve[++ce]){Re=D.strstart+q;do;while(J===ve[++ce]&&J===ve[++ce]&&J===ve[++ce]&&J===ve[++ce]&&J===ve[++ce]&&J===ve[++ce]&&J===ve[++ce]&&J===ve[++ce]&&ce<Re);D.match_length=q-(Re-ce),D.match_length>D.lookahead&&(D.match_length=D.lookahead)}if(D.match_length>=W?(re=a._tr_tally(D,1,D.match_length-W),D.lookahead-=D.match_length,D.strstart+=D.match_length,D.match_length=0):(re=a._tr_tally(D,0,D.window[D.strstart]),D.lookahead--,D.strstart++),re&&(m(D,!1),D.strm.avail_out===0))return C}return D.insert=0,Q===g?(m(D,!0),D.strm.avail_out===0?fe:K):D.last_lit&&(m(D,!1),D.strm.avail_out===0)?C:z}(x,V):o[x.level].func(x,V);if(j!==fe&&j!==K||(x.status=666),j===C||j===fe)return p.avail_out===0&&(x.last_flush=-1),f;if(j===z&&(V===1?a._tr_align(x):V!==5&&(a._tr_stored_block(x,0,0,!1),V===3&&(me(x.head),x.lookahead===0&&(x.strstart=0,x.block_start=0,x.insert=0))),h(p),p.avail_out===0))return x.last_flush=-1,f}return V!==g?f:x.wrap<=0?1:(x.wrap===2?(S(x,255&p.adler),S(x,p.adler>>8&255),S(x,p.adler>>16&255),S(x,p.adler>>24&255),S(x,255&p.total_in),S(x,p.total_in>>8&255),S(x,p.total_in>>16&255),S(x,p.total_in>>24&255)):(E(x,p.adler>>>16),E(x,65535&p.adler)),h(p),0<x.wrap&&(x.wrap=-x.wrap),x.pending!==0?f:1)},i.deflateEnd=function(p){var V;return p&&p.state?(V=p.state.status)!==A&&V!==69&&V!==73&&V!==91&&V!==103&&V!==B&&V!==666?ie(p,b):(p.state=null,V===B?ie(p,-3):f):b},i.deflateSetDictionary=function(p,V){var F,x,_,H,G,j,D,Q,re=V.length;if(!p||!p.state||(H=(F=p.state).wrap)===2||H===1&&F.status!==A||F.lookahead)return b;for(H===1&&(p.adler=l(p.adler,V,re,0)),F.wrap=0,re>=F.w_size&&(H===0&&(me(F.head),F.strstart=0,F.block_start=0,F.insert=0),Q=new s.Buf8(F.w_size),s.arraySet(Q,V,re-F.w_size,F.w_size,0),V=Q,re=F.w_size),G=p.avail_in,j=p.next_in,D=p.input,p.avail_in=re,p.next_in=0,p.input=V,k(F);F.lookahead>=W;){for(x=F.strstart,_=F.lookahead-(W-1);F.ins_h=(F.ins_h<<F.hash_shift^F.window[x+W-1])&F.hash_mask,F.prev[x&F.w_mask]=F.head[F.ins_h],F.head[F.ins_h]=x,x++,--_;);F.strstart=x,F.lookahead=W-1,k(F)}return F.strstart+=F.lookahead,F.block_start=F.strstart,F.insert=F.lookahead,F.lookahead=0,F.match_length=F.prev_length=W-1,F.match_available=0,p.next_in=j,p.input=D,p.avail_in=G,F.wrap=H,f},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,r,i){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,r,i){r.exports=function(o,s){var a,l,c,u,d,g,f,b,w,y,v,R,T,M,I,L,N,$,W,q,ue,A,B,C,z;a=o.state,l=o.next_in,C=o.input,c=l+(o.avail_in-5),u=o.next_out,z=o.output,d=u-(s-o.avail_out),g=u+(o.avail_out-257),f=a.dmax,b=a.wsize,w=a.whave,y=a.wnext,v=a.window,R=a.hold,T=a.bits,M=a.lencode,I=a.distcode,L=(1<<a.lenbits)-1,N=(1<<a.distbits)-1;e:do{T<15&&(R+=C[l++]<<T,T+=8,R+=C[l++]<<T,T+=8),$=M[R&L];t:for(;;){if(R>>>=W=$>>>24,T-=W,(W=$>>>16&255)===0)z[u++]=65535&$;else{if(!(16&W)){if(!(64&W)){$=M[(65535&$)+(R&(1<<W)-1)];continue t}if(32&W){a.mode=12;break e}o.msg="invalid literal/length code",a.mode=30;break e}q=65535&$,(W&=15)&&(T<W&&(R+=C[l++]<<T,T+=8),q+=R&(1<<W)-1,R>>>=W,T-=W),T<15&&(R+=C[l++]<<T,T+=8,R+=C[l++]<<T,T+=8),$=I[R&N];n:for(;;){if(R>>>=W=$>>>24,T-=W,!(16&(W=$>>>16&255))){if(!(64&W)){$=I[(65535&$)+(R&(1<<W)-1)];continue n}o.msg="invalid distance code",a.mode=30;break e}if(ue=65535&$,T<(W&=15)&&(R+=C[l++]<<T,(T+=8)<W&&(R+=C[l++]<<T,T+=8)),f<(ue+=R&(1<<W)-1)){o.msg="invalid distance too far back",a.mode=30;break e}if(R>>>=W,T-=W,(W=u-d)<ue){if(w<(W=ue-W)&&a.sane){o.msg="invalid distance too far back",a.mode=30;break e}if(B=v,(A=0)===y){if(A+=b-W,W<q){for(q-=W;z[u++]=v[A++],--W;);A=u-ue,B=z}}else if(y<W){if(A+=b+y-W,(W-=y)<q){for(q-=W;z[u++]=v[A++],--W;);if(A=0,y<q){for(q-=W=y;z[u++]=v[A++],--W;);A=u-ue,B=z}}}else if(A+=y-W,W<q){for(q-=W;z[u++]=v[A++],--W;);A=u-ue,B=z}for(;2<q;)z[u++]=B[A++],z[u++]=B[A++],z[u++]=B[A++],q-=3;q&&(z[u++]=B[A++],1<q&&(z[u++]=B[A++]))}else{for(A=u-ue;z[u++]=z[A++],z[u++]=z[A++],z[u++]=z[A++],2<(q-=3););q&&(z[u++]=z[A++],1<q&&(z[u++]=z[A++]))}break}}break}}while(l<c&&u<g);l-=q=T>>3,R&=(1<<(T-=q<<3))-1,o.next_in=l,o.next_out=u,o.avail_in=l<c?c-l+5:5-(l-c),o.avail_out=u<g?g-u+257:257-(u-g),a.hold=R,a.bits=T}},{}],49:[function(n,r,i){var o=n("../utils/common"),s=n("./adler32"),a=n("./crc32"),l=n("./inffast"),c=n("./inftrees"),u=1,d=2,g=0,f=-2,b=1,w=852,y=592;function v(A){return(A>>>24&255)+(A>>>8&65280)+((65280&A)<<8)+((255&A)<<24)}function R(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function T(A){var B;return A&&A.state?(B=A.state,A.total_in=A.total_out=B.total=0,A.msg="",B.wrap&&(A.adler=1&B.wrap),B.mode=b,B.last=0,B.havedict=0,B.dmax=32768,B.head=null,B.hold=0,B.bits=0,B.lencode=B.lendyn=new o.Buf32(w),B.distcode=B.distdyn=new o.Buf32(y),B.sane=1,B.back=-1,g):f}function M(A){var B;return A&&A.state?((B=A.state).wsize=0,B.whave=0,B.wnext=0,T(A)):f}function I(A,B){var C,z;return A&&A.state?(z=A.state,B<0?(C=0,B=-B):(C=1+(B>>4),B<48&&(B&=15)),B&&(B<8||15<B)?f:(z.window!==null&&z.wbits!==B&&(z.window=null),z.wrap=C,z.wbits=B,M(A))):f}function L(A,B){var C,z;return A?(z=new R,(A.state=z).window=null,(C=I(A,B))!==g&&(A.state=null),C):f}var N,$,W=!0;function q(A){if(W){var B;for(N=new o.Buf32(512),$=new o.Buf32(32),B=0;B<144;)A.lens[B++]=8;for(;B<256;)A.lens[B++]=9;for(;B<280;)A.lens[B++]=7;for(;B<288;)A.lens[B++]=8;for(c(u,A.lens,0,288,N,0,A.work,{bits:9}),B=0;B<32;)A.lens[B++]=5;c(d,A.lens,0,32,$,0,A.work,{bits:5}),W=!1}A.lencode=N,A.lenbits=9,A.distcode=$,A.distbits=5}function ue(A,B,C,z){var fe,K=A.state;return K.window===null&&(K.wsize=1<<K.wbits,K.wnext=0,K.whave=0,K.window=new o.Buf8(K.wsize)),z>=K.wsize?(o.arraySet(K.window,B,C-K.wsize,K.wsize,0),K.wnext=0,K.whave=K.wsize):(z<(fe=K.wsize-K.wnext)&&(fe=z),o.arraySet(K.window,B,C-z,fe,K.wnext),(z-=fe)?(o.arraySet(K.window,B,C-z,z,0),K.wnext=z,K.whave=K.wsize):(K.wnext+=fe,K.wnext===K.wsize&&(K.wnext=0),K.whave<K.wsize&&(K.whave+=fe))),0}i.inflateReset=M,i.inflateReset2=I,i.inflateResetKeep=T,i.inflateInit=function(A){return L(A,15)},i.inflateInit2=L,i.inflate=function(A,B){var C,z,fe,K,ie,U,me,h,m,S,E,O,k,Z,Y,ne,oe,X,ye,Ce,p,V,F,x,_=0,H=new o.Buf8(4),G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!A||!A.state||!A.output||!A.input&&A.avail_in!==0)return f;(C=A.state).mode===12&&(C.mode=13),ie=A.next_out,fe=A.output,me=A.avail_out,K=A.next_in,z=A.input,U=A.avail_in,h=C.hold,m=C.bits,S=U,E=me,V=g;e:for(;;)switch(C.mode){case b:if(C.wrap===0){C.mode=13;break}for(;m<16;){if(U===0)break e;U--,h+=z[K++]<<m,m+=8}if(2&C.wrap&&h===35615){H[C.check=0]=255&h,H[1]=h>>>8&255,C.check=a(C.check,H,2,0),m=h=0,C.mode=2;break}if(C.flags=0,C.head&&(C.head.done=!1),!(1&C.wrap)||(((255&h)<<8)+(h>>8))%31){A.msg="incorrect header check",C.mode=30;break}if((15&h)!=8){A.msg="unknown compression method",C.mode=30;break}if(m-=4,p=8+(15&(h>>>=4)),C.wbits===0)C.wbits=p;else if(p>C.wbits){A.msg="invalid window size",C.mode=30;break}C.dmax=1<<p,A.adler=C.check=1,C.mode=512&h?10:12,m=h=0;break;case 2:for(;m<16;){if(U===0)break e;U--,h+=z[K++]<<m,m+=8}if(C.flags=h,(255&C.flags)!=8){A.msg="unknown compression method",C.mode=30;break}if(57344&C.flags){A.msg="unknown header flags set",C.mode=30;break}C.head&&(C.head.text=h>>8&1),512&C.flags&&(H[0]=255&h,H[1]=h>>>8&255,C.check=a(C.check,H,2,0)),m=h=0,C.mode=3;case 3:for(;m<32;){if(U===0)break e;U--,h+=z[K++]<<m,m+=8}C.head&&(C.head.time=h),512&C.flags&&(H[0]=255&h,H[1]=h>>>8&255,H[2]=h>>>16&255,H[3]=h>>>24&255,C.check=a(C.check,H,4,0)),m=h=0,C.mode=4;case 4:for(;m<16;){if(U===0)break e;U--,h+=z[K++]<<m,m+=8}C.head&&(C.head.xflags=255&h,C.head.os=h>>8),512&C.flags&&(H[0]=255&h,H[1]=h>>>8&255,C.check=a(C.check,H,2,0)),m=h=0,C.mode=5;case 5:if(1024&C.flags){for(;m<16;){if(U===0)break e;U--,h+=z[K++]<<m,m+=8}C.length=h,C.head&&(C.head.extra_len=h),512&C.flags&&(H[0]=255&h,H[1]=h>>>8&255,C.check=a(C.check,H,2,0)),m=h=0}else C.head&&(C.head.extra=null);C.mode=6;case 6:if(1024&C.flags&&(U<(O=C.length)&&(O=U),O&&(C.head&&(p=C.head.extra_len-C.length,C.head.extra||(C.head.extra=new Array(C.head.extra_len)),o.arraySet(C.head.extra,z,K,O,p)),512&C.flags&&(C.check=a(C.check,z,O,K)),U-=O,K+=O,C.length-=O),C.length))break e;C.length=0,C.mode=7;case 7:if(2048&C.flags){if(U===0)break e;for(O=0;p=z[K+O++],C.head&&p&&C.length<65536&&(C.head.name+=String.fromCharCode(p)),p&&O<U;);if(512&C.flags&&(C.check=a(C.check,z,O,K)),U-=O,K+=O,p)break e}else C.head&&(C.head.name=null);C.length=0,C.mode=8;case 8:if(4096&C.flags){if(U===0)break e;for(O=0;p=z[K+O++],C.head&&p&&C.length<65536&&(C.head.comment+=String.fromCharCode(p)),p&&O<U;);if(512&C.flags&&(C.check=a(C.check,z,O,K)),U-=O,K+=O,p)break e}else C.head&&(C.head.comment=null);C.mode=9;case 9:if(512&C.flags){for(;m<16;){if(U===0)break e;U--,h+=z[K++]<<m,m+=8}if(h!==(65535&C.check)){A.msg="header crc mismatch",C.mode=30;break}m=h=0}C.head&&(C.head.hcrc=C.flags>>9&1,C.head.done=!0),A.adler=C.check=0,C.mode=12;break;case 10:for(;m<32;){if(U===0)break e;U--,h+=z[K++]<<m,m+=8}A.adler=C.check=v(h),m=h=0,C.mode=11;case 11:if(C.havedict===0)return A.next_out=ie,A.avail_out=me,A.next_in=K,A.avail_in=U,C.hold=h,C.bits=m,2;A.adler=C.check=1,C.mode=12;case 12:if(B===5||B===6)break e;case 13:if(C.last){h>>>=7&m,m-=7&m,C.mode=27;break}for(;m<3;){if(U===0)break e;U--,h+=z[K++]<<m,m+=8}switch(C.last=1&h,m-=1,3&(h>>>=1)){case 0:C.mode=14;break;case 1:if(q(C),C.mode=20,B!==6)break;h>>>=2,m-=2;break e;case 2:C.mode=17;break;case 3:A.msg="invalid block type",C.mode=30}h>>>=2,m-=2;break;case 14:for(h>>>=7&m,m-=7&m;m<32;){if(U===0)break e;U--,h+=z[K++]<<m,m+=8}if((65535&h)!=(h>>>16^65535)){A.msg="invalid stored block lengths",C.mode=30;break}if(C.length=65535&h,m=h=0,C.mode=15,B===6)break e;case 15:C.mode=16;case 16:if(O=C.length){if(U<O&&(O=U),me<O&&(O=me),O===0)break e;o.arraySet(fe,z,K,O,ie),U-=O,K+=O,me-=O,ie+=O,C.length-=O;break}C.mode=12;break;case 17:for(;m<14;){if(U===0)break e;U--,h+=z[K++]<<m,m+=8}if(C.nlen=257+(31&h),h>>>=5,m-=5,C.ndist=1+(31&h),h>>>=5,m-=5,C.ncode=4+(15&h),h>>>=4,m-=4,286<C.nlen||30<C.ndist){A.msg="too many length or distance symbols",C.mode=30;break}C.have=0,C.mode=18;case 18:for(;C.have<C.ncode;){for(;m<3;){if(U===0)break e;U--,h+=z[K++]<<m,m+=8}C.lens[G[C.have++]]=7&h,h>>>=3,m-=3}for(;C.have<19;)C.lens[G[C.have++]]=0;if(C.lencode=C.lendyn,C.lenbits=7,F={bits:C.lenbits},V=c(0,C.lens,0,19,C.lencode,0,C.work,F),C.lenbits=F.bits,V){A.msg="invalid code lengths set",C.mode=30;break}C.have=0,C.mode=19;case 19:for(;C.have<C.nlen+C.ndist;){for(;ne=(_=C.lencode[h&(1<<C.lenbits)-1])>>>16&255,oe=65535&_,!((Y=_>>>24)<=m);){if(U===0)break e;U--,h+=z[K++]<<m,m+=8}if(oe<16)h>>>=Y,m-=Y,C.lens[C.have++]=oe;else{if(oe===16){for(x=Y+2;m<x;){if(U===0)break e;U--,h+=z[K++]<<m,m+=8}if(h>>>=Y,m-=Y,C.have===0){A.msg="invalid bit length repeat",C.mode=30;break}p=C.lens[C.have-1],O=3+(3&h),h>>>=2,m-=2}else if(oe===17){for(x=Y+3;m<x;){if(U===0)break e;U--,h+=z[K++]<<m,m+=8}m-=Y,p=0,O=3+(7&(h>>>=Y)),h>>>=3,m-=3}else{for(x=Y+7;m<x;){if(U===0)break e;U--,h+=z[K++]<<m,m+=8}m-=Y,p=0,O=11+(127&(h>>>=Y)),h>>>=7,m-=7}if(C.have+O>C.nlen+C.ndist){A.msg="invalid bit length repeat",C.mode=30;break}for(;O--;)C.lens[C.have++]=p}}if(C.mode===30)break;if(C.lens[256]===0){A.msg="invalid code -- missing end-of-block",C.mode=30;break}if(C.lenbits=9,F={bits:C.lenbits},V=c(u,C.lens,0,C.nlen,C.lencode,0,C.work,F),C.lenbits=F.bits,V){A.msg="invalid literal/lengths set",C.mode=30;break}if(C.distbits=6,C.distcode=C.distdyn,F={bits:C.distbits},V=c(d,C.lens,C.nlen,C.ndist,C.distcode,0,C.work,F),C.distbits=F.bits,V){A.msg="invalid distances set",C.mode=30;break}if(C.mode=20,B===6)break e;case 20:C.mode=21;case 21:if(6<=U&&258<=me){A.next_out=ie,A.avail_out=me,A.next_in=K,A.avail_in=U,C.hold=h,C.bits=m,l(A,E),ie=A.next_out,fe=A.output,me=A.avail_out,K=A.next_in,z=A.input,U=A.avail_in,h=C.hold,m=C.bits,C.mode===12&&(C.back=-1);break}for(C.back=0;ne=(_=C.lencode[h&(1<<C.lenbits)-1])>>>16&255,oe=65535&_,!((Y=_>>>24)<=m);){if(U===0)break e;U--,h+=z[K++]<<m,m+=8}if(ne&&!(240&ne)){for(X=Y,ye=ne,Ce=oe;ne=(_=C.lencode[Ce+((h&(1<<X+ye)-1)>>X)])>>>16&255,oe=65535&_,!(X+(Y=_>>>24)<=m);){if(U===0)break e;U--,h+=z[K++]<<m,m+=8}h>>>=X,m-=X,C.back+=X}if(h>>>=Y,m-=Y,C.back+=Y,C.length=oe,ne===0){C.mode=26;break}if(32&ne){C.back=-1,C.mode=12;break}if(64&ne){A.msg="invalid literal/length code",C.mode=30;break}C.extra=15&ne,C.mode=22;case 22:if(C.extra){for(x=C.extra;m<x;){if(U===0)break e;U--,h+=z[K++]<<m,m+=8}C.length+=h&(1<<C.extra)-1,h>>>=C.extra,m-=C.extra,C.back+=C.extra}C.was=C.length,C.mode=23;case 23:for(;ne=(_=C.distcode[h&(1<<C.distbits)-1])>>>16&255,oe=65535&_,!((Y=_>>>24)<=m);){if(U===0)break e;U--,h+=z[K++]<<m,m+=8}if(!(240&ne)){for(X=Y,ye=ne,Ce=oe;ne=(_=C.distcode[Ce+((h&(1<<X+ye)-1)>>X)])>>>16&255,oe=65535&_,!(X+(Y=_>>>24)<=m);){if(U===0)break e;U--,h+=z[K++]<<m,m+=8}h>>>=X,m-=X,C.back+=X}if(h>>>=Y,m-=Y,C.back+=Y,64&ne){A.msg="invalid distance code",C.mode=30;break}C.offset=oe,C.extra=15&ne,C.mode=24;case 24:if(C.extra){for(x=C.extra;m<x;){if(U===0)break e;U--,h+=z[K++]<<m,m+=8}C.offset+=h&(1<<C.extra)-1,h>>>=C.extra,m-=C.extra,C.back+=C.extra}if(C.offset>C.dmax){A.msg="invalid distance too far back",C.mode=30;break}C.mode=25;case 25:if(me===0)break e;if(O=E-me,C.offset>O){if((O=C.offset-O)>C.whave&&C.sane){A.msg="invalid distance too far back",C.mode=30;break}k=O>C.wnext?(O-=C.wnext,C.wsize-O):C.wnext-O,O>C.length&&(O=C.length),Z=C.window}else Z=fe,k=ie-C.offset,O=C.length;for(me<O&&(O=me),me-=O,C.length-=O;fe[ie++]=Z[k++],--O;);C.length===0&&(C.mode=21);break;case 26:if(me===0)break e;fe[ie++]=C.length,me--,C.mode=21;break;case 27:if(C.wrap){for(;m<32;){if(U===0)break e;U--,h|=z[K++]<<m,m+=8}if(E-=me,A.total_out+=E,C.total+=E,E&&(A.adler=C.check=C.flags?a(C.check,fe,E,ie-E):s(C.check,fe,E,ie-E)),E=me,(C.flags?h:v(h))!==C.check){A.msg="incorrect data check",C.mode=30;break}m=h=0}C.mode=28;case 28:if(C.wrap&&C.flags){for(;m<32;){if(U===0)break e;U--,h+=z[K++]<<m,m+=8}if(h!==(4294967295&C.total)){A.msg="incorrect length check",C.mode=30;break}m=h=0}C.mode=29;case 29:V=1;break e;case 30:V=-3;break e;case 31:return-4;case 32:default:return f}return A.next_out=ie,A.avail_out=me,A.next_in=K,A.avail_in=U,C.hold=h,C.bits=m,(C.wsize||E!==A.avail_out&&C.mode<30&&(C.mode<27||B!==4))&&ue(A,A.output,A.next_out,E-A.avail_out)?(C.mode=31,-4):(S-=A.avail_in,E-=A.avail_out,A.total_in+=S,A.total_out+=E,C.total+=E,C.wrap&&E&&(A.adler=C.check=C.flags?a(C.check,fe,E,A.next_out-E):s(C.check,fe,E,A.next_out-E)),A.data_type=C.bits+(C.last?64:0)+(C.mode===12?128:0)+(C.mode===20||C.mode===15?256:0),(S==0&&E===0||B===4)&&V===g&&(V=-5),V)},i.inflateEnd=function(A){if(!A||!A.state)return f;var B=A.state;return B.window&&(B.window=null),A.state=null,g},i.inflateGetHeader=function(A,B){var C;return A&&A.state&&2&(C=A.state).wrap?((C.head=B).done=!1,g):f},i.inflateSetDictionary=function(A,B){var C,z=B.length;return A&&A.state?(C=A.state).wrap!==0&&C.mode!==11?f:C.mode===11&&s(1,B,z,0)!==C.check?-3:ue(A,B,z,z)?(C.mode=31,-4):(C.havedict=1,g):f},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,r,i){var o=n("../utils/common"),s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(u,d,g,f,b,w,y,v){var R,T,M,I,L,N,$,W,q,ue=v.bits,A=0,B=0,C=0,z=0,fe=0,K=0,ie=0,U=0,me=0,h=0,m=null,S=0,E=new o.Buf16(16),O=new o.Buf16(16),k=null,Z=0;for(A=0;A<=15;A++)E[A]=0;for(B=0;B<f;B++)E[d[g+B]]++;for(fe=ue,z=15;1<=z&&E[z]===0;z--);if(z<fe&&(fe=z),z===0)return b[w++]=20971520,b[w++]=20971520,v.bits=1,0;for(C=1;C<z&&E[C]===0;C++);for(fe<C&&(fe=C),A=U=1;A<=15;A++)if(U<<=1,(U-=E[A])<0)return-1;if(0<U&&(u===0||z!==1))return-1;for(O[1]=0,A=1;A<15;A++)O[A+1]=O[A]+E[A];for(B=0;B<f;B++)d[g+B]!==0&&(y[O[d[g+B]]++]=B);if(N=u===0?(m=k=y,19):u===1?(m=s,S-=257,k=a,Z-=257,256):(m=l,k=c,-1),A=C,L=w,ie=B=h=0,M=-1,I=(me=1<<(K=fe))-1,u===1&&852<me||u===2&&592<me)return 1;for(;;){for($=A-ie,q=y[B]<N?(W=0,y[B]):y[B]>N?(W=k[Z+y[B]],m[S+y[B]]):(W=96,0),R=1<<A-ie,C=T=1<<K;b[L+(h>>ie)+(T-=R)]=$<<24|W<<16|q|0,T!==0;);for(R=1<<A-1;h&R;)R>>=1;if(R!==0?(h&=R-1,h+=R):h=0,B++,--E[A]==0){if(A===z)break;A=d[g+y[B]]}if(fe<A&&(h&I)!==M){for(ie===0&&(ie=fe),L+=C,U=1<<(K=A-ie);K+ie<z&&!((U-=E[K+ie])<=0);)K++,U<<=1;if(me+=1<<K,u===1&&852<me||u===2&&592<me)return 1;b[M=h&I]=fe<<24|K<<16|L-w|0}}return h!==0&&(b[L+h]=A-ie<<24|64<<16|0),v.bits=fe,0}},{"../utils/common":41}],51:[function(n,r,i){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,r,i){var o=n("../utils/common"),s=0,a=1;function l(_){for(var H=_.length;0<=--H;)_[H]=0}var c=0,u=29,d=256,g=d+1+u,f=30,b=19,w=2*g+1,y=15,v=16,R=7,T=256,M=16,I=17,L=18,N=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],$=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],W=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ue=new Array(2*(g+2));l(ue);var A=new Array(2*f);l(A);var B=new Array(512);l(B);var C=new Array(256);l(C);var z=new Array(u);l(z);var fe,K,ie,U=new Array(f);function me(_,H,G,j,D){this.static_tree=_,this.extra_bits=H,this.extra_base=G,this.elems=j,this.max_length=D,this.has_stree=_&&_.length}function h(_,H){this.dyn_tree=_,this.max_code=0,this.stat_desc=H}function m(_){return _<256?B[_]:B[256+(_>>>7)]}function S(_,H){_.pending_buf[_.pending++]=255&H,_.pending_buf[_.pending++]=H>>>8&255}function E(_,H,G){_.bi_valid>v-G?(_.bi_buf|=H<<_.bi_valid&65535,S(_,_.bi_buf),_.bi_buf=H>>v-_.bi_valid,_.bi_valid+=G-v):(_.bi_buf|=H<<_.bi_valid&65535,_.bi_valid+=G)}function O(_,H,G){E(_,G[2*H],G[2*H+1])}function k(_,H){for(var G=0;G|=1&_,_>>>=1,G<<=1,0<--H;);return G>>>1}function Z(_,H,G){var j,D,Q=new Array(y+1),re=0;for(j=1;j<=y;j++)Q[j]=re=re+G[j-1]<<1;for(D=0;D<=H;D++){var J=_[2*D+1];J!==0&&(_[2*D]=k(Q[J]++,J))}}function Y(_){var H;for(H=0;H<g;H++)_.dyn_ltree[2*H]=0;for(H=0;H<f;H++)_.dyn_dtree[2*H]=0;for(H=0;H<b;H++)_.bl_tree[2*H]=0;_.dyn_ltree[2*T]=1,_.opt_len=_.static_len=0,_.last_lit=_.matches=0}function ne(_){8<_.bi_valid?S(_,_.bi_buf):0<_.bi_valid&&(_.pending_buf[_.pending++]=_.bi_buf),_.bi_buf=0,_.bi_valid=0}function oe(_,H,G,j){var D=2*H,Q=2*G;return _[D]<_[Q]||_[D]===_[Q]&&j[H]<=j[G]}function X(_,H,G){for(var j=_.heap[G],D=G<<1;D<=_.heap_len&&(D<_.heap_len&&oe(H,_.heap[D+1],_.heap[D],_.depth)&&D++,!oe(H,j,_.heap[D],_.depth));)_.heap[G]=_.heap[D],G=D,D<<=1;_.heap[G]=j}function ye(_,H,G){var j,D,Q,re,J=0;if(_.last_lit!==0)for(;j=_.pending_buf[_.d_buf+2*J]<<8|_.pending_buf[_.d_buf+2*J+1],D=_.pending_buf[_.l_buf+J],J++,j===0?O(_,D,H):(O(_,(Q=C[D])+d+1,H),(re=N[Q])!==0&&E(_,D-=z[Q],re),O(_,Q=m(--j),G),(re=$[Q])!==0&&E(_,j-=U[Q],re)),J<_.last_lit;);O(_,T,H)}function Ce(_,H){var G,j,D,Q=H.dyn_tree,re=H.stat_desc.static_tree,J=H.stat_desc.has_stree,ce=H.stat_desc.elems,Re=-1;for(_.heap_len=0,_.heap_max=w,G=0;G<ce;G++)Q[2*G]!==0?(_.heap[++_.heap_len]=Re=G,_.depth[G]=0):Q[2*G+1]=0;for(;_.heap_len<2;)Q[2*(D=_.heap[++_.heap_len]=Re<2?++Re:0)]=1,_.depth[D]=0,_.opt_len--,J&&(_.static_len-=re[2*D+1]);for(H.max_code=Re,G=_.heap_len>>1;1<=G;G--)X(_,Q,G);for(D=ce;G=_.heap[1],_.heap[1]=_.heap[_.heap_len--],X(_,Q,1),j=_.heap[1],_.heap[--_.heap_max]=G,_.heap[--_.heap_max]=j,Q[2*D]=Q[2*G]+Q[2*j],_.depth[D]=(_.depth[G]>=_.depth[j]?_.depth[G]:_.depth[j])+1,Q[2*G+1]=Q[2*j+1]=D,_.heap[1]=D++,X(_,Q,1),2<=_.heap_len;);_.heap[--_.heap_max]=_.heap[1],function(ve,gt){var gn,vt,st,Pe,nt,Et,qe=gt.dyn_tree,yt=gt.max_code,Mo=gt.stat_desc.static_tree,pn=gt.stat_desc.has_stree,df=gt.stat_desc.extra_bits,uc=gt.stat_desc.extra_base,Xe=gt.stat_desc.max_length,Dn=0;for(Pe=0;Pe<=y;Pe++)ve.bl_count[Pe]=0;for(qe[2*ve.heap[ve.heap_max]+1]=0,gn=ve.heap_max+1;gn<w;gn++)Xe<(Pe=qe[2*qe[2*(vt=ve.heap[gn])+1]+1]+1)&&(Pe=Xe,Dn++),qe[2*vt+1]=Pe,yt<vt||(ve.bl_count[Pe]++,nt=0,uc<=vt&&(nt=df[vt-uc]),Et=qe[2*vt],ve.opt_len+=Et*(Pe+nt),pn&&(ve.static_len+=Et*(Mo[2*vt+1]+nt)));if(Dn!==0){do{for(Pe=Xe-1;ve.bl_count[Pe]===0;)Pe--;ve.bl_count[Pe]--,ve.bl_count[Pe+1]+=2,ve.bl_count[Xe]--,Dn-=2}while(0<Dn);for(Pe=Xe;Pe!==0;Pe--)for(vt=ve.bl_count[Pe];vt!==0;)yt<(st=ve.heap[--gn])||(qe[2*st+1]!==Pe&&(ve.opt_len+=(Pe-qe[2*st+1])*qe[2*st],qe[2*st+1]=Pe),vt--)}}(_,H),Z(Q,Re,_.bl_count)}function p(_,H,G){var j,D,Q=-1,re=H[1],J=0,ce=7,Re=4;for(re===0&&(ce=138,Re=3),H[2*(G+1)+1]=65535,j=0;j<=G;j++)D=re,re=H[2*(j+1)+1],++J<ce&&D===re||(J<Re?_.bl_tree[2*D]+=J:D!==0?(D!==Q&&_.bl_tree[2*D]++,_.bl_tree[2*M]++):J<=10?_.bl_tree[2*I]++:_.bl_tree[2*L]++,Q=D,Re=(J=0)===re?(ce=138,3):D===re?(ce=6,3):(ce=7,4))}function V(_,H,G){var j,D,Q=-1,re=H[1],J=0,ce=7,Re=4;for(re===0&&(ce=138,Re=3),j=0;j<=G;j++)if(D=re,re=H[2*(j+1)+1],!(++J<ce&&D===re)){if(J<Re)for(;O(_,D,_.bl_tree),--J!=0;);else D!==0?(D!==Q&&(O(_,D,_.bl_tree),J--),O(_,M,_.bl_tree),E(_,J-3,2)):J<=10?(O(_,I,_.bl_tree),E(_,J-3,3)):(O(_,L,_.bl_tree),E(_,J-11,7));Q=D,Re=(J=0)===re?(ce=138,3):D===re?(ce=6,3):(ce=7,4)}}l(U);var F=!1;function x(_,H,G,j){E(_,(c<<1)+(j?1:0),3),function(D,Q,re,J){ne(D),S(D,re),S(D,~re),o.arraySet(D.pending_buf,D.window,Q,re,D.pending),D.pending+=re}(_,H,G)}i._tr_init=function(_){F||(function(){var H,G,j,D,Q,re=new Array(y+1);for(D=j=0;D<u-1;D++)for(z[D]=j,H=0;H<1<<N[D];H++)C[j++]=D;for(C[j-1]=D,D=Q=0;D<16;D++)for(U[D]=Q,H=0;H<1<<$[D];H++)B[Q++]=D;for(Q>>=7;D<f;D++)for(U[D]=Q<<7,H=0;H<1<<$[D]-7;H++)B[256+Q++]=D;for(G=0;G<=y;G++)re[G]=0;for(H=0;H<=143;)ue[2*H+1]=8,H++,re[8]++;for(;H<=255;)ue[2*H+1]=9,H++,re[9]++;for(;H<=279;)ue[2*H+1]=7,H++,re[7]++;for(;H<=287;)ue[2*H+1]=8,H++,re[8]++;for(Z(ue,g+1,re),H=0;H<f;H++)A[2*H+1]=5,A[2*H]=k(H,5);fe=new me(ue,N,d+1,g,y),K=new me(A,$,0,f,y),ie=new me(new Array(0),W,0,b,R)}(),F=!0),_.l_desc=new h(_.dyn_ltree,fe),_.d_desc=new h(_.dyn_dtree,K),_.bl_desc=new h(_.bl_tree,ie),_.bi_buf=0,_.bi_valid=0,Y(_)},i._tr_stored_block=x,i._tr_flush_block=function(_,H,G,j){var D,Q,re=0;0<_.level?(_.strm.data_type===2&&(_.strm.data_type=function(J){var ce,Re=4093624447;for(ce=0;ce<=31;ce++,Re>>>=1)if(1&Re&&J.dyn_ltree[2*ce]!==0)return s;if(J.dyn_ltree[18]!==0||J.dyn_ltree[20]!==0||J.dyn_ltree[26]!==0)return a;for(ce=32;ce<d;ce++)if(J.dyn_ltree[2*ce]!==0)return a;return s}(_)),Ce(_,_.l_desc),Ce(_,_.d_desc),re=function(J){var ce;for(p(J,J.dyn_ltree,J.l_desc.max_code),p(J,J.dyn_dtree,J.d_desc.max_code),Ce(J,J.bl_desc),ce=b-1;3<=ce&&J.bl_tree[2*q[ce]+1]===0;ce--);return J.opt_len+=3*(ce+1)+5+5+4,ce}(_),D=_.opt_len+3+7>>>3,(Q=_.static_len+3+7>>>3)<=D&&(D=Q)):D=Q=G+5,G+4<=D&&H!==-1?x(_,H,G,j):_.strategy===4||Q===D?(E(_,2+(j?1:0),3),ye(_,ue,A)):(E(_,4+(j?1:0),3),function(J,ce,Re,ve){var gt;for(E(J,ce-257,5),E(J,Re-1,5),E(J,ve-4,4),gt=0;gt<ve;gt++)E(J,J.bl_tree[2*q[gt]+1],3);V(J,J.dyn_ltree,ce-1),V(J,J.dyn_dtree,Re-1)}(_,_.l_desc.max_code+1,_.d_desc.max_code+1,re+1),ye(_,_.dyn_ltree,_.dyn_dtree)),Y(_),j&&ne(_)},i._tr_tally=function(_,H,G){return _.pending_buf[_.d_buf+2*_.last_lit]=H>>>8&255,_.pending_buf[_.d_buf+2*_.last_lit+1]=255&H,_.pending_buf[_.l_buf+_.last_lit]=255&G,_.last_lit++,H===0?_.dyn_ltree[2*G]++:(_.matches++,H--,_.dyn_ltree[2*(C[G]+d+1)]++,_.dyn_dtree[2*m(H)]++),_.last_lit===_.lit_bufsize-1},i._tr_align=function(_){E(_,2,3),O(_,T,ue),function(H){H.bi_valid===16?(S(H,H.bi_buf),H.bi_buf=0,H.bi_valid=0):8<=H.bi_valid&&(H.pending_buf[H.pending++]=255&H.bi_buf,H.bi_buf>>=8,H.bi_valid-=8)}(_)}},{"../utils/common":41}],53:[function(n,r,i){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,r,i){(function(o){(function(s,a){if(!s.setImmediate){var l,c,u,d,g=1,f={},b=!1,w=s.document,y=Object.getPrototypeOf&&Object.getPrototypeOf(s);y=y&&y.setTimeout?y:s,l={}.toString.call(s.process)==="[object process]"?function(M){process.nextTick(function(){R(M)})}:function(){if(s.postMessage&&!s.importScripts){var M=!0,I=s.onmessage;return s.onmessage=function(){M=!1},s.postMessage("","*"),s.onmessage=I,M}}()?(d="setImmediate$"+Math.random()+"$",s.addEventListener?s.addEventListener("message",T,!1):s.attachEvent("onmessage",T),function(M){s.postMessage(d+M,"*")}):s.MessageChannel?((u=new MessageChannel).port1.onmessage=function(M){R(M.data)},function(M){u.port2.postMessage(M)}):w&&"onreadystatechange"in w.createElement("script")?(c=w.documentElement,function(M){var I=w.createElement("script");I.onreadystatechange=function(){R(M),I.onreadystatechange=null,c.removeChild(I),I=null},c.appendChild(I)}):function(M){setTimeout(R,0,M)},y.setImmediate=function(M){typeof M!="function"&&(M=new Function(""+M));for(var I=new Array(arguments.length-1),L=0;L<I.length;L++)I[L]=arguments[L+1];var N={callback:M,args:I};return f[g]=N,l(g),g++},y.clearImmediate=v}function v(M){delete f[M]}function R(M){if(b)setTimeout(R,0,M);else{var I=f[M];if(I){b=!0;try{(function(L){var N=L.callback,$=L.args;switch($.length){case 0:N();break;case 1:N($[0]);break;case 2:N($[0],$[1]);break;case 3:N($[0],$[1],$[2]);break;default:N.apply(a,$)}})(I)}finally{v(M),b=!1}}}}function T(M){M.source===s&&typeof M.data=="string"&&M.data.indexOf(d)===0&&R(+M.data.slice(d.length))}})(typeof self>"u"?o===void 0?this:o:self)}).call(this,typeof Mr<"u"?Mr:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Lv);var FD=Lv.exports;const $D=Sy(FD);async function Fv(t,e,n){n??(n=_f());const r=await qr(`https://amp-api.music.apple.com/v1/catalog/${n}/songs/${t}/${e?"syllable-lyrics":"lyrics"}`,{headers:{Origin:"https://music.apple.com",Referer:"https://music.apple.com/",Authorization:`Bearer ${await Js()}`}});return r.status===404?null:(await r.json()).data[0]}function $v(t){return t.trim().replace(/[\/\?<>\\:\*\|":]/g,"_").replace(/\.+$/,"_")}async function WD(t){const e=Tf();if(!e){alert("Lyrics can only be ripped when you have an active subscription in the specific storefront.");return}const n=await Di(t,e);if(!n)return;const r=new $D;for(const o of n.relationships.tracks.data){if(o.attributes.hasTimeSyncedLyrics){const s=await Fv(o.id,!0,e);s&&Wv(r,o.attributes,s.attributes,!0)}if(o.attributes.hasLyrics){const s=await Fv(o.id,!1,e);s&&Wv(r,o.attributes,s.attributes,!1)}await Ni(100)}if(Object.keys(r.files).length===0){alert("No lyrics found.");return}const i=await r.generateAsync({type:"blob"});Rf(i,$v(`Lyrics {${n.attributes.upc||n.id}}.zip`))}function Wv(t,e,n,r){const i=$v(`${e.discNumber}-${e.trackNumber.toString().padStart(2,"0")}. ${e.name.slice(0,120)}`);if(r&&n.ttml.includes("<span begin=")?t.file(`${i}.syllable.ttml`,n.ttml):t.file(`${i}.ttml`,n.ttml),!r){const o=new DOMParser().parseFromString(n.ttml,"text/xml");let s="";for(const a of Array.from(o.querySelectorAll("p"))){const l=a.getAttribute("begin");l?s+=`[${BD(l)}] ${a.textContent}
`:s+=`${a.textContent}
`}t.file(`${i}.lrc`,s)}}function BD(t){const e=t.split(/[:.]/g).reverse(),n=(e[2]??"").padStart(2,"0"),r=(e[1]??"").padStart(2,"0"),i=Math.floor(Number(e[0])/10).toString().padStart(2,"0");return`${n}:${r}.${i}`}hl(zs),hl(AD),hl(aD),hl(CD);const Bv={audioTraits:"Formats",id:"ID",discNumber:"Disc #",trackNumber:"Track #",duration:"Duration",isrc:"ISRC",upc:"UPC",albumDate:"Album Date",trackDate:"Track Date",locale:"Locale",lyrics:"Lyrics",genres:"Genres",composer:"Composer",artist:"Artist",title:"Title",label:"Label",copyright:"Copyright",albumArtist:"Album Artist",albumTitle:"Album Title"},VD=Object.fromEntries(Object.entries(Bv).map(t=>t.reverse())),Vv=["audioTraits","id","discNumber","trackNumber","duration","isrc","upc","albumDate","trackDate","locale","lyrics","genres","composer","artist","title","label","copyright","albumArtist","albumTitle"],af=Li("Show Info",LD);af.addEventListener("click",zD);let lf=!1,en=null;Zr(async()=>{Fi(af,300),cf()}),Ao(()=>{Io(af),cf()});async function zD(){var w;if(lf)return;lf=!0;const t=location.pathname.split("/")[4];let e=null,n=localStorage.getItem("ame-info-storefront")||location.pathname.split("/")[1];const r=await Ef();en=tn(`
    <div id="ame-dock">
      <div id="ame-dock-title">Album Info</div>
      <div id="ame-dock-control">
        <select id="ame-dock-control-storefront">
          ${r.map(y=>`<option value="${y.id}"${y.id===n?" selected":""}>${y.attributes.name}</option>`).join("")}
        </select>
        <button id="ame-dock-control-isrc2mb" title="Seed ISRCs to MusicBrainz.">ISRC2MB</button>
        <button id="ame-dock-control-lyrics" title="Download a zip file with lyrics when available.">LYRICS (${((w=Tf())==null?void 0:w.toUpperCase())||"N/A"})</button>
        <button id="ame-dock-control-raw" title="Download the raw album API response.">RAW</button>
      </div>
      <div id="ame-dock-table"></div>
    </div>
  `);const i=en.querySelector("#ame-dock-title"),o=en.querySelector("#ame-dock-control-storefront"),s=en.querySelector("#ame-dock-control-isrc2mb"),a=en.querySelector("#ame-dock-control-lyrics"),l=en.querySelector("#ame-dock-control-raw"),c=en.querySelector("#ame-dock-table");i.addEventListener("click",()=>{cf()}),l.addEventListener("click",async()=>{const y=await Di(t,n);Rf(new Blob([JSON.stringify(y,null,"	")],{type:"application/json"}),`${t}.json`)}),s.addEventListener("click",async()=>{if(!e)return;const y=e.attributes.upc.replace(/^0+/,""),R=await(await qr(`https://musicbrainz.org/ws/2/release/?fmt=json&query=barcode:${y}%20AND%20format:digitalmedia`)).json(),T=new URLSearchParams;R.releases.length&&T.set("mbid",R.releases[0].id),e.relationships.tracks.data.forEach((M,I)=>{T.set(`isrc${I+1}`,M.attributes.isrc)}),open(`https://magicisrc.kepstin.ca/?${T.toString()}`,"_blank")});let u=!1;a.addEventListener("click",async()=>{if(!u){u=!0;try{await WD(t)}catch(y){console.error(y)}u=!1}});let d=JSON.parse(localStorage.getItem("ame-info-columns")||"[]");d.length!==Vv.length&&(d=Vv),document.body.appendChild(en);const g=new kn(c,{licenseKey:"non-commercial-and-evaluation",data:[],rowHeaders:!0,columns:d.map(y=>({data:y,title:Bv[y]})),editor:!1,manualColumnMove:!0,height:Math.max(320,Math.floor(innerHeight/3)),stretchH:"all",wordWrap:!1,renderer(y,v,R,T,M,I,L){const N=y.getSourceDataAtRow(R);switch(R%2&&v.classList.add("ame-table-band"),d[T]){case"trackDate":N.albumDate!==N.trackDate&&(v.style.textDecoration="underline"),v.innerText=I;break;default:v.innerText=I;break}},afterColumnMove(y,v,R,T,M){if(!M)return;const I=Array.from({length:g.countCols()},(L,N)=>VD[g.getColHeader(N)]);localStorage.setItem("ame-info-columns",JSON.stringify(I))}}),f=document.querySelector(".app-container");f.style.paddingBottom=en.clientHeight+"px";async function b(){const y=await Di(t,n);if(!y)return;e=y,console.log("Album Info:",y);let v="Album Info";y.attributes.isComplete||(v+=` (Incomplete - ${y.relationships.tracks.data.length}/${y.attributes.trackCount})`),i.innerText=v,s.style.display=y.attributes.isComplete?"":"none";const R=y.relationships.tracks.data.map(T=>({audioTraits:T.attributes.audioTraits.join(";"),id:T.id,discNumber:T.attributes.discNumber,trackNumber:T.attributes.trackNumber,duration:jD(T.attributes.durationInMillis),isrc:T.attributes.isrc??"",upc:y.attributes.upc??"",albumDate:y.attributes.releaseDate??"",trackDate:T.attributes.releaseDate??"",locale:T.attributes.audioLocale??"",lyrics:T.attributes.hasLyrics?T.attributes.hasTimeSyncedLyrics?"S":"U":"",genres:T.attributes.genreNames.join("\\\\"),composer:T.attributes.composerName??"",artist:T.attributes.artistName,title:T.attributes.name,label:y.attributes.recordLabel??"",copyright:y.attributes.copyright??"",albumArtist:y.attributes.artistName,albumTitle:y.attributes.name}));g.updateData(R)}await b(),o.addEventListener("change",async y=>{n=y.target.value,localStorage.setItem("ame-info-storefront",n),await b()})}function cf(){lf=!1,en==null||en.remove(),en=null;const t=document.querySelector(".app-container");t&&(t.style.paddingBottom="")}function jD(t){let e=Math.floor(t/1e3);const n=Math.floor(e/60);return e=e%60,`${n}:${e.toString().padStart(2,"0")}`}var uf;(t=>{(e=>{e[e.none=0]="none",e[e.loading=1]="loading",e[e.playing=2]="playing",e[e.paused=3]="paused",e[e.stopped=4]="stopped",e[e.ended=5]="ended",e[e.seeking=6]="seeking",e[e.waiting=8]="waiting",e[e.stalled=9]="stalled",e[e.completed=10]="completed"})(t.PlaybackStates||(t.PlaybackStates={}))})(uf||(uf={})),document.addEventListener("keydown",t=>{t.target.matches("input.search-input__text-field")&&(t.stopPropagation(),t.stopImmediatePropagation())}),gy(()=>rr.MusicKit).then(t=>t.getInstance()).then(t=>{t.addEventListener("playbackStateDidChange",ay(async e=>{t.isAuthorized||e.state===uf.PlaybackStates.ended&&await t.skipToNextItem()}))});const hf=Li("Seed MusicBrainz",`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" slot="app-icon">
  <path d="M440-120v-319q-64 0-123-24.5T213-533q-45-45-69-104t-24-123v-80h80q63 0 122 24.5T426-746q31 31 51.5 68t31.5 79q5-7 11-13.5t13-13.5q45-45 104-69.5T760-720h80v80q0 64-24.5 123T746-413q-45 45-103.5 69T520-320v200h-80Zm0-400q0-48-18.5-91.5T369-689q-34-34-77.5-52.5T200-760q0 48 18 92t52 78q34 34 78 52t92 18Zm80 120q48 0 91.5-18t77.5-52q34-34 52.5-78t18.5-92q-48 0-92 18.5T590-569q-34 34-52 77.5T520-400Zm0 0Zm-80-120Z" />
</svg>
`);hf.addEventListener("click",()=>{open(`https://seed.musichoarders.xyz?identifier=${encodeURIComponent(location.href)}`,"_blank")}),Zr(()=>{Fi(hf,500)}),Ao(()=>{Io(hf)});const UD=".ame-color-primary{color:var(--systemPrimary)}.ame-color-secondary{color:var(--systemSecondary)}.ame-color-tertiary{color:var(--systemTertiary)}.ame-color-warning{color:var(--systemYellow)}.upsell-banner,.banner-container,.navigation__native-cta{display:none!important}div[slot=artwork]{height:fit-content}.page-error{width:100%!important;max-width:960px!important}.headings__title,.headings__subtitles *,.description *{user-select:text;-moz-user-select:text;-webkit-user-select:text}.navigation-items__header[data-ame]{border-radius:6px;font-size:10px;font-weight:600;letter-spacing:0;line-height:1.3;margin:0 20px -3px;padding:4px 6px;color:var(--systemSecondary)}.navigation-items__list[data-ame]{font-size:15px;padding:0 25px 9px;font-weight:400;letter-spacing:0}.navigation-item[data-ame]{margin-bottom:1px;height:32px;padding:4px;position:relative;border-radius:6px;--linkHoverTextDecoration: none}.navigation-item__link[data-ame]{align-items:center;border-radius:6px;box-sizing:content-box;-moz-column-gap:8px;column-gap:8px;display:flex;height:100%;margin:-3px;padding:3px;width:100%;font-size:.8rem}.navigation-item__link[data-ame] svg{width:24px;height:24px;fill:var(--systemSecondary);background-color:transparent;display:inline-block;flex-shrink:0}.ame-album-badges-container>svg{margin-right:1em;margin-top:1em;fill:var(--systemSecondary)}.ame-album-storefronts-header{margin:0 var(--bodyGutter);font-size:1.1em}.ame-album-storefronts-container{display:flex;margin:0 var(--bodyGutter);margin-bottom:var(--bodyGutter);padding-top:1em;line-height:2.2;text-align:justify;flex-direction:column}.ame-album-storefronts-container>div:not(:last-child):not(:empty){padding-bottom:1em}.ame-album-storefronts-container *{-webkit-user-select:text;user-select:text}.ame-table-band{background-color:#eee!important}#ame-dock{z-index:999999;position:fixed;left:0;bottom:0;width:100%;background-color:#fff}#ame-dock-title{width:100%;padding:.5rem;background-color:var(--keyColorBG);color:#fff;font-weight:700;cursor:pointer}#ame-dock-control{display:flex;padding:.5rem;background-color:var(--pageBG);align-items:center;gap:1rem}#ame-dock-control input,#ame-dock-control select{padding:.1rem}#ame-dock-control button{margin-top:1px;padding:.1rem}";GM.addStyle(qs),GM.addStyle(UD),Xs("iframe[src^='/includes/commerce/subscribe']",{timeout:0}).then(t=>{t==null||t.remove()})});
